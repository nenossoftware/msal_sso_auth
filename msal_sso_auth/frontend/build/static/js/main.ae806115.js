/*! For license information please see main.ae806115.js.LICENSE.txt */
(()=>{"use strict";var e={219:(e,t,n)=>{var r=n(86),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};function c(e){return r.isMemo(e)?s:a[e.$$typeof]||i}a[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a[r.Memo]=s;var l=Object.defineProperty,u=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,f=Object.prototype;e.exports=function e(t,n,r){if("string"!==typeof n){if(f){var i=p(n);i&&i!==f&&e(t,i,r)}var s=u(n);d&&(s=s.concat(d(n)));for(var a=c(t),g=c(n),m=0;m<s.length;++m){var y=s[m];if(!o[y]&&(!r||!r[y])&&(!g||!g[y])&&(!a||!a[y])){var v=h(n,y);try{l(t,y,v)}catch(b){}}}}return t}},123:e=>{var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(i){return!1}}()?Object.assign:function(e,i){for(var o,s,a=function(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),c=1;c<arguments.length;c++){for(var l in o=Object(arguments[c]))n.call(o,l)&&(a[l]=o[l]);if(t){s=t(o);for(var u=0;u<s.length;u++)r.call(o,s[u])&&(a[s[u]]=o[s[u]])}}return a}},730:(e,t,n)=>{var r=n(43),i=n(123),o=n(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!r)throw Error(s(227));function a(e,t,n,r,i,o,s,a,c){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(u){this.onError(u)}}var c=!1,l=null,u=!1,d=null,h={onError:function(e){c=!0,l=e}};function p(e,t,n,r,i,o,s,u,d){c=!1,l=null,a.apply(h,arguments)}var f=null,g=null,m=null;function y(e,t,n){var r=e.type||"unknown-event";e.currentTarget=m(n),function(e,t,n,r,i,o,a,h,f){if(p.apply(this,arguments),c){if(!c)throw Error(s(198));var g=l;c=!1,l=null,u||(u=!0,d=g)}}(r,t,void 0,e),e.currentTarget=null}var v=null,b={};function w(){if(v)for(var e in b){var t=b[e],n=v.indexOf(e);if(!(-1<n))throw Error(s(96,e));if(!C[n]){if(!t.extractEvents)throw Error(s(97,e));for(var r in C[n]=t,n=t.eventTypes){var i=void 0,o=n[r],a=t,c=r;if(I.hasOwnProperty(c))throw Error(s(99,c));I[c]=o;var l=o.phasedRegistrationNames;if(l){for(i in l)l.hasOwnProperty(i)&&_(l[i],a,c);i=!0}else o.registrationName?(_(o.registrationName,a,c),i=!0):i=!1;if(!i)throw Error(s(98,r,e))}}}}function _(e,t,n){if(T[e])throw Error(s(100,e));T[e]=t,S[e]=t.eventTypes[n].dependencies}var C=[],I={},T={},S={};function k(e){var t,n=!1;for(t in e)if(e.hasOwnProperty(t)){var r=e[t];if(!b.hasOwnProperty(t)||b[t]!==r){if(b[t])throw Error(s(102,t));b[t]=r,n=!0}}n&&w()}var A=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),E=null,M=null,R=null;function O(e){if(e=g(e)){if("function"!==typeof E)throw Error(s(280));var t=e.stateNode;t&&(t=f(t),E(e.stateNode,e.type,t))}}function P(e){M?R?R.push(e):R=[e]:M=e}function x(){if(M){var e=M,t=R;if(R=M=null,O(e),t)for(e=0;e<t.length;e++)O(t[e])}}function N(e,t){return e(t)}function B(e,t,n,r,i){return e(t,n,r,i)}function D(){}var L=N,F=!1,U=!1;function q(){null===M&&null===R||(D(),x())}function z(e,t,n){if(U)return e(t,n);U=!0;try{return L(e,t,n)}finally{U=!1,q()}}var H=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,$=Object.prototype.hasOwnProperty,j={},K={};function V(e,t,n,r,i,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o}var W={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){W[e]=new V(e,0,!1,e,null,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];W[t]=new V(t,1,!1,e[1],null,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){W[e]=new V(e,2,!1,e.toLowerCase(),null,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){W[e]=new V(e,2,!1,e,null,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){W[e]=new V(e,3,!1,e.toLowerCase(),null,!1)})),["checked","multiple","muted","selected"].forEach((function(e){W[e]=new V(e,3,!0,e,null,!1)})),["capture","download"].forEach((function(e){W[e]=new V(e,4,!1,e,null,!1)})),["cols","rows","size","span"].forEach((function(e){W[e]=new V(e,6,!1,e,null,!1)})),["rowSpan","start"].forEach((function(e){W[e]=new V(e,5,!1,e.toLowerCase(),null,!1)}));var Q=/[\-:]([a-z])/g;function Y(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(Q,Y);W[t]=new V(t,1,!1,e,null,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(Q,Y);W[t]=new V(t,1,!1,e,"http://www.w3.org/1999/xlink",!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(Q,Y);W[t]=new V(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1)})),["tabIndex","crossOrigin"].forEach((function(e){W[e]=new V(e,1,!1,e.toLowerCase(),null,!1)})),W.xlinkHref=new V("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0),["src","href","action","formAction"].forEach((function(e){W[e]=new V(e,1,!1,e.toLowerCase(),null,!0)}));var G=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function J(e,t,n,r){var i=W.hasOwnProperty(t)?W[t]:null;(null!==i?0===i.type:!r&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!$.call(K,e)||!$.call(j,e)&&(H.test(e)?K[e]=!0:(j[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}G.hasOwnProperty("ReactCurrentDispatcher")||(G.ReactCurrentDispatcher={current:null}),G.hasOwnProperty("ReactCurrentBatchConfig")||(G.ReactCurrentBatchConfig={suspense:null});var X=/^(.*)[\\\/]/,Z="function"===typeof Symbol&&Symbol.for,ee=Z?Symbol.for("react.element"):60103,te=Z?Symbol.for("react.portal"):60106,ne=Z?Symbol.for("react.fragment"):60107,re=Z?Symbol.for("react.strict_mode"):60108,ie=Z?Symbol.for("react.profiler"):60114,oe=Z?Symbol.for("react.provider"):60109,se=Z?Symbol.for("react.context"):60110,ae=Z?Symbol.for("react.concurrent_mode"):60111,ce=Z?Symbol.for("react.forward_ref"):60112,le=Z?Symbol.for("react.suspense"):60113,ue=Z?Symbol.for("react.suspense_list"):60120,de=Z?Symbol.for("react.memo"):60115,he=Z?Symbol.for("react.lazy"):60116,pe=Z?Symbol.for("react.block"):60121,fe="function"===typeof Symbol&&Symbol.iterator;function ge(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=fe&&e[fe]||e["@@iterator"])?e:null}function me(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case ne:return"Fragment";case te:return"Portal";case ie:return"Profiler";case re:return"StrictMode";case le:return"Suspense";case ue:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case se:return"Context.Consumer";case oe:return"Context.Provider";case ce:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case de:return me(e.type);case pe:return me(e.render);case he:if(e=1===e._status?e._result:null)return me(e)}return null}function ye(e){var t="";do{e:switch(e.tag){case 3:case 4:case 6:case 7:case 10:case 9:var n="";break e;default:var r=e._debugOwner,i=e._debugSource,o=me(e.type);n=null,r&&(n=me(r.type)),r=o,o="",i?o=" (at "+i.fileName.replace(X,"")+":"+i.lineNumber+")":n&&(o=" (created by "+n+")"),n="\n    in "+(r||"Unknown")+o}t+=n,e=e.return}while(e);return t}function ve(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function be(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function we(e){e._valueTracker||(e._valueTracker=function(e){var t=be(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function _e(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=be(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Ce(e,t){var n=t.checked;return i({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Ie(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=ve(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Te(e,t){null!=(t=t.checked)&&J(e,"checked",t,!1)}function Se(e,t){Te(e,t);var n=ve(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?Ae(e,t.type,n):t.hasOwnProperty("defaultValue")&&Ae(e,t.type,ve(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function ke(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function Ae(e,t,n){"number"===t&&e.ownerDocument.activeElement===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}function Ee(e,t){return e=i({children:void 0},t),(t=function(e){var t="";return r.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(t.children))&&(e.children=t),e}function Me(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ve(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function Re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return i({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Oe(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:ve(n)}}function Pe(e,t){var n=ve(t.value),r=ve(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function xe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}var Ne="http://www.w3.org/1999/xhtml",Be="http://www.w3.org/2000/svg";function De(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?De(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var Fe,Ue,qe=(Ue=function(e,t){if(e.namespaceURI!==Be||"innerHTML"in e)e.innerHTML=t;else{for((Fe=Fe||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Fe.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return Ue(e,t)}))}:Ue);function ze(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}function He(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var $e={animationend:He("Animation","AnimationEnd"),animationiteration:He("Animation","AnimationIteration"),animationstart:He("Animation","AnimationStart"),transitionend:He("Transition","TransitionEnd")},je={},Ke={};function Ve(e){if(je[e])return je[e];if(!$e[e])return e;var t,n=$e[e];for(t in n)if(n.hasOwnProperty(t)&&t in Ke)return je[e]=n[t];return e}A&&(Ke=document.createElement("div").style,"AnimationEvent"in window||(delete $e.animationend.animation,delete $e.animationiteration.animation,delete $e.animationstart.animation),"TransitionEvent"in window||delete $e.transitionend.transition);var We=Ve("animationend"),Qe=Ve("animationiteration"),Ye=Ve("animationstart"),Ge=Ve("transitionend"),Je="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Xe=new("function"===typeof WeakMap?WeakMap:Map);function Ze(e){var t=Xe.get(e);return void 0===t&&(t=new Map,Xe.set(e,t)),t}function et(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(1026&(t=e).effectTag)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function tt(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function nt(e){if(et(e)!==e)throw Error(s(188))}function rt(e){if(e=function(e){var t=e.alternate;if(!t){if(null===(t=et(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return nt(i),e;if(o===r)return nt(i),t;o=o.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,c=i.child;c;){if(c===n){a=!0,n=i,r=o;break}if(c===r){a=!0,r=i,n=o;break}c=c.sibling}if(!a){for(c=o.child;c;){if(c===n){a=!0,n=o,r=i;break}if(c===r){a=!0,r=o,n=i;break}c=c.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e),!e)return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function it(e,t){if(null==t)throw Error(s(30));return null==e?t:Array.isArray(e)?Array.isArray(t)?(e.push.apply(e,t),e):(e.push(t),e):Array.isArray(t)?[e].concat(t):[e,t]}function ot(e,t,n){Array.isArray(e)?e.forEach(t,n):e&&t.call(n,e)}var st=null;function at(e){if(e){var t=e._dispatchListeners,n=e._dispatchInstances;if(Array.isArray(t))for(var r=0;r<t.length&&!e.isPropagationStopped();r++)y(e,t[r],n[r]);else t&&y(e,t,n);e._dispatchListeners=null,e._dispatchInstances=null,e.isPersistent()||e.constructor.release(e)}}function ct(e){if(null!==e&&(st=it(st,e)),e=st,st=null,e){if(ot(e,at),st)throw Error(s(95));if(u)throw e=d,u=!1,d=null,e}}function lt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}function ut(e){if(!A)return!1;var t=(e="on"+e)in document;return t||((t=document.createElement("div")).setAttribute(e,"return;"),t="function"===typeof t[e]),t}var dt=[];function ht(e){e.topLevelType=null,e.nativeEvent=null,e.targetInst=null,e.ancestors.length=0,10>dt.length&&dt.push(e)}function pt(e,t,n,r){if(dt.length){var i=dt.pop();return i.topLevelType=e,i.eventSystemFlags=r,i.nativeEvent=t,i.targetInst=n,i}return{topLevelType:e,eventSystemFlags:r,nativeEvent:t,targetInst:n,ancestors:[]}}function ft(e){var t=e.targetInst,n=t;do{if(!n){e.ancestors.push(n);break}var r=n;if(3===r.tag)r=r.stateNode.containerInfo;else{for(;r.return;)r=r.return;r=3!==r.tag?null:r.stateNode.containerInfo}if(!r)break;5!==(t=n.tag)&&6!==t||e.ancestors.push(n),n=xn(r)}while(n);for(n=0;n<e.ancestors.length;n++){t=e.ancestors[n];var i=lt(e.nativeEvent);r=e.topLevelType;var o=e.nativeEvent,s=e.eventSystemFlags;0===n&&(s|=64);for(var a=null,c=0;c<C.length;c++){var l=C[c];l&&(l=l.extractEvents(r,t,o,i,s))&&(a=it(a,l))}ct(a)}}function gt(e,t,n){if(!n.has(e)){switch(e){case"scroll":Yt(t,"scroll",!0);break;case"focus":case"blur":Yt(t,"focus",!0),Yt(t,"blur",!0),n.set("blur",null),n.set("focus",null);break;case"cancel":case"close":ut(e)&&Yt(t,e,!0);break;case"invalid":case"submit":case"reset":break;default:-1===Je.indexOf(e)&&Qt(e,t)}n.set(e,null)}}var mt,yt,vt,bt=!1,wt=[],_t=null,Ct=null,It=null,Tt=new Map,St=new Map,kt=[],At="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput close cancel copy cut paste click change contextmenu reset submit".split(" "),Et="focus blur dragenter dragleave mouseover mouseout pointerover pointerout gotpointercapture lostpointercapture".split(" ");function Mt(e,t,n,r,i){return{blockedOn:e,topLevelType:t,eventSystemFlags:32|n,nativeEvent:i,container:r}}function Rt(e,t){switch(e){case"focus":case"blur":_t=null;break;case"dragenter":case"dragleave":Ct=null;break;case"mouseover":case"mouseout":It=null;break;case"pointerover":case"pointerout":Tt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":St.delete(t.pointerId)}}function Ot(e,t,n,r,i,o){return null===e||e.nativeEvent!==o?(e=Mt(t,n,r,i,o),null!==t&&(null!==(t=Nn(t))&&yt(t)),e):(e.eventSystemFlags|=r,e)}function Pt(e){var t=xn(e.target);if(null!==t){var n=et(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=tt(n)))return e.blockedOn=t,void o.unstable_runWithPriority(e.priority,(function(){vt(n)}))}else if(3===t&&n.stateNode.hydrate)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function xt(e){if(null!==e.blockedOn)return!1;var t=Zt(e.topLevelType,e.eventSystemFlags,e.container,e.nativeEvent);if(null!==t){var n=Nn(t);return null!==n&&yt(n),e.blockedOn=t,!1}return!0}function Nt(e,t,n){xt(e)&&n.delete(t)}function Bt(){for(bt=!1;0<wt.length;){var e=wt[0];if(null!==e.blockedOn){null!==(e=Nn(e.blockedOn))&&mt(e);break}var t=Zt(e.topLevelType,e.eventSystemFlags,e.container,e.nativeEvent);null!==t?e.blockedOn=t:wt.shift()}null!==_t&&xt(_t)&&(_t=null),null!==Ct&&xt(Ct)&&(Ct=null),null!==It&&xt(It)&&(It=null),Tt.forEach(Nt),St.forEach(Nt)}function Dt(e,t){e.blockedOn===t&&(e.blockedOn=null,bt||(bt=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,Bt)))}function Lt(e){function t(t){return Dt(t,e)}if(0<wt.length){Dt(wt[0],e);for(var n=1;n<wt.length;n++){var r=wt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==_t&&Dt(_t,e),null!==Ct&&Dt(Ct,e),null!==It&&Dt(It,e),Tt.forEach(t),St.forEach(t),n=0;n<kt.length;n++)(r=kt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<kt.length&&null===(n=kt[0]).blockedOn;)Pt(n),null===n.blockedOn&&kt.shift()}var Ft={},Ut=new Map,qt=new Map,zt=["abort","abort",We,"animationEnd",Qe,"animationIteration",Ye,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Ge,"transitionEnd","waiting","waiting"];function Ht(e,t){for(var n=0;n<e.length;n+=2){var r=e[n],i=e[n+1],o="on"+(i[0].toUpperCase()+i.slice(1));o={phasedRegistrationNames:{bubbled:o,captured:o+"Capture"},dependencies:[r],eventPriority:t},qt.set(r,t),Ut.set(r,o),Ft[i]=o}}Ht("blur blur cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focus focus input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Ht("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Ht(zt,2);for(var $t="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),jt=0;jt<$t.length;jt++)qt.set($t[jt],0);var Kt=o.unstable_UserBlockingPriority,Vt=o.unstable_runWithPriority,Wt=!0;function Qt(e,t){Yt(t,e,!1)}function Yt(e,t,n){var r=qt.get(t);switch(void 0===r?2:r){case 0:r=Gt.bind(null,t,1,e);break;case 1:r=Jt.bind(null,t,1,e);break;default:r=Xt.bind(null,t,1,e)}n?e.addEventListener(t,r,!0):e.addEventListener(t,r,!1)}function Gt(e,t,n,r){F||D();var i=Xt,o=F;F=!0;try{B(i,e,t,n,r)}finally{(F=o)||q()}}function Jt(e,t,n,r){Vt(Kt,Xt.bind(null,e,t,n,r))}function Xt(e,t,n,r){if(Wt)if(0<wt.length&&-1<At.indexOf(e))e=Mt(null,e,t,n,r),wt.push(e);else{var i=Zt(e,t,n,r);if(null===i)Rt(e,r);else if(-1<At.indexOf(e))e=Mt(i,e,t,n,r),wt.push(e);else if(!function(e,t,n,r,i){switch(t){case"focus":return _t=Ot(_t,e,t,n,r,i),!0;case"dragenter":return Ct=Ot(Ct,e,t,n,r,i),!0;case"mouseover":return It=Ot(It,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return Tt.set(o,Ot(Tt.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,St.set(o,Ot(St.get(o)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r)){Rt(e,r),e=pt(e,r,null,t);try{z(ft,e)}finally{ht(e)}}}}function Zt(e,t,n,r){if(null!==(n=xn(n=lt(r)))){var i=et(n);if(null===i)n=null;else{var o=i.tag;if(13===o){if(null!==(n=tt(i)))return n;n=null}else if(3===o){if(i.stateNode.hydrate)return 3===i.tag?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null)}}e=pt(e,r,n,t);try{z(ft,e)}finally{ht(e)}return null}var en={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},tn=["Webkit","ms","Moz","O"];function nn(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||en.hasOwnProperty(e)&&en[e]?(""+t).trim():t+"px"}function rn(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=nn(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(en).forEach((function(e){tn.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),en[t]=en[e]}))}));var on=i({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function sn(e,t){if(t){if(on[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e,""));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62,""))}}function an(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var cn=Ne;function ln(e,t){var n=Ze(e=9===e.nodeType||11===e.nodeType?e:e.ownerDocument);t=S[t];for(var r=0;r<t.length;r++)gt(t[r],e,n)}function un(){}function dn(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function hn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function pn(e,t){var n,r=hn(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=hn(r)}}function fn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?fn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function gn(){for(var e=window,t=dn();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=dn((e=t.contentWindow).document)}return t}function mn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var yn="$",vn="/$",bn="$?",wn="$!",_n=null,Cn=null;function In(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function Tn(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Sn="function"===typeof setTimeout?setTimeout:void 0,kn="function"===typeof clearTimeout?clearTimeout:void 0;function An(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function En(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if(n===yn||n===wn||n===bn){if(0===t)return e;t--}else n===vn&&t++}e=e.previousSibling}return null}var Mn=Math.random().toString(36).slice(2),Rn="__reactInternalInstance$"+Mn,On="__reactEventHandlers$"+Mn,Pn="__reactContainere$"+Mn;function xn(e){var t=e[Rn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Pn]||n[Rn]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=En(e);null!==e;){if(n=e[Rn])return n;e=En(e)}return t}n=(e=n).parentNode}return null}function Nn(e){return!(e=e[Rn]||e[Pn])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Bn(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function Dn(e){return e[On]||null}function Ln(e){do{e=e.return}while(e&&5!==e.tag);return e||null}function Fn(e,t){var n=e.stateNode;if(!n)return null;var r=f(n);if(!r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}function Un(e,t,n){(t=Fn(e,n.dispatchConfig.phasedRegistrationNames[t]))&&(n._dispatchListeners=it(n._dispatchListeners,t),n._dispatchInstances=it(n._dispatchInstances,e))}function qn(e){if(e&&e.dispatchConfig.phasedRegistrationNames){for(var t=e._targetInst,n=[];t;)n.push(t),t=Ln(t);for(t=n.length;0<t--;)Un(n[t],"captured",e);for(t=0;t<n.length;t++)Un(n[t],"bubbled",e)}}function zn(e,t,n){e&&n&&n.dispatchConfig.registrationName&&(t=Fn(e,n.dispatchConfig.registrationName))&&(n._dispatchListeners=it(n._dispatchListeners,t),n._dispatchInstances=it(n._dispatchInstances,e))}function Hn(e){e&&e.dispatchConfig.registrationName&&zn(e._targetInst,null,e)}function $n(e){ot(e,qn)}var jn=null,Kn=null,Vn=null;function Wn(){if(Vn)return Vn;var e,t,n=Kn,r=n.length,i="value"in jn?jn.value:jn.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===i[o-t];t++);return Vn=i.slice(e,1<t?1-t:void 0)}function Qn(){return!0}function Yn(){return!1}function Gn(e,t,n,r){for(var i in this.dispatchConfig=e,this._targetInst=t,this.nativeEvent=n,e=this.constructor.Interface)e.hasOwnProperty(i)&&((t=e[i])?this[i]=t(n):"target"===i?this.target=r:this[i]=n[i]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?Qn:Yn,this.isPropagationStopped=Yn,this}function Jn(e,t,n,r){if(this.eventPool.length){var i=this.eventPool.pop();return this.call(i,e,t,n,r),i}return new this(e,t,n,r)}function Xn(e){if(!(e instanceof this))throw Error(s(279));e.destructor(),10>this.eventPool.length&&this.eventPool.push(e)}function Zn(e){e.eventPool=[],e.getPooled=Jn,e.release=Xn}i(Gn.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Qn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Qn)},persist:function(){this.isPersistent=Qn},isPersistent:Yn,destructor:function(){var e,t=this.constructor.Interface;for(e in t)this[e]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null,this.isPropagationStopped=this.isDefaultPrevented=Yn,this._dispatchInstances=this._dispatchListeners=null}}),Gn.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null},Gn.extend=function(e){function t(){}function n(){return r.apply(this,arguments)}var r=this;t.prototype=r.prototype;var o=new t;return i(o,n.prototype),n.prototype=o,n.prototype.constructor=n,n.Interface=i({},r.Interface,e),n.extend=r.extend,Zn(n),n},Zn(Gn);var er=Gn.extend({data:null}),tr=Gn.extend({data:null}),nr=[9,13,27,32],rr=A&&"CompositionEvent"in window,ir=null;A&&"documentMode"in document&&(ir=document.documentMode);var or=A&&"TextEvent"in window&&!ir,sr=A&&(!rr||ir&&8<ir&&11>=ir),ar=String.fromCharCode(32),cr={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},lr=!1;function ur(e,t){switch(e){case"keyup":return-1!==nr.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"blur":return!0;default:return!1}}function dr(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var hr=!1;var pr={eventTypes:cr,extractEvents:function(e,t,n,r){var i;if(rr)e:{switch(e){case"compositionstart":var o=cr.compositionStart;break e;case"compositionend":o=cr.compositionEnd;break e;case"compositionupdate":o=cr.compositionUpdate;break e}o=void 0}else hr?ur(e,n)&&(o=cr.compositionEnd):"keydown"===e&&229===n.keyCode&&(o=cr.compositionStart);return o?(sr&&"ko"!==n.locale&&(hr||o!==cr.compositionStart?o===cr.compositionEnd&&hr&&(i=Wn()):(Kn="value"in(jn=r)?jn.value:jn.textContent,hr=!0)),o=er.getPooled(o,t,n,r),i?o.data=i:null!==(i=dr(n))&&(o.data=i),$n(o),i=o):i=null,(e=or?function(e,t){switch(e){case"compositionend":return dr(t);case"keypress":return 32!==t.which?null:(lr=!0,ar);case"textInput":return(e=t.data)===ar&&lr?null:e;default:return null}}(e,n):function(e,t){if(hr)return"compositionend"===e||!rr&&ur(e,t)?(e=Wn(),Vn=Kn=jn=null,hr=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return sr&&"ko"!==t.locale?null:t.data}}(e,n))?((t=tr.getPooled(cr.beforeInput,t,n,r)).data=e,$n(t)):t=null,null===i?t:null===t?i:[i,t]}},fr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function gr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!fr[e.type]:"textarea"===t}var mr={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}};function yr(e,t,n){return(e=Gn.getPooled(mr.change,e,t,n)).type="change",P(n),$n(e),e}var vr=null,br=null;function wr(e){ct(e)}function _r(e){if(_e(Bn(e)))return e}function Cr(e,t){if("change"===e)return t}var Ir=!1;function Tr(){vr&&(vr.detachEvent("onpropertychange",Sr),br=vr=null)}function Sr(e){if("value"===e.propertyName&&_r(br))if(e=yr(br,e,lt(e)),F)ct(e);else{F=!0;try{N(wr,e)}finally{F=!1,q()}}}function kr(e,t,n){"focus"===e?(Tr(),br=n,(vr=t).attachEvent("onpropertychange",Sr)):"blur"===e&&Tr()}function Ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return _r(br)}function Er(e,t){if("click"===e)return _r(t)}function Mr(e,t){if("input"===e||"change"===e)return _r(t)}A&&(Ir=ut("input")&&(!document.documentMode||9<document.documentMode));var Rr={eventTypes:mr,_isInputEventSupported:Ir,extractEvents:function(e,t,n,r){var i=t?Bn(t):window,o=i.nodeName&&i.nodeName.toLowerCase();if("select"===o||"input"===o&&"file"===i.type)var s=Cr;else if(gr(i))if(Ir)s=Mr;else{s=Ar;var a=kr}else(o=i.nodeName)&&"input"===o.toLowerCase()&&("checkbox"===i.type||"radio"===i.type)&&(s=Er);if(s&&(s=s(e,t)))return yr(s,n,r);a&&a(e,i,t),"blur"===e&&(e=i._wrapperState)&&e.controlled&&"number"===i.type&&Ae(i,"number",i.value)}},Or=Gn.extend({view:null,detail:null}),Pr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Pr[e])&&!!t[e]}function Nr(){return xr}var Br=0,Dr=0,Lr=!1,Fr=!1,Ur=Or.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:Nr,button:null,buttons:null,relatedTarget:function(e){return e.relatedTarget||(e.fromElement===e.srcElement?e.toElement:e.fromElement)},movementX:function(e){if("movementX"in e)return e.movementX;var t=Br;return Br=e.screenX,Lr?"mousemove"===e.type?e.screenX-t:0:(Lr=!0,0)},movementY:function(e){if("movementY"in e)return e.movementY;var t=Dr;return Dr=e.screenY,Fr?"mousemove"===e.type?e.screenY-t:0:(Fr=!0,0)}}),qr=Ur.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),zr={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout","pointerover"]}},Hr={eventTypes:zr,extractEvents:function(e,t,n,r,i){var o="mouseover"===e||"pointerover"===e,s="mouseout"===e||"pointerout"===e;if(o&&0===(32&i)&&(n.relatedTarget||n.fromElement)||!s&&!o)return null;(o=r.window===r?r:(o=r.ownerDocument)?o.defaultView||o.parentWindow:window,s)?(s=t,null!==(t=(t=n.relatedTarget||n.toElement)?xn(t):null)&&(t!==et(t)||5!==t.tag&&6!==t.tag)&&(t=null)):s=null;if(s===t)return null;if("mouseout"===e||"mouseover"===e)var a=Ur,c=zr.mouseLeave,l=zr.mouseEnter,u="mouse";else"pointerout"!==e&&"pointerover"!==e||(a=qr,c=zr.pointerLeave,l=zr.pointerEnter,u="pointer");if(e=null==s?o:Bn(s),o=null==t?o:Bn(t),(c=a.getPooled(c,s,n,r)).type=u+"leave",c.target=e,c.relatedTarget=o,(n=a.getPooled(l,t,n,r)).type=u+"enter",n.target=o,n.relatedTarget=e,u=t,(r=s)&&u)e:{for(l=u,s=0,e=a=r;e;e=Ln(e))s++;for(e=0,t=l;t;t=Ln(t))e++;for(;0<s-e;)a=Ln(a),s--;for(;0<e-s;)l=Ln(l),e--;for(;s--;){if(a===l||a===l.alternate)break e;a=Ln(a),l=Ln(l)}a=null}else a=null;for(l=a,a=[];r&&r!==l&&(null===(s=r.alternate)||s!==l);)a.push(r),r=Ln(r);for(r=[];u&&u!==l&&(null===(s=u.alternate)||s!==l);)r.push(u),u=Ln(u);for(u=0;u<a.length;u++)zn(a[u],"bubbled",c);for(u=r.length;0<u--;)zn(r[u],"captured",n);return 0===(64&i)?[c]:[c,n]}};var $r="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},jr=Object.prototype.hasOwnProperty;function Kr(e,t){if($r(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!jr.call(t,n[r])||!$r(e[n[r]],t[n[r]]))return!1;return!0}var Vr=A&&"documentMode"in document&&11>=document.documentMode,Wr={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},Qr=null,Yr=null,Gr=null,Jr=!1;function Xr(e,t){var n=t.window===t?t.document:9===t.nodeType?t:t.ownerDocument;return Jr||null==Qr||Qr!==dn(n)?null:("selectionStart"in(n=Qr)&&mn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},Gr&&Kr(Gr,n)?null:(Gr=n,(e=Gn.getPooled(Wr.select,Yr,e,t)).type="select",e.target=Qr,$n(e),e))}var Zr={eventTypes:Wr,extractEvents:function(e,t,n,r,i,o){if(!(o=!(i=o||(r.window===r?r.document:9===r.nodeType?r:r.ownerDocument)))){e:{i=Ze(i),o=S.onSelect;for(var s=0;s<o.length;s++)if(!i.has(o[s])){i=!1;break e}i=!0}o=!i}if(o)return null;switch(i=t?Bn(t):window,e){case"focus":(gr(i)||"true"===i.contentEditable)&&(Qr=i,Yr=t,Gr=null);break;case"blur":Gr=Yr=Qr=null;break;case"mousedown":Jr=!0;break;case"contextmenu":case"mouseup":case"dragend":return Jr=!1,Xr(n,r);case"selectionchange":if(Vr)break;case"keydown":case"keyup":return Xr(n,r)}return null}},ei=Gn.extend({animationName:null,elapsedTime:null,pseudoElement:null}),ti=Gn.extend({clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ni=Or.extend({relatedTarget:null});function ri(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}var ii={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},oi={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},si=Or.extend({key:function(e){if(e.key){var t=ii[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=ri(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?oi[e.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:Nr,charCode:function(e){return"keypress"===e.type?ri(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?ri(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),ai=Ur.extend({dataTransfer:null}),ci=Or.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:Nr}),li=Gn.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),ui=Ur.extend({deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:null,deltaMode:null}),di={eventTypes:Ft,extractEvents:function(e,t,n,r){var i=Ut.get(e);if(!i)return null;switch(e){case"keypress":if(0===ri(n))return null;case"keydown":case"keyup":e=si;break;case"blur":case"focus":e=ni;break;case"click":if(2===n.button)return null;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":e=Ur;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":e=ai;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":e=ci;break;case We:case Qe:case Ye:e=ei;break;case Ge:e=li;break;case"scroll":e=Or;break;case"wheel":e=ui;break;case"copy":case"cut":case"paste":e=ti;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":e=qr;break;default:e=Gn}return $n(t=e.getPooled(i,t,n,r)),t}};if(v)throw Error(s(101));v=Array.prototype.slice.call("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" ")),w(),f=Dn,g=Nn,m=Bn,k({SimpleEventPlugin:di,EnterLeaveEventPlugin:Hr,ChangeEventPlugin:Rr,SelectEventPlugin:Zr,BeforeInputEventPlugin:pr});var hi=[],pi=-1;function fi(e){0>pi||(e.current=hi[pi],hi[pi]=null,pi--)}function gi(e,t){pi++,hi[pi]=e.current,e.current=t}var mi={},yi={current:mi},vi={current:!1},bi=mi;function wi(e,t){var n=e.type.contextTypes;if(!n)return mi;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function _i(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ci(){fi(vi),fi(yi)}function Ii(e,t,n){if(yi.current!==mi)throw Error(s(168));gi(yi,t),gi(vi,n)}function Ti(e,t,n){var r=e.stateNode;if(e=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var o in r=r.getChildContext())if(!(o in e))throw Error(s(108,me(t)||"Unknown",o));return i({},n,{},r)}function Si(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||mi,bi=yi.current,gi(yi,e),gi(vi,vi.current),!0}function ki(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=Ti(e,t,bi),r.__reactInternalMemoizedMergedChildContext=e,fi(vi),fi(yi),gi(yi,e)):fi(vi),gi(vi,n)}var Ai=o.unstable_runWithPriority,Ei=o.unstable_scheduleCallback,Mi=o.unstable_cancelCallback,Ri=o.unstable_requestPaint,Oi=o.unstable_now,Pi=o.unstable_getCurrentPriorityLevel,xi=o.unstable_ImmediatePriority,Ni=o.unstable_UserBlockingPriority,Bi=o.unstable_NormalPriority,Di=o.unstable_LowPriority,Li=o.unstable_IdlePriority,Fi={},Ui=o.unstable_shouldYield,qi=void 0!==Ri?Ri:function(){},zi=null,Hi=null,$i=!1,ji=Oi(),Ki=1e4>ji?Oi:function(){return Oi()-ji};function Vi(){switch(Pi()){case xi:return 99;case Ni:return 98;case Bi:return 97;case Di:return 96;case Li:return 95;default:throw Error(s(332))}}function Wi(e){switch(e){case 99:return xi;case 98:return Ni;case 97:return Bi;case 96:return Di;case 95:return Li;default:throw Error(s(332))}}function Qi(e,t){return e=Wi(e),Ai(e,t)}function Yi(e,t,n){return e=Wi(e),Ei(e,t,n)}function Gi(e){return null===zi?(zi=[e],Hi=Ei(xi,Xi)):zi.push(e),Fi}function Ji(){if(null!==Hi){var e=Hi;Hi=null,Mi(e)}Xi()}function Xi(){if(!$i&&null!==zi){$i=!0;var e=0;try{var t=zi;Qi(99,(function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}})),zi=null}catch(n){throw null!==zi&&(zi=zi.slice(e+1)),Ei(xi,Ji),n}finally{$i=!1}}}function Zi(e,t,n){return 1073741821-(1+((1073741821-e+t/10)/(n/=10)|0))*n}function eo(e,t){if(e&&e.defaultProps)for(var n in t=i({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}var to={current:null},no=null,ro=null,io=null;function oo(){io=ro=no=null}function so(e){var t=to.current;fi(to),e.type._context._currentValue=t}function ao(e,t){for(;null!==e;){var n=e.alternate;if(e.childExpirationTime<t)e.childExpirationTime=t,null!==n&&n.childExpirationTime<t&&(n.childExpirationTime=t);else{if(!(null!==n&&n.childExpirationTime<t))break;n.childExpirationTime=t}e=e.return}}function co(e,t){no=e,io=ro=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(e.expirationTime>=t&&(Ds=!0),e.firstContext=null)}function lo(e,t){if(io!==e&&!1!==t&&0!==t)if("number"===typeof t&&1073741823!==t||(io=e,t=1073741823),t={context:e,observedBits:t,next:null},null===ro){if(null===no)throw Error(s(308));ro=t,no.dependencies={expirationTime:0,firstContext:t,responders:null}}else ro=ro.next=t;return e._currentValue}var uo=!1;function ho(e){e.updateQueue={baseState:e.memoizedState,baseQueue:null,shared:{pending:null},effects:null}}function po(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,baseQueue:e.baseQueue,shared:e.shared,effects:e.effects})}function fo(e,t){return(e={expirationTime:e,suspenseConfig:t,tag:0,payload:null,callback:null,next:null}).next=e}function go(e,t){if(null!==(e=e.updateQueue)){var n=(e=e.shared).pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function mo(e,t){var n=e.alternate;null!==n&&po(n,e),null===(n=(e=e.updateQueue).baseQueue)?(e.baseQueue=t.next=t,t.next=t):(t.next=n.next,n.next=t)}function yo(e,t,n,r){var o=e.updateQueue;uo=!1;var s=o.baseQueue,a=o.shared.pending;if(null!==a){if(null!==s){var c=s.next;s.next=a.next,a.next=c}s=a,o.shared.pending=null,null!==(c=e.alternate)&&(null!==(c=c.updateQueue)&&(c.baseQueue=a))}if(null!==s){c=s.next;var l=o.baseState,u=0,d=null,h=null,p=null;if(null!==c)for(var f=c;;){if((a=f.expirationTime)<r){var g={expirationTime:f.expirationTime,suspenseConfig:f.suspenseConfig,tag:f.tag,payload:f.payload,callback:f.callback,next:null};null===p?(h=p=g,d=l):p=p.next=g,a>u&&(u=a)}else{null!==p&&(p=p.next={expirationTime:1073741823,suspenseConfig:f.suspenseConfig,tag:f.tag,payload:f.payload,callback:f.callback,next:null}),Cc(a,f.suspenseConfig);e:{var m=e,y=f;switch(a=t,g=n,y.tag){case 1:if("function"===typeof(m=y.payload)){l=m.call(g,l,a);break e}l=m;break e;case 3:m.effectTag=-4097&m.effectTag|64;case 0:if(null===(a="function"===typeof(m=y.payload)?m.call(g,l,a):m)||void 0===a)break e;l=i({},l,a);break e;case 2:uo=!0}}null!==f.callback&&(e.effectTag|=32,null===(a=o.effects)?o.effects=[f]:a.push(f))}if(null===(f=f.next)||f===c){if(null===(a=o.shared.pending))break;f=s.next=a.next,a.next=c,o.baseQueue=s=a,o.shared.pending=null}}null===p?d=l:p.next=h,o.baseState=d,o.baseQueue=p,Ic(u),e.expirationTime=u,e.memoizedState=l}}function vo(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=i,i=n,"function"!==typeof r)throw Error(s(191,r));r.call(i)}}}var bo=G.ReactCurrentBatchConfig,wo=(new r.Component).refs;function _o(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:i({},t,n),e.memoizedState=n,0===e.expirationTime&&(e.updateQueue.baseState=n)}var Co={isMounted:function(e){return!!(e=e._reactInternalFiber)&&et(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternalFiber;var r=lc(),i=bo.suspense;(i=fo(r=uc(r,e,i),i)).payload=t,void 0!==n&&null!==n&&(i.callback=n),go(e,i),dc(e,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternalFiber;var r=lc(),i=bo.suspense;(i=fo(r=uc(r,e,i),i)).tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),go(e,i),dc(e,r)},enqueueForceUpdate:function(e,t){e=e._reactInternalFiber;var n=lc(),r=bo.suspense;(r=fo(n=uc(n,e,r),r)).tag=2,void 0!==t&&null!==t&&(r.callback=t),go(e,r),dc(e,n)}};function Io(e,t,n,r,i,o,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,s):!t.prototype||!t.prototype.isPureReactComponent||(!Kr(n,r)||!Kr(i,o))}function To(e,t,n){var r=!1,i=mi,o=t.contextType;return"object"===typeof o&&null!==o?o=lo(o):(i=_i(t)?bi:yi.current,o=(r=null!==(r=t.contextTypes)&&void 0!==r)?wi(e,i):mi),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Co,e.stateNode=t,t._reactInternalFiber=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function So(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Co.enqueueReplaceState(t,t.state,null)}function ko(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=wo,ho(e);var o=t.contextType;"object"===typeof o&&null!==o?i.context=lo(o):(o=_i(t)?bi:yi.current,i.context=wi(e,o)),yo(e,n,i,r),i.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(_o(e,t,o,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&Co.enqueueReplaceState(i,i.state,null),yo(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.effectTag|=4)}var Ao=Array.isArray;function Eo(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=r.refs;t===wo&&(t=r.refs={}),null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function Mo(e,t){if("textarea"!==e.type)throw Error(s(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t,""))}function Ro(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.effectTag=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=$c(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.effectTag=2,n):r:(t.effectTag=2,n):n}function a(t){return e&&null===t.alternate&&(t.effectTag=2),t}function c(e,t,n,r){return null===t||6!==t.tag?((t=Vc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function l(e,t,n,r){return null!==t&&t.elementType===n.type?((r=i(t,n.props)).ref=Eo(e,t,n),r.return=e,r):((r=jc(n.type,n.key,n.props,null,e.mode,r)).ref=Eo(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Wc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,o){return null===t||7!==t.tag?((t=Kc(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t||"number"===typeof t)return(t=Vc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case ee:return(n=jc(t.type,t.key,t.props,null,e.mode,n)).ref=Eo(e,null,t),n.return=e,n;case te:return(t=Wc(t,e.mode,n)).return=e,t}if(Ao(t)||ge(t))return(t=Kc(t,e.mode,n,null)).return=e,t;Mo(e,t)}return null}function p(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n||"number"===typeof n)return null!==i?null:c(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case ee:return n.key===i?n.type===ne?d(e,t,n.props.children,r,i):l(e,t,n,r):null;case te:return n.key===i?u(e,t,n,r):null}if(Ao(n)||ge(n))return null!==i?null:d(e,t,n,r,null);Mo(e,n)}return null}function f(e,t,n,r,i){if("string"===typeof r||"number"===typeof r)return c(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case ee:return e=e.get(null===r.key?n:r.key)||null,r.type===ne?d(t,e,r.props.children,i,r.key):l(t,e,r,i);case te:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i)}if(Ao(r)||ge(r))return d(t,e=e.get(n)||null,r,i,null);Mo(t,r)}return null}function g(i,s,a,c){for(var l=null,u=null,d=s,g=s=0,m=null;null!==d&&g<a.length;g++){d.index>g?(m=d,d=null):m=d.sibling;var y=p(i,d,a[g],c);if(null===y){null===d&&(d=m);break}e&&d&&null===y.alternate&&t(i,d),s=o(y,s,g),null===u?l=y:u.sibling=y,u=y,d=m}if(g===a.length)return n(i,d),l;if(null===d){for(;g<a.length;g++)null!==(d=h(i,a[g],c))&&(s=o(d,s,g),null===u?l=d:u.sibling=d,u=d);return l}for(d=r(i,d);g<a.length;g++)null!==(m=f(d,i,g,a[g],c))&&(e&&null!==m.alternate&&d.delete(null===m.key?g:m.key),s=o(m,s,g),null===u?l=m:u.sibling=m,u=m);return e&&d.forEach((function(e){return t(i,e)})),l}function m(i,a,c,l){var u=ge(c);if("function"!==typeof u)throw Error(s(150));if(null==(c=u.call(c)))throw Error(s(151));for(var d=u=null,g=a,m=a=0,y=null,v=c.next();null!==g&&!v.done;m++,v=c.next()){g.index>m?(y=g,g=null):y=g.sibling;var b=p(i,g,v.value,l);if(null===b){null===g&&(g=y);break}e&&g&&null===b.alternate&&t(i,g),a=o(b,a,m),null===d?u=b:d.sibling=b,d=b,g=y}if(v.done)return n(i,g),u;if(null===g){for(;!v.done;m++,v=c.next())null!==(v=h(i,v.value,l))&&(a=o(v,a,m),null===d?u=v:d.sibling=v,d=v);return u}for(g=r(i,g);!v.done;m++,v=c.next())null!==(v=f(g,i,m,v.value,l))&&(e&&null!==v.alternate&&g.delete(null===v.key?m:v.key),a=o(v,a,m),null===d?u=v:d.sibling=v,d=v);return e&&g.forEach((function(e){return t(i,e)})),u}return function(e,r,o,c){var l="object"===typeof o&&null!==o&&o.type===ne&&null===o.key;l&&(o=o.props.children);var u="object"===typeof o&&null!==o;if(u)switch(o.$$typeof){case ee:e:{for(u=o.key,l=r;null!==l;){if(l.key===u){if(7===l.tag){if(o.type===ne){n(e,l.sibling),(r=i(l,o.props.children)).return=e,e=r;break e}}else if(l.elementType===o.type){n(e,l.sibling),(r=i(l,o.props)).ref=Eo(e,l,o),r.return=e,e=r;break e}n(e,l);break}t(e,l),l=l.sibling}o.type===ne?((r=Kc(o.props.children,e.mode,c,o.key)).return=e,e=r):((c=jc(o.type,o.key,o.props,null,e.mode,c)).ref=Eo(e,r,o),c.return=e,e=c)}return a(e);case te:e:{for(l=o.key;null!==r;){if(r.key===l){if(4===r.tag&&r.stateNode.containerInfo===o.containerInfo&&r.stateNode.implementation===o.implementation){n(e,r.sibling),(r=i(r,o.children||[])).return=e,e=r;break e}n(e,r);break}t(e,r),r=r.sibling}(r=Wc(o,e.mode,c)).return=e,e=r}return a(e)}if("string"===typeof o||"number"===typeof o)return o=""+o,null!==r&&6===r.tag?(n(e,r.sibling),(r=i(r,o)).return=e,e=r):(n(e,r),(r=Vc(o,e.mode,c)).return=e,e=r),a(e);if(Ao(o))return g(e,r,o,c);if(ge(o))return m(e,r,o,c);if(u&&Mo(e,o),"undefined"===typeof o&&!l)switch(e.tag){case 1:case 0:throw e=e.type,Error(s(152,e.displayName||e.name||"Component"))}return n(e,r)}}var Oo=Ro(!0),Po=Ro(!1),xo={},No={current:xo},Bo={current:xo},Do={current:xo};function Lo(e){if(e===xo)throw Error(s(174));return e}function Fo(e,t){switch(gi(Do,t),gi(Bo,e),gi(No,xo),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Le(null,"");break;default:t=Le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}fi(No),gi(No,t)}function Uo(){fi(No),fi(Bo),fi(Do)}function qo(e){Lo(Do.current);var t=Lo(No.current),n=Le(t,e.type);t!==n&&(gi(Bo,e),gi(No,n))}function zo(e){Bo.current===e&&(fi(No),fi(Bo))}var Ho={current:0};function $o(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||n.data===bn||n.data===wn))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(64&t.effectTag))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function jo(e,t){return{responder:e,props:t}}var Ko=G.ReactCurrentDispatcher,Vo=G.ReactCurrentBatchConfig,Wo=0,Qo=null,Yo=null,Go=null,Jo=!1;function Xo(){throw Error(s(321))}function Zo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!$r(e[n],t[n]))return!1;return!0}function es(e,t,n,r,i,o){if(Wo=o,Qo=t,t.memoizedState=null,t.updateQueue=null,t.expirationTime=0,Ko.current=null===e||null===e.memoizedState?Is:Ts,e=n(r,i),t.expirationTime===Wo){o=0;do{if(t.expirationTime=0,!(25>o))throw Error(s(301));o+=1,Go=Yo=null,t.updateQueue=null,Ko.current=Ss,e=n(r,i)}while(t.expirationTime===Wo)}if(Ko.current=Cs,t=null!==Yo&&null!==Yo.next,Wo=0,Go=Yo=Qo=null,Jo=!1,t)throw Error(s(300));return e}function ts(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Go?Qo.memoizedState=Go=e:Go=Go.next=e,Go}function ns(){if(null===Yo){var e=Qo.alternate;e=null!==e?e.memoizedState:null}else e=Yo.next;var t=null===Go?Qo.memoizedState:Go.next;if(null!==t)Go=t,Yo=e;else{if(null===e)throw Error(s(310));e={memoizedState:(Yo=e).memoizedState,baseState:Yo.baseState,baseQueue:Yo.baseQueue,queue:Yo.queue,next:null},null===Go?Qo.memoizedState=Go=e:Go=Go.next=e}return Go}function rs(e,t){return"function"===typeof t?t(e):t}function is(e){var t=ns(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=Yo,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var a=i.next;i.next=o.next,o.next=a}r.baseQueue=i=o,n.pending=null}if(null!==i){i=i.next,r=r.baseState;var c=a=o=null,l=i;do{var u=l.expirationTime;if(u<Wo){var d={expirationTime:l.expirationTime,suspenseConfig:l.suspenseConfig,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null};null===c?(a=c=d,o=r):c=c.next=d,u>Qo.expirationTime&&(Qo.expirationTime=u,Ic(u))}else null!==c&&(c=c.next={expirationTime:1073741823,suspenseConfig:l.suspenseConfig,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null}),Cc(u,l.suspenseConfig),r=l.eagerReducer===e?l.eagerState:e(r,l.action);l=l.next}while(null!==l&&l!==i);null===c?o=r:c.next=a,$r(r,t.memoizedState)||(Ds=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}return[t.memoizedState,n.dispatch]}function os(e){var t=ns(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{o=e(o,a.action),a=a.next}while(a!==i);$r(o,t.memoizedState)||(Ds=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function ss(e){var t=ts();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:rs,lastRenderedState:e}).dispatch=_s.bind(null,Qo,e),[t.memoizedState,e]}function as(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=Qo.updateQueue)?(t={lastEffect:null},Qo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function cs(){return ns().memoizedState}function ls(e,t,n,r){var i=ts();Qo.effectTag|=e,i.memoizedState=as(1|t,n,void 0,void 0===r?null:r)}function us(e,t,n,r){var i=ns();r=void 0===r?null:r;var o=void 0;if(null!==Yo){var s=Yo.memoizedState;if(o=s.destroy,null!==r&&Zo(r,s.deps))return void as(t,n,o,r)}Qo.effectTag|=e,i.memoizedState=as(1|t,n,o,r)}function ds(e,t){return ls(516,4,e,t)}function hs(e,t){return us(516,4,e,t)}function ps(e,t){return us(4,2,e,t)}function fs(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function gs(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,us(4,2,fs.bind(null,t,e),n)}function ms(){}function ys(e,t){return ts().memoizedState=[e,void 0===t?null:t],e}function vs(e,t){var n=ns();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Zo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function bs(e,t){var n=ns();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Zo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function ws(e,t,n){var r=Vi();Qi(98>r?98:r,(function(){e(!0)})),Qi(97<r?97:r,(function(){var r=Vo.suspense;Vo.suspense=void 0===t?null:t;try{e(!1),n()}finally{Vo.suspense=r}}))}function _s(e,t,n){var r=lc(),i=bo.suspense;i={expirationTime:r=uc(r,e,i),suspenseConfig:i,action:n,eagerReducer:null,eagerState:null,next:null};var o=t.pending;if(null===o?i.next=i:(i.next=o.next,o.next=i),t.pending=i,o=e.alternate,e===Qo||null!==o&&o===Qo)Jo=!0,i.expirationTime=Wo,Qo.expirationTime=Wo;else{if(0===e.expirationTime&&(null===o||0===o.expirationTime)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,a=o(s,n);if(i.eagerReducer=o,i.eagerState=a,$r(a,s))return}catch(c){}dc(e,r)}}var Cs={readContext:lo,useCallback:Xo,useContext:Xo,useEffect:Xo,useImperativeHandle:Xo,useLayoutEffect:Xo,useMemo:Xo,useReducer:Xo,useRef:Xo,useState:Xo,useDebugValue:Xo,useResponder:Xo,useDeferredValue:Xo,useTransition:Xo},Is={readContext:lo,useCallback:ys,useContext:lo,useEffect:ds,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,ls(4,2,fs.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ls(4,2,e,t)},useMemo:function(e,t){var n=ts();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ts();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e=(e=r.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=_s.bind(null,Qo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},ts().memoizedState=e},useState:ss,useDebugValue:ms,useResponder:jo,useDeferredValue:function(e,t){var n=ss(e),r=n[0],i=n[1];return ds((function(){var n=Vo.suspense;Vo.suspense=void 0===t?null:t;try{i(e)}finally{Vo.suspense=n}}),[e,t]),r},useTransition:function(e){var t=ss(!1),n=t[0];return t=t[1],[ys(ws.bind(null,t,e),[t,e]),n]}},Ts={readContext:lo,useCallback:vs,useContext:lo,useEffect:hs,useImperativeHandle:gs,useLayoutEffect:ps,useMemo:bs,useReducer:is,useRef:cs,useState:function(){return is(rs)},useDebugValue:ms,useResponder:jo,useDeferredValue:function(e,t){var n=is(rs),r=n[0],i=n[1];return hs((function(){var n=Vo.suspense;Vo.suspense=void 0===t?null:t;try{i(e)}finally{Vo.suspense=n}}),[e,t]),r},useTransition:function(e){var t=is(rs),n=t[0];return t=t[1],[vs(ws.bind(null,t,e),[t,e]),n]}},Ss={readContext:lo,useCallback:vs,useContext:lo,useEffect:hs,useImperativeHandle:gs,useLayoutEffect:ps,useMemo:bs,useReducer:os,useRef:cs,useState:function(){return os(rs)},useDebugValue:ms,useResponder:jo,useDeferredValue:function(e,t){var n=os(rs),r=n[0],i=n[1];return hs((function(){var n=Vo.suspense;Vo.suspense=void 0===t?null:t;try{i(e)}finally{Vo.suspense=n}}),[e,t]),r},useTransition:function(e){var t=os(rs),n=t[0];return t=t[1],[vs(ws.bind(null,t,e),[t,e]),n]}},ks=null,As=null,Es=!1;function Ms(e,t){var n=zc(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.effectTag=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function Rs(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);default:return!1}}function Os(e){if(Es){var t=As;if(t){var n=t;if(!Rs(e,t)){if(!(t=An(n.nextSibling))||!Rs(e,t))return e.effectTag=-1025&e.effectTag|2,Es=!1,void(ks=e);Ms(ks,n)}ks=e,As=An(t.firstChild)}else e.effectTag=-1025&e.effectTag|2,Es=!1,ks=e}}function Ps(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ks=e}function xs(e){if(e!==ks)return!1;if(!Es)return Ps(e),Es=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!Tn(t,e.memoizedProps))for(t=As;t;)Ms(e,t),t=An(t.nextSibling);if(Ps(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if(n===vn){if(0===t){As=An(e.nextSibling);break e}t--}else n!==yn&&n!==wn&&n!==bn||t++}e=e.nextSibling}As=null}}else As=ks?An(e.stateNode.nextSibling):null;return!0}function Ns(){As=ks=null,Es=!1}var Bs=G.ReactCurrentOwner,Ds=!1;function Ls(e,t,n,r){t.child=null===e?Po(t,null,n,r):Oo(t,e.child,n,r)}function Fs(e,t,n,r,i){n=n.render;var o=t.ref;return co(t,i),r=es(e,t,n,r,o,i),null===e||Ds?(t.effectTag|=1,Ls(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.effectTag&=-517,e.expirationTime<=i&&(e.expirationTime=0),ta(e,t,i))}function Us(e,t,n,r,i,o){if(null===e){var s=n.type;return"function"!==typeof s||Hc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=jc(n.type,null,r,null,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,qs(e,t,s,r,i,o))}return s=e.child,i<o&&(i=s.memoizedProps,(n=null!==(n=n.compare)?n:Kr)(i,r)&&e.ref===t.ref)?ta(e,t,o):(t.effectTag|=1,(e=$c(s,r)).ref=t.ref,e.return=t,t.child=e)}function qs(e,t,n,r,i,o){return null!==e&&Kr(e.memoizedProps,r)&&e.ref===t.ref&&(Ds=!1,i<o)?(t.expirationTime=e.expirationTime,ta(e,t,o)):Hs(e,t,n,r,o)}function zs(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.effectTag|=128)}function Hs(e,t,n,r,i){var o=_i(n)?bi:yi.current;return o=wi(t,o),co(t,i),n=es(e,t,n,r,o,i),null===e||Ds?(t.effectTag|=1,Ls(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.effectTag&=-517,e.expirationTime<=i&&(e.expirationTime=0),ta(e,t,i))}function $s(e,t,n,r,i){if(_i(n)){var o=!0;Si(t)}else o=!1;if(co(t,i),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),To(t,n,r),ko(t,n,r,i),r=!0;else if(null===e){var s=t.stateNode,a=t.memoizedProps;s.props=a;var c=s.context,l=n.contextType;"object"===typeof l&&null!==l?l=lo(l):l=wi(t,l=_i(n)?bi:yi.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof s.getSnapshotBeforeUpdate;d||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==r||c!==l)&&So(t,s,r,l),uo=!1;var h=t.memoizedState;s.state=h,yo(t,r,s,i),c=t.memoizedState,a!==r||h!==c||vi.current||uo?("function"===typeof u&&(_o(t,n,u,r),c=t.memoizedState),(a=uo||Io(t,n,a,r,h,c,l))?(d||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.effectTag|=4)):("function"===typeof s.componentDidMount&&(t.effectTag|=4),t.memoizedProps=r,t.memoizedState=c),s.props=r,s.state=c,s.context=l,r=a):("function"===typeof s.componentDidMount&&(t.effectTag|=4),r=!1)}else s=t.stateNode,po(e,t),a=t.memoizedProps,s.props=t.type===t.elementType?a:eo(t.type,a),c=s.context,"object"===typeof(l=n.contextType)&&null!==l?l=lo(l):l=wi(t,l=_i(n)?bi:yi.current),(d="function"===typeof(u=n.getDerivedStateFromProps)||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==r||c!==l)&&So(t,s,r,l),uo=!1,c=t.memoizedState,s.state=c,yo(t,r,s,i),h=t.memoizedState,a!==r||c!==h||vi.current||uo?("function"===typeof u&&(_o(t,n,u,r),h=t.memoizedState),(u=uo||Io(t,n,a,r,c,h,l))?(d||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,h,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,h,l)),"function"===typeof s.componentDidUpdate&&(t.effectTag|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.effectTag|=256)):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&c===e.memoizedState||(t.effectTag|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&c===e.memoizedState||(t.effectTag|=256),t.memoizedProps=r,t.memoizedState=h),s.props=r,s.state=h,s.context=l,r=u):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&c===e.memoizedState||(t.effectTag|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&c===e.memoizedState||(t.effectTag|=256),r=!1);return js(e,t,n,r,o,i)}function js(e,t,n,r,i,o){zs(e,t);var s=0!==(64&t.effectTag);if(!r&&!s)return i&&ki(t,n,!1),ta(e,t,o);r=t.stateNode,Bs.current=t;var a=s&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.effectTag|=1,null!==e&&s?(t.child=Oo(t,e.child,null,o),t.child=Oo(t,null,a,o)):Ls(e,t,a,o),t.memoizedState=r.state,i&&ki(t,n,!0),t.child}function Ks(e){var t=e.stateNode;t.pendingContext?Ii(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ii(0,t.context,!1),Fo(e,t.containerInfo)}var Vs,Ws,Qs,Ys,Gs={dehydrated:null,retryTime:0};function Js(e,t,n){var r,i=t.mode,o=t.pendingProps,s=Ho.current,a=!1;if((r=0!==(64&t.effectTag))||(r=0!==(2&s)&&(null===e||null!==e.memoizedState)),r?(a=!0,t.effectTag&=-65):null!==e&&null===e.memoizedState||void 0===o.fallback||!0===o.unstable_avoidThisFallback||(s|=1),gi(Ho,1&s),null===e){if(void 0!==o.fallback&&Os(t),a){if(a=o.fallback,(o=Kc(null,i,0,null)).return=t,0===(2&t.mode))for(e=null!==t.memoizedState?t.child.child:t.child,o.child=e;null!==e;)e.return=o,e=e.sibling;return(n=Kc(a,i,n,null)).return=t,o.sibling=n,t.memoizedState=Gs,t.child=o,n}return i=o.children,t.memoizedState=null,t.child=Po(t,null,i,n)}if(null!==e.memoizedState){if(i=(e=e.child).sibling,a){if(o=o.fallback,(n=$c(e,e.pendingProps)).return=t,0===(2&t.mode)&&(a=null!==t.memoizedState?t.child.child:t.child)!==e.child)for(n.child=a;null!==a;)a.return=n,a=a.sibling;return(i=$c(i,o)).return=t,n.sibling=i,n.childExpirationTime=0,t.memoizedState=Gs,t.child=n,i}return n=Oo(t,e.child,o.children,n),t.memoizedState=null,t.child=n}if(e=e.child,a){if(a=o.fallback,(o=Kc(null,i,0,null)).return=t,o.child=e,null!==e&&(e.return=o),0===(2&t.mode))for(e=null!==t.memoizedState?t.child.child:t.child,o.child=e;null!==e;)e.return=o,e=e.sibling;return(n=Kc(a,i,n,null)).return=t,o.sibling=n,n.effectTag|=2,o.childExpirationTime=0,t.memoizedState=Gs,t.child=o,n}return t.memoizedState=null,t.child=Oo(t,e,o.children,n)}function Xs(e,t){e.expirationTime<t&&(e.expirationTime=t);var n=e.alternate;null!==n&&n.expirationTime<t&&(n.expirationTime=t),ao(e.return,t)}function Zs(e,t,n,r,i,o){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailExpiration:0,tailMode:i,lastEffect:o}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailExpiration=0,s.tailMode=i,s.lastEffect=o)}function ea(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(Ls(e,t,r.children,n),0!==(2&(r=Ho.current)))r=1&r|2,t.effectTag|=64;else{if(null!==e&&0!==(64&e.effectTag))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Xs(e,n);else if(19===e.tag)Xs(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(gi(Ho,r),0===(2&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===$o(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Zs(t,!1,i,n,o,t.lastEffect);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===$o(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Zs(t,!0,n,null,o,t.lastEffect);break;case"together":Zs(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function ta(e,t,n){null!==e&&(t.dependencies=e.dependencies);var r=t.expirationTime;if(0!==r&&Ic(r),t.childExpirationTime<n)return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=$c(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=$c(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function na(e,t){switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function ra(e,t,n){var r=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:case 17:return _i(t.type)&&Ci(),null;case 3:return Uo(),fi(vi),fi(yi),(n=t.stateNode).pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||!xs(t)||(t.effectTag|=4),Ws(t),null;case 5:zo(t),n=Lo(Do.current);var o=t.type;if(null!==e&&null!=t.stateNode)Qs(e,t,o,r,n),e.ref!==t.ref&&(t.effectTag|=128);else{if(!r){if(null===t.stateNode)throw Error(s(166));return null}if(e=Lo(No.current),xs(t)){r=t.stateNode,o=t.type;var a=t.memoizedProps;switch(r[Rn]=t,r[On]=a,o){case"iframe":case"object":case"embed":Qt("load",r);break;case"video":case"audio":for(e=0;e<Je.length;e++)Qt(Je[e],r);break;case"source":Qt("error",r);break;case"img":case"image":case"link":Qt("error",r),Qt("load",r);break;case"form":Qt("reset",r),Qt("submit",r);break;case"details":Qt("toggle",r);break;case"input":Ie(r,a),Qt("invalid",r),ln(n,"onChange");break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Qt("invalid",r),ln(n,"onChange");break;case"textarea":Oe(r,a),Qt("invalid",r),ln(n,"onChange")}for(var c in sn(o,a),e=null,a)if(a.hasOwnProperty(c)){var l=a[c];"children"===c?"string"===typeof l?r.textContent!==l&&(e=["children",l]):"number"===typeof l&&r.textContent!==""+l&&(e=["children",""+l]):T.hasOwnProperty(c)&&null!=l&&ln(n,c)}switch(o){case"input":we(r),ke(r,a,!0);break;case"textarea":we(r),xe(r);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(r.onclick=un)}n=e,t.updateQueue=n,null!==n&&(t.effectTag|=4)}else{switch(c=9===n.nodeType?n:n.ownerDocument,e===cn&&(e=De(o)),e===cn?"script"===o?((e=c.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=c.createElement(o,{is:r.is}):(e=c.createElement(o),"select"===o&&(c=e,r.multiple?c.multiple=!0:r.size&&(c.size=r.size))):e=c.createElementNS(e,o),e[Rn]=t,e[On]=r,Vs(e,t,!1,!1),t.stateNode=e,c=an(o,r),o){case"iframe":case"object":case"embed":Qt("load",e),l=r;break;case"video":case"audio":for(l=0;l<Je.length;l++)Qt(Je[l],e);l=r;break;case"source":Qt("error",e),l=r;break;case"img":case"image":case"link":Qt("error",e),Qt("load",e),l=r;break;case"form":Qt("reset",e),Qt("submit",e),l=r;break;case"details":Qt("toggle",e),l=r;break;case"input":Ie(e,r),l=Ce(e,r),Qt("invalid",e),ln(n,"onChange");break;case"option":l=Ee(e,r);break;case"select":e._wrapperState={wasMultiple:!!r.multiple},l=i({},r,{value:void 0}),Qt("invalid",e),ln(n,"onChange");break;case"textarea":Oe(e,r),l=Re(e,r),Qt("invalid",e),ln(n,"onChange");break;default:l=r}sn(o,l);var u=l;for(a in u)if(u.hasOwnProperty(a)){var d=u[a];"style"===a?rn(e,d):"dangerouslySetInnerHTML"===a?null!=(d=d?d.__html:void 0)&&qe(e,d):"children"===a?"string"===typeof d?("textarea"!==o||""!==d)&&ze(e,d):"number"===typeof d&&ze(e,""+d):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(T.hasOwnProperty(a)?null!=d&&ln(n,a):null!=d&&J(e,a,d,c))}switch(o){case"input":we(e),ke(e,r,!1);break;case"textarea":we(e),xe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+ve(r.value));break;case"select":e.multiple=!!r.multiple,null!=(n=r.value)?Me(e,!!r.multiple,n,!1):null!=r.defaultValue&&Me(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof l.onClick&&(e.onclick=un)}In(o,r)&&(t.effectTag|=4)}null!==t.ref&&(t.effectTag|=128)}return null;case 6:if(e&&null!=t.stateNode)Ys(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));n=Lo(Do.current),Lo(No.current),xs(t)?(n=t.stateNode,r=t.memoizedProps,n[Rn]=t,n.nodeValue!==r&&(t.effectTag|=4)):((n=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[Rn]=t,t.stateNode=n)}return null;case 13:return fi(Ho),r=t.memoizedState,0!==(64&t.effectTag)?(t.expirationTime=n,t):(n=null!==r,r=!1,null===e?void 0!==t.memoizedProps.fallback&&xs(t):(r=null!==(o=e.memoizedState),n||null===o||null!==(o=e.child.sibling)&&(null!==(a=t.firstEffect)?(t.firstEffect=o,o.nextEffect=a):(t.firstEffect=t.lastEffect=o,o.nextEffect=null),o.effectTag=8)),n&&!r&&0!==(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!==(1&Ho.current)?$a===xa&&($a=Da):($a!==xa&&$a!==Da||($a=La),0!==Qa&&null!==qa&&(Gc(qa,Ha),Jc(qa,Qa)))),(n||r)&&(t.effectTag|=4),null);case 4:return Uo(),Ws(t),null;case 10:return so(t),null;case 19:if(fi(Ho),null===(r=t.memoizedState))return null;if(o=0!==(64&t.effectTag),null===(a=r.rendering)){if(o)na(r,!1);else if($a!==xa||null!==e&&0!==(64&e.effectTag))for(a=t.child;null!==a;){if(null!==(e=$o(a))){for(t.effectTag|=64,na(r,!1),null!==(o=e.updateQueue)&&(t.updateQueue=o,t.effectTag|=4),null===r.lastEffect&&(t.firstEffect=null),t.lastEffect=r.lastEffect,r=t.child;null!==r;)a=n,(o=r).effectTag&=2,o.nextEffect=null,o.firstEffect=null,o.lastEffect=null,null===(e=o.alternate)?(o.childExpirationTime=0,o.expirationTime=a,o.child=null,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null):(o.childExpirationTime=e.childExpirationTime,o.expirationTime=e.expirationTime,o.child=e.child,o.memoizedProps=e.memoizedProps,o.memoizedState=e.memoizedState,o.updateQueue=e.updateQueue,a=e.dependencies,o.dependencies=null===a?null:{expirationTime:a.expirationTime,firstContext:a.firstContext,responders:a.responders}),r=r.sibling;return gi(Ho,1&Ho.current|2),t.child}a=a.sibling}}else{if(!o)if(null!==(e=$o(a))){if(t.effectTag|=64,o=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.effectTag|=4),na(r,!0),null===r.tail&&"hidden"===r.tailMode&&!a.alternate)return null!==(t=t.lastEffect=r.lastEffect)&&(t.nextEffect=null),null}else 2*Ki()-r.renderingStartTime>r.tailExpiration&&1<n&&(t.effectTag|=64,o=!0,na(r,!1),t.expirationTime=t.childExpirationTime=n-1);r.isBackwards?(a.sibling=t.child,t.child=a):(null!==(n=r.last)?n.sibling=a:t.child=a,r.last=a)}return null!==r.tail?(0===r.tailExpiration&&(r.tailExpiration=Ki()+500),n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=t.lastEffect,r.renderingStartTime=Ki(),n.sibling=null,t=Ho.current,gi(Ho,o?1&t|2:1&t),n):null}throw Error(s(156,t.tag))}function ia(e){switch(e.tag){case 1:_i(e.type)&&Ci();var t=e.effectTag;return 4096&t?(e.effectTag=-4097&t|64,e):null;case 3:if(Uo(),fi(vi),fi(yi),0!==(64&(t=e.effectTag)))throw Error(s(285));return e.effectTag=-4097&t|64,e;case 5:return zo(e),null;case 13:return fi(Ho),4096&(t=e.effectTag)?(e.effectTag=-4097&t|64,e):null;case 19:return fi(Ho),null;case 4:return Uo(),null;case 10:return so(e),null;default:return null}}function oa(e,t){return{value:e,source:t,stack:ye(t)}}Vs=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ws=function(){},Qs=function(e,t,n,r,o){var s=e.memoizedProps;if(s!==r){var a,c,l=t.stateNode;switch(Lo(No.current),e=null,n){case"input":s=Ce(l,s),r=Ce(l,r),e=[];break;case"option":s=Ee(l,s),r=Ee(l,r),e=[];break;case"select":s=i({},s,{value:void 0}),r=i({},r,{value:void 0}),e=[];break;case"textarea":s=Re(l,s),r=Re(l,r),e=[];break;default:"function"!==typeof s.onClick&&"function"===typeof r.onClick&&(l.onclick=un)}for(a in sn(n,r),n=null,s)if(!r.hasOwnProperty(a)&&s.hasOwnProperty(a)&&null!=s[a])if("style"===a)for(c in l=s[a])l.hasOwnProperty(c)&&(n||(n={}),n[c]="");else"dangerouslySetInnerHTML"!==a&&"children"!==a&&"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(T.hasOwnProperty(a)?e||(e=[]):(e=e||[]).push(a,null));for(a in r){var u=r[a];if(l=null!=s?s[a]:void 0,r.hasOwnProperty(a)&&u!==l&&(null!=u||null!=l))if("style"===a)if(l){for(c in l)!l.hasOwnProperty(c)||u&&u.hasOwnProperty(c)||(n||(n={}),n[c]="");for(c in u)u.hasOwnProperty(c)&&l[c]!==u[c]&&(n||(n={}),n[c]=u[c])}else n||(e||(e=[]),e.push(a,n)),n=u;else"dangerouslySetInnerHTML"===a?(u=u?u.__html:void 0,l=l?l.__html:void 0,null!=u&&l!==u&&(e=e||[]).push(a,u)):"children"===a?l===u||"string"!==typeof u&&"number"!==typeof u||(e=e||[]).push(a,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&(T.hasOwnProperty(a)?(null!=u&&ln(o,a),e||l===u||(e=[])):(e=e||[]).push(a,u))}n&&(e=e||[]).push("style",n),o=e,(t.updateQueue=o)&&(t.effectTag|=4)}},Ys=function(e,t,n,r){n!==r&&(t.effectTag|=4)};var sa="function"===typeof WeakSet?WeakSet:Set;function aa(e,t){var n=t.source,r=t.stack;null===r&&null!==n&&(r=ye(n)),null!==n&&me(n.type),t=t.value,null!==e&&1===e.tag&&me(e.type);try{console.error(t)}catch(i){setTimeout((function(){throw i}))}}function ca(e){var t=e.ref;if(null!==t)if("function"===typeof t)try{t(null)}catch(n){Bc(e,n)}else t.current=null}function la(e,t){switch(t.tag){case 0:case 11:case 15:case 22:case 3:case 5:case 6:case 4:case 17:return;case 1:if(256&t.effectTag&&null!==e){var n=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:eo(t.type,n),r),e.__reactInternalSnapshotBeforeUpdate=t}return}throw Error(s(163))}function ua(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.destroy;n.destroy=void 0,void 0!==r&&r()}n=n.next}while(n!==t)}}function da(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function ha(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:return void da(3,n);case 1:if(e=n.stateNode,4&n.effectTag)if(null===t)e.componentDidMount();else{var r=n.elementType===n.type?t.memoizedProps:eo(n.type,t.memoizedProps);e.componentDidUpdate(r,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate)}return void(null!==(t=n.updateQueue)&&vo(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:case 1:e=n.child.stateNode}vo(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.effectTag&&In(n.type,n.memoizedProps)&&e.focus());case 6:case 4:case 12:case 19:case 17:case 20:case 21:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&Lt(n)))))}throw Error(s(163))}function pa(e,t,n){switch("function"===typeof Uc&&Uc(t),t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var r=e.next;Qi(97<n?97:n,(function(){var e=r;do{var n=e.destroy;if(void 0!==n){var i=t;try{n()}catch(o){Bc(i,o)}}e=e.next}while(e!==r)}))}break;case 1:ca(t),"function"===typeof(n=t.stateNode).componentWillUnmount&&function(e,t){try{t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()}catch(n){Bc(e,n)}}(t,n);break;case 5:ca(t);break;case 4:ba(e,t,n)}}function fa(e){var t=e.alternate;e.return=null,e.child=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.alternate=null,e.firstEffect=null,e.lastEffect=null,e.pendingProps=null,e.memoizedProps=null,e.stateNode=null,null!==t&&fa(t)}function ga(e){return 5===e.tag||3===e.tag||4===e.tag}function ma(e){e:{for(var t=e.return;null!==t;){if(ga(t)){var n=t;break e}t=t.return}throw Error(s(160))}switch(t=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:t=t.containerInfo,r=!0;break;default:throw Error(s(161))}16&n.effectTag&&(ze(t,""),n.effectTag&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||ga(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.effectTag)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.effectTag)){n=n.stateNode;break e}}r?ya(e,n,t):va(e,n,t)}function ya(e,t,n){var r=e.tag,i=5===r||6===r;if(i)e=i?e.stateNode:e.stateNode.instance,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=un));else if(4!==r&&null!==(e=e.child))for(ya(e,t,n),e=e.sibling;null!==e;)ya(e,t,n),e=e.sibling}function va(e,t,n){var r=e.tag,i=5===r||6===r;if(i)e=i?e.stateNode:e.stateNode.instance,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(va(e,t,n),e=e.sibling;null!==e;)va(e,t,n),e=e.sibling}function ba(e,t,n){for(var r,i,o=t,a=!1;;){if(!a){a=o.return;e:for(;;){if(null===a)throw Error(s(160));switch(r=a.stateNode,a.tag){case 5:i=!1;break e;case 3:case 4:r=r.containerInfo,i=!0;break e}a=a.return}a=!0}if(5===o.tag||6===o.tag){e:for(var c=e,l=o,u=n,d=l;;)if(pa(c,d,u),null!==d.child&&4!==d.tag)d.child.return=d,d=d.child;else{if(d===l)break e;for(;null===d.sibling;){if(null===d.return||d.return===l)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}i?(c=r,l=o.stateNode,8===c.nodeType?c.parentNode.removeChild(l):c.removeChild(l)):r.removeChild(o.stateNode)}else if(4===o.tag){if(null!==o.child){r=o.stateNode.containerInfo,i=!0,o.child.return=o,o=o.child;continue}}else if(pa(e,o,n),null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)break;for(;null===o.sibling;){if(null===o.return||o.return===t)return;4===(o=o.return).tag&&(a=!1)}o.sibling.return=o.return,o=o.sibling}}function wa(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:return void ua(3,t);case 1:case 12:case 17:return;case 5:var n=t.stateNode;if(null!=n){var r=t.memoizedProps,i=null!==e?e.memoizedProps:r;e=t.type;var o=t.updateQueue;if(t.updateQueue=null,null!==o){for(n[On]=r,"input"===e&&"radio"===r.type&&null!=r.name&&Te(n,r),an(e,i),t=an(e,r),i=0;i<o.length;i+=2){var a=o[i],c=o[i+1];"style"===a?rn(n,c):"dangerouslySetInnerHTML"===a?qe(n,c):"children"===a?ze(n,c):J(n,a,c,t)}switch(e){case"input":Se(n,r);break;case"textarea":Pe(n,r);break;case"select":t=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(e=r.value)?Me(n,!!r.multiple,e,!1):t!==!!r.multiple&&(null!=r.defaultValue?Me(n,!!r.multiple,r.defaultValue,!0):Me(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(s(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((t=t.stateNode).hydrate&&(t.hydrate=!1,Lt(t.containerInfo)));case 13:if(n=t,null===t.memoizedState?r=!1:(r=!0,n=t.child,Ga=Ki()),null!==n)e:for(e=n;;){if(5===e.tag)o=e.stateNode,r?"function"===typeof(o=o.style).setProperty?o.setProperty("display","none","important"):o.display="none":(o=e.stateNode,i=void 0!==(i=e.memoizedProps.style)&&null!==i&&i.hasOwnProperty("display")?i.display:null,o.style.display=nn("display",i));else if(6===e.tag)e.stateNode.nodeValue=r?"":e.memoizedProps;else{if(13===e.tag&&null!==e.memoizedState&&null===e.memoizedState.dehydrated){(o=e.child.sibling).return=e,e=o;continue}if(null!==e.child){e.child.return=e,e=e.child;continue}}if(e===n)break;for(;null===e.sibling;){if(null===e.return||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}return void _a(t);case 19:return void _a(t)}throw Error(s(163))}function _a(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new sa),t.forEach((function(t){var r=Lc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}var Ca="function"===typeof WeakMap?WeakMap:Map;function Ia(e,t,n){(n=fo(n,null)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Za||(Za=!0,ec=r),aa(e,t)},n}function Ta(e,t,n){(n=fo(n,null)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return aa(e,t),r(i)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){"function"!==typeof r&&(null===tc?tc=new Set([this]):tc.add(this),aa(e,t));var n=t.stack;this.componentDidCatch(t.value,{componentStack:null!==n?n:""})}),n}var Sa,ka=Math.ceil,Aa=G.ReactCurrentDispatcher,Ea=G.ReactCurrentOwner,Ma=0,Ra=8,Oa=16,Pa=32,xa=0,Na=1,Ba=2,Da=3,La=4,Fa=5,Ua=Ma,qa=null,za=null,Ha=0,$a=xa,ja=null,Ka=1073741823,Va=1073741823,Wa=null,Qa=0,Ya=!1,Ga=0,Ja=500,Xa=null,Za=!1,ec=null,tc=null,nc=!1,rc=null,ic=90,oc=null,sc=0,ac=null,cc=0;function lc(){return(Ua&(Oa|Pa))!==Ma?1073741821-(Ki()/10|0):0!==cc?cc:cc=1073741821-(Ki()/10|0)}function uc(e,t,n){if(0===(2&(t=t.mode)))return 1073741823;var r=Vi();if(0===(4&t))return 99===r?1073741823:1073741822;if((Ua&Oa)!==Ma)return Ha;if(null!==n)e=Zi(e,0|n.timeoutMs||5e3,250);else switch(r){case 99:e=1073741823;break;case 98:e=Zi(e,150,100);break;case 97:case 96:e=Zi(e,5e3,250);break;case 95:e=2;break;default:throw Error(s(326))}return null!==qa&&e===Ha&&--e,e}function dc(e,t){if(50<sc)throw sc=0,ac=null,Error(s(185));if(null!==(e=hc(e,t))){var n=Vi();1073741823===t?(Ua&Ra)!==Ma&&(Ua&(Oa|Pa))===Ma?mc(e):(fc(e),Ua===Ma&&Ji()):fc(e),(4&Ua)===Ma||98!==n&&99!==n||(null===oc?oc=new Map([[e,t]]):(void 0===(n=oc.get(e))||n>t)&&oc.set(e,t))}}function hc(e,t){e.expirationTime<t&&(e.expirationTime=t);var n=e.alternate;null!==n&&n.expirationTime<t&&(n.expirationTime=t);var r=e.return,i=null;if(null===r&&3===e.tag)i=e.stateNode;else for(;null!==r;){if(n=r.alternate,r.childExpirationTime<t&&(r.childExpirationTime=t),null!==n&&n.childExpirationTime<t&&(n.childExpirationTime=t),null===r.return&&3===r.tag){i=r.stateNode;break}r=r.return}return null!==i&&(qa===i&&(Ic(t),$a===La&&Gc(i,Ha)),Jc(i,t)),i}function pc(e){var t=e.lastExpiredTime;if(0!==t)return t;if(!Yc(e,t=e.firstPendingTime))return t;var n=e.lastPingedTime;return 2>=(e=n>(e=e.nextKnownPendingLevel)?n:e)&&t!==e?0:e}function fc(e){if(0!==e.lastExpiredTime)e.callbackExpirationTime=1073741823,e.callbackPriority=99,e.callbackNode=Gi(mc.bind(null,e));else{var t=pc(e),n=e.callbackNode;if(0===t)null!==n&&(e.callbackNode=null,e.callbackExpirationTime=0,e.callbackPriority=90);else{var r=lc();if(1073741823===t?r=99:1===t||2===t?r=95:r=0>=(r=10*(1073741821-t)-10*(1073741821-r))?99:250>=r?98:5250>=r?97:95,null!==n){var i=e.callbackPriority;if(e.callbackExpirationTime===t&&i>=r)return;n!==Fi&&Mi(n)}e.callbackExpirationTime=t,e.callbackPriority=r,t=1073741823===t?Gi(mc.bind(null,e)):Yi(r,gc.bind(null,e),{timeout:10*(1073741821-t)-Ki()}),e.callbackNode=t}}}function gc(e,t){if(cc=0,t)return Xc(e,t=lc()),fc(e),null;var n=pc(e);if(0!==n){if(t=e.callbackNode,(Ua&(Oa|Pa))!==Ma)throw Error(s(327));if(Pc(),e===qa&&n===Ha||bc(e,n),null!==za){var r=Ua;Ua|=Oa;for(var i=_c();;)try{Sc();break}catch(c){wc(e,c)}if(oo(),Ua=r,Aa.current=i,$a===Na)throw t=ja,bc(e,n),Gc(e,n),fc(e),t;if(null===za)switch(i=e.finishedWork=e.current.alternate,e.finishedExpirationTime=n,r=$a,qa=null,r){case xa:case Na:throw Error(s(345));case Ba:Xc(e,2<n?2:n);break;case Da:if(Gc(e,n),n===(r=e.lastSuspendedTime)&&(e.nextKnownPendingLevel=Ec(i)),1073741823===Ka&&10<(i=Ga+Ja-Ki())){if(Ya){var o=e.lastPingedTime;if(0===o||o>=n){e.lastPingedTime=n,bc(e,n);break}}if(0!==(o=pc(e))&&o!==n)break;if(0!==r&&r!==n){e.lastPingedTime=r;break}e.timeoutHandle=Sn(Mc.bind(null,e),i);break}Mc(e);break;case La:if(Gc(e,n),n===(r=e.lastSuspendedTime)&&(e.nextKnownPendingLevel=Ec(i)),Ya&&(0===(i=e.lastPingedTime)||i>=n)){e.lastPingedTime=n,bc(e,n);break}if(0!==(i=pc(e))&&i!==n)break;if(0!==r&&r!==n){e.lastPingedTime=r;break}if(1073741823!==Va?r=10*(1073741821-Va)-Ki():1073741823===Ka?r=0:(r=10*(1073741821-Ka)-5e3,0>(r=(i=Ki())-r)&&(r=0),(n=10*(1073741821-n)-i)<(r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ka(r/1960))-r)&&(r=n)),10<r){e.timeoutHandle=Sn(Mc.bind(null,e),r);break}Mc(e);break;case Fa:if(1073741823!==Ka&&null!==Wa){o=Ka;var a=Wa;if(0>=(r=0|a.busyMinDurationMs)?r=0:(i=0|a.busyDelayMs,r=(o=Ki()-(10*(1073741821-o)-(0|a.timeoutMs||5e3)))<=i?0:i+r-o),10<r){Gc(e,n),e.timeoutHandle=Sn(Mc.bind(null,e),r);break}}Mc(e);break;default:throw Error(s(329))}if(fc(e),e.callbackNode===t)return gc.bind(null,e)}}return null}function mc(e){var t=e.lastExpiredTime;if(t=0!==t?t:1073741823,(Ua&(Oa|Pa))!==Ma)throw Error(s(327));if(Pc(),e===qa&&t===Ha||bc(e,t),null!==za){var n=Ua;Ua|=Oa;for(var r=_c();;)try{Tc();break}catch(i){wc(e,i)}if(oo(),Ua=n,Aa.current=r,$a===Na)throw n=ja,bc(e,t),Gc(e,t),fc(e),n;if(null!==za)throw Error(s(261));e.finishedWork=e.current.alternate,e.finishedExpirationTime=t,qa=null,Mc(e),fc(e)}return null}function yc(e,t){var n=Ua;Ua|=1;try{return e(t)}finally{(Ua=n)===Ma&&Ji()}}function vc(e,t){var n=Ua;Ua&=-2,Ua|=Ra;try{return e(t)}finally{(Ua=n)===Ma&&Ji()}}function bc(e,t){e.finishedWork=null,e.finishedExpirationTime=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,kn(n)),null!==za)for(n=za.return;null!==n;){var r=n;switch(r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ci();break;case 3:Uo(),fi(vi),fi(yi);break;case 5:zo(r);break;case 4:Uo();break;case 13:case 19:fi(Ho);break;case 10:so(r)}n=n.return}qa=e,za=$c(e.current,null),Ha=t,$a=xa,ja=null,Va=Ka=1073741823,Wa=null,Qa=0,Ya=!1}function wc(e,t){for(;;){try{if(oo(),Ko.current=Cs,Jo)for(var n=Qo.memoizedState;null!==n;){var r=n.queue;null!==r&&(r.pending=null),n=n.next}if(Wo=0,Go=Yo=Qo=null,Jo=!1,null===za||null===za.return)return $a=Na,ja=t,za=null;e:{var i=e,o=za.return,s=za,a=t;if(t=Ha,s.effectTag|=2048,s.firstEffect=s.lastEffect=null,null!==a&&"object"===typeof a&&"function"===typeof a.then){var c=a;if(0===(2&s.mode)){var l=s.alternate;l?(s.updateQueue=l.updateQueue,s.memoizedState=l.memoizedState,s.expirationTime=l.expirationTime):(s.updateQueue=null,s.memoizedState=null)}var u=0!==(1&Ho.current),d=o;do{var h;if(h=13===d.tag){var p=d.memoizedState;if(null!==p)h=null!==p.dehydrated;else{var f=d.memoizedProps;h=void 0!==f.fallback&&(!0!==f.unstable_avoidThisFallback||!u)}}if(h){var g=d.updateQueue;if(null===g){var m=new Set;m.add(c),d.updateQueue=m}else g.add(c);if(0===(2&d.mode)){if(d.effectTag|=64,s.effectTag&=-2981,1===s.tag)if(null===s.alternate)s.tag=17;else{var y=fo(1073741823,null);y.tag=2,go(s,y)}s.expirationTime=1073741823;break e}a=void 0,s=t;var v=i.pingCache;if(null===v?(v=i.pingCache=new Ca,a=new Set,v.set(c,a)):void 0===(a=v.get(c))&&(a=new Set,v.set(c,a)),!a.has(s)){a.add(s);var b=Dc.bind(null,i,c,s);c.then(b,b)}d.effectTag|=4096,d.expirationTime=t;break e}d=d.return}while(null!==d);a=Error((me(s.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+ye(s))}$a!==Fa&&($a=Ba),a=oa(a,s),d=o;do{switch(d.tag){case 3:c=a,d.effectTag|=4096,d.expirationTime=t,mo(d,Ia(d,c,t));break e;case 1:c=a;var w=d.type,_=d.stateNode;if(0===(64&d.effectTag)&&("function"===typeof w.getDerivedStateFromError||null!==_&&"function"===typeof _.componentDidCatch&&(null===tc||!tc.has(_)))){d.effectTag|=4096,d.expirationTime=t,mo(d,Ta(d,c,t));break e}}d=d.return}while(null!==d)}za=Ac(za)}catch(C){t=C;continue}break}}function _c(){var e=Aa.current;return Aa.current=Cs,null===e?Cs:e}function Cc(e,t){e<Ka&&2<e&&(Ka=e),null!==t&&e<Va&&2<e&&(Va=e,Wa=t)}function Ic(e){e>Qa&&(Qa=e)}function Tc(){for(;null!==za;)za=kc(za)}function Sc(){for(;null!==za&&!Ui();)za=kc(za)}function kc(e){var t=Sa(e.alternate,e,Ha);return e.memoizedProps=e.pendingProps,null===t&&(t=Ac(e)),Ea.current=null,t}function Ac(e){za=e;do{var t=za.alternate;if(e=za.return,0===(2048&za.effectTag)){if(t=ra(t,za,Ha),1===Ha||1!==za.childExpirationTime){for(var n=0,r=za.child;null!==r;){var i=r.expirationTime,o=r.childExpirationTime;i>n&&(n=i),o>n&&(n=o),r=r.sibling}za.childExpirationTime=n}if(null!==t)return t;null!==e&&0===(2048&e.effectTag)&&(null===e.firstEffect&&(e.firstEffect=za.firstEffect),null!==za.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=za.firstEffect),e.lastEffect=za.lastEffect),1<za.effectTag&&(null!==e.lastEffect?e.lastEffect.nextEffect=za:e.firstEffect=za,e.lastEffect=za))}else{if(null!==(t=ia(za)))return t.effectTag&=2047,t;null!==e&&(e.firstEffect=e.lastEffect=null,e.effectTag|=2048)}if(null!==(t=za.sibling))return t;za=e}while(null!==za);return $a===xa&&($a=Fa),null}function Ec(e){var t=e.expirationTime;return t>(e=e.childExpirationTime)?t:e}function Mc(e){var t=Vi();return Qi(99,Rc.bind(null,e,t)),null}function Rc(e,t){do{Pc()}while(null!==rc);if((Ua&(Oa|Pa))!==Ma)throw Error(s(327));var n=e.finishedWork,r=e.finishedExpirationTime;if(null===n)return null;if(e.finishedWork=null,e.finishedExpirationTime=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackExpirationTime=0,e.callbackPriority=90,e.nextKnownPendingLevel=0;var i=Ec(n);if(e.firstPendingTime=i,r<=e.lastSuspendedTime?e.firstSuspendedTime=e.lastSuspendedTime=e.nextKnownPendingLevel=0:r<=e.firstSuspendedTime&&(e.firstSuspendedTime=r-1),r<=e.lastPingedTime&&(e.lastPingedTime=0),r<=e.lastExpiredTime&&(e.lastExpiredTime=0),e===qa&&(za=qa=null,Ha=0),1<n.effectTag?null!==n.lastEffect?(n.lastEffect.nextEffect=n,i=n.firstEffect):i=n:i=n.firstEffect,null!==i){var o=Ua;Ua|=Pa,Ea.current=null,_n=Wt;var a=gn();if(mn(a)){if("selectionStart"in a)var c={start:a.selectionStart,end:a.selectionEnd};else e:{var l=(c=(c=a.ownerDocument)&&c.defaultView||window).getSelection&&c.getSelection();if(l&&0!==l.rangeCount){c=l.anchorNode;var u=l.anchorOffset,d=l.focusNode;l=l.focusOffset;try{c.nodeType,d.nodeType}catch(k){c=null;break e}var h=0,p=-1,f=-1,g=0,m=0,y=a,v=null;t:for(;;){for(var b;y!==c||0!==u&&3!==y.nodeType||(p=h+u),y!==d||0!==l&&3!==y.nodeType||(f=h+l),3===y.nodeType&&(h+=y.nodeValue.length),null!==(b=y.firstChild);)v=y,y=b;for(;;){if(y===a)break t;if(v===c&&++g===u&&(p=h),v===d&&++m===l&&(f=h),null!==(b=y.nextSibling))break;v=(y=v).parentNode}y=b}c=-1===p||-1===f?null:{start:p,end:f}}else c=null}c=c||{start:0,end:0}}else c=null;Cn={activeElementDetached:null,focusedElem:a,selectionRange:c},Wt=!1,Xa=i;do{try{Oc()}catch(k){if(null===Xa)throw Error(s(330));Bc(Xa,k),Xa=Xa.nextEffect}}while(null!==Xa);Xa=i;do{try{for(a=e,c=t;null!==Xa;){var w=Xa.effectTag;if(16&w&&ze(Xa.stateNode,""),128&w){var _=Xa.alternate;if(null!==_){var C=_.ref;null!==C&&("function"===typeof C?C(null):C.current=null)}}switch(1038&w){case 2:ma(Xa),Xa.effectTag&=-3;break;case 6:ma(Xa),Xa.effectTag&=-3,wa(Xa.alternate,Xa);break;case 1024:Xa.effectTag&=-1025;break;case 1028:Xa.effectTag&=-1025,wa(Xa.alternate,Xa);break;case 4:wa(Xa.alternate,Xa);break;case 8:ba(a,u=Xa,c),fa(u)}Xa=Xa.nextEffect}}catch(k){if(null===Xa)throw Error(s(330));Bc(Xa,k),Xa=Xa.nextEffect}}while(null!==Xa);if(C=Cn,_=gn(),w=C.focusedElem,c=C.selectionRange,_!==w&&w&&w.ownerDocument&&fn(w.ownerDocument.documentElement,w)){null!==c&&mn(w)&&(_=c.start,void 0===(C=c.end)&&(C=_),"selectionStart"in w?(w.selectionStart=_,w.selectionEnd=Math.min(C,w.value.length)):(C=(_=w.ownerDocument||document)&&_.defaultView||window).getSelection&&(C=C.getSelection(),u=w.textContent.length,a=Math.min(c.start,u),c=void 0===c.end?a:Math.min(c.end,u),!C.extend&&a>c&&(u=c,c=a,a=u),u=pn(w,a),d=pn(w,c),u&&d&&(1!==C.rangeCount||C.anchorNode!==u.node||C.anchorOffset!==u.offset||C.focusNode!==d.node||C.focusOffset!==d.offset)&&((_=_.createRange()).setStart(u.node,u.offset),C.removeAllRanges(),a>c?(C.addRange(_),C.extend(d.node,d.offset)):(_.setEnd(d.node,d.offset),C.addRange(_))))),_=[];for(C=w;C=C.parentNode;)1===C.nodeType&&_.push({element:C,left:C.scrollLeft,top:C.scrollTop});for("function"===typeof w.focus&&w.focus(),w=0;w<_.length;w++)(C=_[w]).element.scrollLeft=C.left,C.element.scrollTop=C.top}Wt=!!_n,Cn=_n=null,e.current=n,Xa=i;do{try{for(w=e;null!==Xa;){var I=Xa.effectTag;if(36&I&&ha(w,Xa.alternate,Xa),128&I){_=void 0;var T=Xa.ref;if(null!==T){var S=Xa.stateNode;Xa.tag,_=S,"function"===typeof T?T(_):T.current=_}}Xa=Xa.nextEffect}}catch(k){if(null===Xa)throw Error(s(330));Bc(Xa,k),Xa=Xa.nextEffect}}while(null!==Xa);Xa=null,qi(),Ua=o}else e.current=n;if(nc)nc=!1,rc=e,ic=t;else for(Xa=i;null!==Xa;)t=Xa.nextEffect,Xa.nextEffect=null,Xa=t;if(0===(t=e.firstPendingTime)&&(tc=null),1073741823===t?e===ac?sc++:(sc=0,ac=e):sc=0,"function"===typeof Fc&&Fc(n.stateNode,r),fc(e),Za)throw Za=!1,e=ec,ec=null,e;return(Ua&Ra)!==Ma||Ji(),null}function Oc(){for(;null!==Xa;){var e=Xa.effectTag;0!==(256&e)&&la(Xa.alternate,Xa),0===(512&e)||nc||(nc=!0,Yi(97,(function(){return Pc(),null}))),Xa=Xa.nextEffect}}function Pc(){if(90!==ic){var e=97<ic?97:ic;return ic=90,Qi(e,xc)}}function xc(){if(null===rc)return!1;var e=rc;if(rc=null,(Ua&(Oa|Pa))!==Ma)throw Error(s(331));var t=Ua;for(Ua|=Pa,e=e.current.firstEffect;null!==e;){try{var n=e;if(0!==(512&n.effectTag))switch(n.tag){case 0:case 11:case 15:case 22:ua(5,n),da(5,n)}}catch(r){if(null===e)throw Error(s(330));Bc(e,r)}n=e.nextEffect,e.nextEffect=null,e=n}return Ua=t,Ji(),!0}function Nc(e,t,n){go(e,t=Ia(e,t=oa(n,t),1073741823)),null!==(e=hc(e,1073741823))&&fc(e)}function Bc(e,t){if(3===e.tag)Nc(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){Nc(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"===typeof n.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===tc||!tc.has(r))){go(n,e=Ta(n,e=oa(t,e),1073741823)),null!==(n=hc(n,1073741823))&&fc(n);break}}n=n.return}}function Dc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),qa===e&&Ha===n?$a===La||$a===Da&&1073741823===Ka&&Ki()-Ga<Ja?bc(e,Ha):Ya=!0:Yc(e,n)&&(0!==(t=e.lastPingedTime)&&t<n||(e.lastPingedTime=n,fc(e)))}function Lc(e,t){var n=e.stateNode;null!==n&&n.delete(t),0===(t=0)&&(t=uc(t=lc(),e,null)),null!==(e=hc(e,t))&&fc(e)}Sa=function(e,t,n){var r=t.expirationTime;if(null!==e){var i=t.pendingProps;if(e.memoizedProps!==i||vi.current)Ds=!0;else{if(r<n){switch(Ds=!1,t.tag){case 3:Ks(t),Ns();break;case 5:if(qo(t),4&t.mode&&1!==n&&i.hidden)return t.expirationTime=t.childExpirationTime=1,null;break;case 1:_i(t.type)&&Si(t);break;case 4:Fo(t,t.stateNode.containerInfo);break;case 10:r=t.memoizedProps.value,i=t.type._context,gi(to,i._currentValue),i._currentValue=r;break;case 13:if(null!==t.memoizedState)return 0!==(r=t.child.childExpirationTime)&&r>=n?Js(e,t,n):(gi(Ho,1&Ho.current),null!==(t=ta(e,t,n))?t.sibling:null);gi(Ho,1&Ho.current);break;case 19:if(r=t.childExpirationTime>=n,0!==(64&e.effectTag)){if(r)return ea(e,t,n);t.effectTag|=64}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null),gi(Ho,Ho.current),!r)return null}return ta(e,t,n)}Ds=!1}}else Ds=!1;switch(t.expirationTime=0,t.tag){case 2:if(r=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),e=t.pendingProps,i=wi(t,yi.current),co(t,n),i=es(null,t,r,e,i,n),t.effectTag|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,_i(r)){var o=!0;Si(t)}else o=!1;t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,ho(t);var a=r.getDerivedStateFromProps;"function"===typeof a&&_o(t,r,a,e),i.updater=Co,t.stateNode=i,i._reactInternalFiber=t,ko(t,r,e,n),t=js(null,t,r,!0,o,n)}else t.tag=0,Ls(null,t,i,n),t=t.child;return t;case 16:e:{if(i=t.elementType,null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),e=t.pendingProps,function(e){if(-1===e._status){e._status=0;var t=e._ctor;t=t(),e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}}(i),1!==i._status)throw i._result;switch(i=i._result,t.type=i,o=t.tag=function(e){if("function"===typeof e)return Hc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===ce)return 11;if(e===de)return 14}return 2}(i),e=eo(i,e),o){case 0:t=Hs(null,t,i,e,n);break e;case 1:t=$s(null,t,i,e,n);break e;case 11:t=Fs(null,t,i,e,n);break e;case 14:t=Us(null,t,i,eo(i.type,e),r,n);break e}throw Error(s(306,i,""))}return t;case 0:return r=t.type,i=t.pendingProps,Hs(e,t,r,i=t.elementType===r?i:eo(r,i),n);case 1:return r=t.type,i=t.pendingProps,$s(e,t,r,i=t.elementType===r?i:eo(r,i),n);case 3:if(Ks(t),r=t.updateQueue,null===e||null===r)throw Error(s(282));if(r=t.pendingProps,i=null!==(i=t.memoizedState)?i.element:null,po(e,t),yo(t,r,null,n),(r=t.memoizedState.element)===i)Ns(),t=ta(e,t,n);else{if((i=t.stateNode.hydrate)&&(As=An(t.stateNode.containerInfo.firstChild),ks=t,i=Es=!0),i)for(n=Po(t,null,r,n),t.child=n;n;)n.effectTag=-3&n.effectTag|1024,n=n.sibling;else Ls(e,t,r,n),Ns();t=t.child}return t;case 5:return qo(t),null===e&&Os(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,a=i.children,Tn(r,i)?a=null:null!==o&&Tn(r,o)&&(t.effectTag|=16),zs(e,t),4&t.mode&&1!==n&&i.hidden?(t.expirationTime=t.childExpirationTime=1,t=null):(Ls(e,t,a,n),t=t.child),t;case 6:return null===e&&Os(t),null;case 13:return Js(e,t,n);case 4:return Fo(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Oo(t,null,r,n):Ls(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,Fs(e,t,r,i=t.elementType===r?i:eo(r,i),n);case 7:return Ls(e,t,t.pendingProps,n),t.child;case 8:case 12:return Ls(e,t,t.pendingProps.children,n),t.child;case 10:e:{r=t.type._context,i=t.pendingProps,a=t.memoizedProps,o=i.value;var c=t.type._context;if(gi(to,c._currentValue),c._currentValue=o,null!==a)if(c=a.value,0===(o=$r(c,o)?0:0|("function"===typeof r._calculateChangedBits?r._calculateChangedBits(c,o):1073741823))){if(a.children===i.children&&!vi.current){t=ta(e,t,n);break e}}else for(null!==(c=t.child)&&(c.return=t);null!==c;){var l=c.dependencies;if(null!==l){a=c.child;for(var u=l.firstContext;null!==u;){if(u.context===r&&0!==(u.observedBits&o)){1===c.tag&&((u=fo(n,null)).tag=2,go(c,u)),c.expirationTime<n&&(c.expirationTime=n),null!==(u=c.alternate)&&u.expirationTime<n&&(u.expirationTime=n),ao(c.return,n),l.expirationTime<n&&(l.expirationTime=n);break}u=u.next}}else a=10===c.tag&&c.type===t.type?null:c.child;if(null!==a)a.return=c;else for(a=c;null!==a;){if(a===t){a=null;break}if(null!==(c=a.sibling)){c.return=a.return,a=c;break}a=a.return}c=a}Ls(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=(o=t.pendingProps).children,co(t,n),r=r(i=lo(i,o.unstable_observedBits)),t.effectTag|=1,Ls(e,t,r,n),t.child;case 14:return o=eo(i=t.type,t.pendingProps),Us(e,t,i,o=eo(i.type,o),r,n);case 15:return qs(e,t,t.type,t.pendingProps,r,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:eo(r,i),null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),t.tag=1,_i(r)?(e=!0,Si(t)):e=!1,co(t,n),To(t,r,i),ko(t,r,i,n),js(null,t,r,!0,e,n);case 19:return ea(e,t,n)}throw Error(s(156,t.tag))};var Fc=null,Uc=null;function qc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childExpirationTime=this.expirationTime=0,this.alternate=null}function zc(e,t,n,r){return new qc(e,t,n,r)}function Hc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function $c(e,t){var n=e.alternate;return null===n?((n=zc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.effectTag=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childExpirationTime=e.childExpirationTime,n.expirationTime=e.expirationTime,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{expirationTime:t.expirationTime,firstContext:t.firstContext,responders:t.responders},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function jc(e,t,n,r,i,o){var a=2;if(r=e,"function"===typeof e)Hc(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case ne:return Kc(n.children,i,o,t);case ae:a=8,i|=7;break;case re:a=8,i|=1;break;case ie:return(e=zc(12,n,t,8|i)).elementType=ie,e.type=ie,e.expirationTime=o,e;case le:return(e=zc(13,n,t,i)).type=le,e.elementType=le,e.expirationTime=o,e;case ue:return(e=zc(19,n,t,i)).elementType=ue,e.expirationTime=o,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case oe:a=10;break e;case se:a=9;break e;case ce:a=11;break e;case de:a=14;break e;case he:a=16,r=null;break e;case pe:a=22;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=zc(a,n,t,i)).elementType=e,t.type=r,t.expirationTime=o,t}function Kc(e,t,n,r){return(e=zc(7,e,r,t)).expirationTime=n,e}function Vc(e,t,n){return(e=zc(6,e,null,t)).expirationTime=n,e}function Wc(e,t,n){return(t=zc(4,null!==e.children?e.children:[],e.key,t)).expirationTime=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Qc(e,t,n){this.tag=t,this.current=null,this.containerInfo=e,this.pingCache=this.pendingChildren=null,this.finishedExpirationTime=0,this.finishedWork=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=90,this.lastExpiredTime=this.lastPingedTime=this.nextKnownPendingLevel=this.lastSuspendedTime=this.firstSuspendedTime=this.firstPendingTime=0}function Yc(e,t){var n=e.firstSuspendedTime;return e=e.lastSuspendedTime,0!==n&&n>=t&&e<=t}function Gc(e,t){var n=e.firstSuspendedTime,r=e.lastSuspendedTime;n<t&&(e.firstSuspendedTime=t),(r>t||0===n)&&(e.lastSuspendedTime=t),t<=e.lastPingedTime&&(e.lastPingedTime=0),t<=e.lastExpiredTime&&(e.lastExpiredTime=0)}function Jc(e,t){t>e.firstPendingTime&&(e.firstPendingTime=t);var n=e.firstSuspendedTime;0!==n&&(t>=n?e.firstSuspendedTime=e.lastSuspendedTime=e.nextKnownPendingLevel=0:t>=e.lastSuspendedTime&&(e.lastSuspendedTime=t+1),t>e.nextKnownPendingLevel&&(e.nextKnownPendingLevel=t))}function Xc(e,t){var n=e.lastExpiredTime;(0===n||n>t)&&(e.lastExpiredTime=t)}function Zc(e,t,n,r){var i=t.current,o=lc(),a=bo.suspense;o=uc(o,i,a);e:if(n){t:{if(et(n=n._reactInternalFiber)!==n||1!==n.tag)throw Error(s(170));var c=n;do{switch(c.tag){case 3:c=c.stateNode.context;break t;case 1:if(_i(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break t}}c=c.return}while(null!==c);throw Error(s(171))}if(1===n.tag){var l=n.type;if(_i(l)){n=Ti(n,l,c);break e}}n=c}else n=mi;return null===t.context?t.context=n:t.pendingContext=n,(t=fo(o,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),go(i,t),dc(i,o),o}function el(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function tl(e,t){null!==(e=e.memoizedState)&&null!==e.dehydrated&&e.retryTime<t&&(e.retryTime=t)}function nl(e,t){tl(e,t),(e=e.alternate)&&tl(e,t)}function rl(e,t,n){var r=new Qc(e,t,n=null!=n&&!0===n.hydrate),i=zc(3,null,null,2===t?7:1===t?3:0);r.current=i,i.stateNode=r,ho(i),e[Pn]=r.current,n&&0!==t&&function(e,t){var n=Ze(t);At.forEach((function(e){gt(e,t,n)})),Et.forEach((function(e){gt(e,t,n)}))}(0,9===e.nodeType?e:e.ownerDocument),this._internalRoot=r}function il(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function ol(e,t,n,r,i){var o=n._reactRootContainer;if(o){var s=o._internalRoot;if("function"===typeof i){var a=i;i=function(){var e=el(s);a.call(e)}}Zc(t,s,e,i)}else{if(o=n._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new rl(e,0,t?{hydrate:!0}:void 0)}(n,r),s=o._internalRoot,"function"===typeof i){var c=i;i=function(){var e=el(s);c.call(e)}}vc((function(){Zc(t,s,e,i)}))}return el(s)}function sl(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!il(t))throw Error(s(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:te,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)}rl.prototype.render=function(e){Zc(e,this._internalRoot,null,null)},rl.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;Zc(null,e,null,(function(){t[Pn]=null}))},mt=function(e){if(13===e.tag){var t=Zi(lc(),150,100);dc(e,t),nl(e,t)}},yt=function(e){13===e.tag&&(dc(e,3),nl(e,3))},vt=function(e){if(13===e.tag){var t=lc();dc(e,t=uc(t,e,null)),nl(e,t)}},E=function(e,t,n){switch(t){case"input":if(Se(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Dn(r);if(!i)throw Error(s(90));_e(r),Se(r,i)}}}break;case"textarea":Pe(e,n);break;case"select":null!=(t=n.value)&&Me(e,!!n.multiple,t,!1)}},N=yc,B=function(e,t,n,r,i){var o=Ua;Ua|=4;try{return Qi(98,e.bind(null,t,n,r,i))}finally{(Ua=o)===Ma&&Ji()}},D=function(){(Ua&(1|Oa|Pa))===Ma&&(function(){if(null!==oc){var e=oc;oc=null,e.forEach((function(e,t){Xc(t,e),fc(t)})),Ji()}}(),Pc())},L=function(e,t){var n=Ua;Ua|=2;try{return e(t)}finally{(Ua=n)===Ma&&Ji()}};var al={Events:[Nn,Bn,Dn,k,I,$n,function(e){ot(e,Hn)},P,x,Xt,ct,Pc,{current:!1}]};!function(e){var t=e.findFiberByHostInstance;(function(e){if("undefined"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)return!0;try{var n=t.inject(e);Fc=function(e){try{t.onCommitFiberRoot(n,e,void 0,64===(64&e.current.effectTag))}catch(r){}},Uc=function(e){try{t.onCommitFiberUnmount(n,e)}catch(r){}}}catch(r){}})(i({},e,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:G.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=rt(e))?null:e.stateNode},findFiberByHostInstance:function(e){return t?t(e):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null}))}({findFiberByHostInstance:xn,bundleType:0,version:"16.14.0",rendererPackageName:"react-dom"}),t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=al,t.createPortal=sl,t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternalFiber;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw Error(s(268,Object.keys(e)))}return e=null===(e=rt(t))?null:e.stateNode},t.flushSync=function(e,t){if((Ua&(Oa|Pa))!==Ma)throw Error(s(187));var n=Ua;Ua|=1;try{return Qi(99,e.bind(null,t))}finally{Ua=n,Ji()}},t.hydrate=function(e,t,n){if(!il(t))throw Error(s(200));return ol(null,e,t,!0,n)},t.render=function(e,t,n){if(!il(t))throw Error(s(200));return ol(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!il(e))throw Error(s(40));return!!e._reactRootContainer&&(vc((function(){ol(null,null,e,!1,(function(){e._reactRootContainer=null,e[Pn]=null}))})),!0)},t.unstable_batchedUpdates=yc,t.unstable_createPortal=function(e,t){return sl(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!il(n))throw Error(s(200));if(null==e||void 0===e._reactInternalFiber)throw Error(s(38));return ol(e,t,n,!1,r)},t.version="16.14.0"},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)},82:(e,t)=>{var n="function"===typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,i=n?Symbol.for("react.portal"):60106,o=n?Symbol.for("react.fragment"):60107,s=n?Symbol.for("react.strict_mode"):60108,a=n?Symbol.for("react.profiler"):60114,c=n?Symbol.for("react.provider"):60109,l=n?Symbol.for("react.context"):60110,u=n?Symbol.for("react.async_mode"):60111,d=n?Symbol.for("react.concurrent_mode"):60111,h=n?Symbol.for("react.forward_ref"):60112,p=n?Symbol.for("react.suspense"):60113,f=n?Symbol.for("react.suspense_list"):60120,g=n?Symbol.for("react.memo"):60115,m=n?Symbol.for("react.lazy"):60116,y=n?Symbol.for("react.block"):60121,v=n?Symbol.for("react.fundamental"):60117,b=n?Symbol.for("react.responder"):60118,w=n?Symbol.for("react.scope"):60119;function _(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case u:case d:case o:case a:case s:case p:return e;default:switch(e=e&&e.$$typeof){case l:case h:case m:case g:case c:return e;default:return t}}case i:return t}}}function C(e){return _(e)===d}t.AsyncMode=u,t.ConcurrentMode=d,t.ContextConsumer=l,t.ContextProvider=c,t.Element=r,t.ForwardRef=h,t.Fragment=o,t.Lazy=m,t.Memo=g,t.Portal=i,t.Profiler=a,t.StrictMode=s,t.Suspense=p,t.isAsyncMode=function(e){return C(e)||_(e)===u},t.isConcurrentMode=C,t.isContextConsumer=function(e){return _(e)===l},t.isContextProvider=function(e){return _(e)===c},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return _(e)===h},t.isFragment=function(e){return _(e)===o},t.isLazy=function(e){return _(e)===m},t.isMemo=function(e){return _(e)===g},t.isPortal=function(e){return _(e)===i},t.isProfiler=function(e){return _(e)===a},t.isStrictMode=function(e){return _(e)===s},t.isSuspense=function(e){return _(e)===p},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===o||e===d||e===a||e===s||e===p||e===f||"object"===typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===g||e.$$typeof===c||e.$$typeof===l||e.$$typeof===h||e.$$typeof===v||e.$$typeof===b||e.$$typeof===w||e.$$typeof===y)},t.typeOf=_},86:(e,t,n)=>{e.exports=n(82)},153:(e,t,n)=>{var r=n(43),i=60103;if("function"===typeof Symbol&&Symbol.for){var o=Symbol.for;i=o("react.element"),o("react.fragment")}var s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a=Object.prototype.hasOwnProperty,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var r,o={},l=null,u=null;for(r in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,r)&&!c.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===o[r]&&(o[r]=t[r]);return{$$typeof:i,type:e,key:l,ref:u,props:o,_owner:s.current}}t.jsx=l},202:(e,t,n)=>{var r=n(123),i="function"===typeof Symbol&&Symbol.for,o=i?Symbol.for("react.element"):60103,s=i?Symbol.for("react.portal"):60106,a=i?Symbol.for("react.fragment"):60107,c=i?Symbol.for("react.strict_mode"):60108,l=i?Symbol.for("react.profiler"):60114,u=i?Symbol.for("react.provider"):60109,d=i?Symbol.for("react.context"):60110,h=i?Symbol.for("react.forward_ref"):60112,p=i?Symbol.for("react.suspense"):60113,f=i?Symbol.for("react.memo"):60115,g=i?Symbol.for("react.lazy"):60116,m="function"===typeof Symbol&&Symbol.iterator;function y(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b={};function w(e,t,n){this.props=e,this.context=t,this.refs=b,this.updater=n||v}function _(){}function C(e,t,n){this.props=e,this.context=t,this.refs=b,this.updater=n||v}w.prototype.isReactComponent={},w.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error(y(85));this.updater.enqueueSetState(this,e,t,"setState")},w.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},_.prototype=w.prototype;var I=C.prototype=new _;I.constructor=C,r(I,w.prototype),I.isPureReactComponent=!0;var T={current:null},S=Object.prototype.hasOwnProperty,k={key:!0,ref:!0,__self:!0,__source:!0};function A(e,t,n){var r,i={},s=null,a=null;if(null!=t)for(r in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(s=""+t.key),t)S.call(t,r)&&!k.hasOwnProperty(r)&&(i[r]=t[r]);var c=arguments.length-2;if(1===c)i.children=n;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}if(e&&e.defaultProps)for(r in c=e.defaultProps)void 0===i[r]&&(i[r]=c[r]);return{$$typeof:o,type:e,key:s,ref:a,props:i,_owner:T.current}}function E(e){return"object"===typeof e&&null!==e&&e.$$typeof===o}var M=/\/+/g,R=[];function O(e,t,n,r){if(R.length){var i=R.pop();return i.result=e,i.keyPrefix=t,i.func=n,i.context=r,i.count=0,i}return{result:e,keyPrefix:t,func:n,context:r,count:0}}function P(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>R.length&&R.push(e)}function x(e,t,n,r){var i=typeof e;"undefined"!==i&&"boolean"!==i||(e=null);var a=!1;if(null===e)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case o:case s:a=!0}}if(a)return n(r,e,""===t?"."+B(e,0):t),1;if(a=0,t=""===t?".":t+":",Array.isArray(e))for(var c=0;c<e.length;c++){var l=t+B(i=e[c],c);a+=x(i,l,n,r)}else if(null===e||"object"!==typeof e?l=null:l="function"===typeof(l=m&&e[m]||e["@@iterator"])?l:null,"function"===typeof l)for(e=l.call(e),c=0;!(i=e.next()).done;)a+=x(i=i.value,l=t+B(i,c++),n,r);else if("object"===i)throw n=""+e,Error(y(31,"[object Object]"===n?"object with keys {"+Object.keys(e).join(", ")+"}":n,""));return a}function N(e,t,n){return null==e?0:x(e,"",t,n)}function B(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,(function(e){return t[e]}))}(e.key):t.toString(36)}function D(e,t){e.func.call(e.context,t,e.count++)}function L(e,t,n){var r=e.result,i=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?F(e,r,n,(function(e){return e})):null!=e&&(E(e)&&(e=function(e,t){return{$$typeof:o,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(e,i+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(M,"$&/")+"/")+n)),r.push(e))}function F(e,t,n,r,i){var o="";null!=n&&(o=(""+n).replace(M,"$&/")+"/"),N(e,L,t=O(t,o,r,i)),P(t)}var U={current:null};function q(){var e=U.current;if(null===e)throw Error(y(321));return e}var z={ReactCurrentDispatcher:U,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:T,IsSomeRendererActing:{current:!1},assign:r};t.Children={map:function(e,t,n){if(null==e)return e;var r=[];return F(e,r,null,t,n),r},forEach:function(e,t,n){if(null==e)return e;N(e,D,t=O(null,null,t,n)),P(t)},count:function(e){return N(e,(function(){return null}),null)},toArray:function(e){var t=[];return F(e,t,null,(function(e){return e})),t},only:function(e){if(!E(e))throw Error(y(143));return e}},t.Component=w,t.Fragment=a,t.Profiler=l,t.PureComponent=C,t.StrictMode=c,t.Suspense=p,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=z,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error(y(267,e));var i=r({},e.props),s=e.key,a=e.ref,c=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,c=T.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)S.call(t,u)&&!k.hasOwnProperty(u)&&(i[u]=void 0===t[u]&&void 0!==l?l[u]:t[u])}var u=arguments.length-2;if(1===u)i.children=n;else if(1<u){l=Array(u);for(var d=0;d<u;d++)l[d]=arguments[d+2];i.children=l}return{$$typeof:o,type:e.type,key:s,ref:a,props:i,_owner:c}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:d,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:u,_context:e},e.Consumer=e},t.createElement=A,t.createFactory=function(e){var t=A.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:h,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:g,_ctor:e,_status:-1,_result:null}},t.memo=function(e,t){return{$$typeof:f,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return q().useCallback(e,t)},t.useContext=function(e,t){return q().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return q().useEffect(e,t)},t.useImperativeHandle=function(e,t,n){return q().useImperativeHandle(e,t,n)},t.useLayoutEffect=function(e,t){return q().useLayoutEffect(e,t)},t.useMemo=function(e,t){return q().useMemo(e,t)},t.useReducer=function(e,t,n){return q().useReducer(e,t,n)},t.useRef=function(e){return q().useRef(e)},t.useState=function(e){return q().useState(e)},t.version="16.14.0"},43:(e,t,n)=>{e.exports=n(202)},579:(e,t,n)=>{e.exports=n(153)},234:(e,t)=>{var n,r,i,o,s;if("undefined"===typeof window||"function"!==typeof MessageChannel){var a=null,c=null,l=function(){if(null!==a)try{var e=t.unstable_now();a(!0,e),a=null}catch(n){throw setTimeout(l,0),n}},u=Date.now();t.unstable_now=function(){return Date.now()-u},n=function(e){null!==a?setTimeout(n,0,e):(a=e,setTimeout(l,0))},r=function(e,t){c=setTimeout(e,t)},i=function(){clearTimeout(c)},o=function(){return!1},s=t.unstable_forceFrameRate=function(){}}else{var d=window.performance,h=window.Date,p=window.setTimeout,f=window.clearTimeout;if("undefined"!==typeof console){var g=window.cancelAnimationFrame;"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),"function"!==typeof g&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills")}if("object"===typeof d&&"function"===typeof d.now)t.unstable_now=function(){return d.now()};else{var m=h.now();t.unstable_now=function(){return h.now()-m}}var y=!1,v=null,b=-1,w=5,_=0;o=function(){return t.unstable_now()>=_},s=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):w=0<e?Math.floor(1e3/e):5};var C=new MessageChannel,I=C.port2;C.port1.onmessage=function(){if(null!==v){var e=t.unstable_now();_=e+w;try{v(!0,e)?I.postMessage(null):(y=!1,v=null)}catch(n){throw I.postMessage(null),n}}else y=!1},n=function(e){v=e,y||(y=!0,I.postMessage(null))},r=function(e,n){b=p((function(){e(t.unstable_now())}),n)},i=function(){f(b),b=-1}}function T(e,t){var n=e.length;e.push(t);e:for(;;){var r=n-1>>>1,i=e[r];if(!(void 0!==i&&0<A(i,t)))break e;e[r]=t,e[n]=i,n=r}}function S(e){return void 0===(e=e[0])?null:e}function k(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length;r<i;){var o=2*(r+1)-1,s=e[o],a=o+1,c=e[a];if(void 0!==s&&0>A(s,n))void 0!==c&&0>A(c,s)?(e[r]=c,e[a]=n,r=a):(e[r]=s,e[o]=n,r=o);else{if(!(void 0!==c&&0>A(c,n)))break e;e[r]=c,e[a]=n,r=a}}}return t}return null}function A(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var E=[],M=[],R=1,O=null,P=3,x=!1,N=!1,B=!1;function D(e){for(var t=S(M);null!==t;){if(null===t.callback)k(M);else{if(!(t.startTime<=e))break;k(M),t.sortIndex=t.expirationTime,T(E,t)}t=S(M)}}function L(e){if(B=!1,D(e),!N)if(null!==S(E))N=!0,n(F);else{var t=S(M);null!==t&&r(L,t.startTime-e)}}function F(e,n){N=!1,B&&(B=!1,i()),x=!0;var s=P;try{for(D(n),O=S(E);null!==O&&(!(O.expirationTime>n)||e&&!o());){var a=O.callback;if(null!==a){O.callback=null,P=O.priorityLevel;var c=a(O.expirationTime<=n);n=t.unstable_now(),"function"===typeof c?O.callback=c:O===S(E)&&k(E),D(n)}else k(E);O=S(E)}if(null!==O)var l=!0;else{var u=S(M);null!==u&&r(L,u.startTime-n),l=!1}return l}finally{O=null,P=s,x=!1}}function U(e){switch(e){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1e4;default:return 5e3}}var q=s;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){N||x||(N=!0,n(F))},t.unstable_getCurrentPriorityLevel=function(){return P},t.unstable_getFirstCallbackNode=function(){return S(E)},t.unstable_next=function(e){switch(P){case 1:case 2:case 3:var t=3;break;default:t=P}var n=P;P=t;try{return e()}finally{P=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=q,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=P;P=e;try{return t()}finally{P=n}},t.unstable_scheduleCallback=function(e,o,s){var a=t.unstable_now();if("object"===typeof s&&null!==s){var c=s.delay;c="number"===typeof c&&0<c?a+c:a,s="number"===typeof s.timeout?s.timeout:U(e)}else s=U(e),c=a;return e={id:R++,callback:o,priorityLevel:e,startTime:c,expirationTime:s=c+s,sortIndex:-1},c>a?(e.sortIndex=c,T(M,e),null===S(E)&&e===S(M)&&(B?i():B=!0,r(L,c-a))):(e.sortIndex=s,T(E,e),N||x||(N=!0,n(F))),e},t.unstable_shouldYield=function(){var e=t.unstable_now();D(e);var n=S(E);return n!==O&&null!==O&&null!==n&&null!==n.callback&&n.startTime<=e&&n.expirationTime<O.expirationTime||o()},t.unstable_wrapCallback=function(e){var t=P;return function(){var n=P;P=t;try{return e.apply(this,arguments)}finally{P=n}}}},853:(e,t,n)=>{e.exports=n(234)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var r,i,o,s,a,c,l,u,d,h=n(43),p=n(950),f=n(219),g=n.n(f);!function(e){e[e.V1=0]="V1",e[e.V2=1]="V2",e[e.V3=2]="V3",e[e.V4=3]="V4",e[e.V5=4]="V5"}(r||(r={})),function(e){e[e.Sparse=0]="Sparse",e[e.Dense=1]="Dense"}(i||(i={})),function(e){e[e.HALF=0]="HALF",e[e.SINGLE=1]="SINGLE",e[e.DOUBLE=2]="DOUBLE"}(o||(o={})),function(e){e[e.DAY=0]="DAY",e[e.MILLISECOND=1]="MILLISECOND"}(s||(s={})),function(e){e[e.SECOND=0]="SECOND",e[e.MILLISECOND=1]="MILLISECOND",e[e.MICROSECOND=2]="MICROSECOND",e[e.NANOSECOND=3]="NANOSECOND"}(a||(a={})),function(e){e[e.YEAR_MONTH=0]="YEAR_MONTH",e[e.DAY_TIME=1]="DAY_TIME",e[e.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"}(c||(c={})),function(e){e[e.NONE=0]="NONE",e[e.Schema=1]="Schema",e[e.DictionaryBatch=2]="DictionaryBatch",e[e.RecordBatch=3]="RecordBatch",e[e.Tensor=4]="Tensor",e[e.SparseTensor=5]="SparseTensor"}(l||(l={})),function(e){e[e.NONE=0]="NONE",e[e.Null=1]="Null",e[e.Int=2]="Int",e[e.Float=3]="Float",e[e.Binary=4]="Binary",e[e.Utf8=5]="Utf8",e[e.Bool=6]="Bool",e[e.Decimal=7]="Decimal",e[e.Date=8]="Date",e[e.Time=9]="Time",e[e.Timestamp=10]="Timestamp",e[e.Interval=11]="Interval",e[e.List=12]="List",e[e.Struct=13]="Struct",e[e.Union=14]="Union",e[e.FixedSizeBinary=15]="FixedSizeBinary",e[e.FixedSizeList=16]="FixedSizeList",e[e.Map=17]="Map",e[e.Dictionary=-1]="Dictionary",e[e.Int8=-2]="Int8",e[e.Int16=-3]="Int16",e[e.Int32=-4]="Int32",e[e.Int64=-5]="Int64",e[e.Uint8=-6]="Uint8",e[e.Uint16=-7]="Uint16",e[e.Uint32=-8]="Uint32",e[e.Uint64=-9]="Uint64",e[e.Float16=-10]="Float16",e[e.Float32=-11]="Float32",e[e.Float64=-12]="Float64",e[e.DateDay=-13]="DateDay",e[e.DateMillisecond=-14]="DateMillisecond",e[e.TimestampSecond=-15]="TimestampSecond",e[e.TimestampMillisecond=-16]="TimestampMillisecond",e[e.TimestampMicrosecond=-17]="TimestampMicrosecond",e[e.TimestampNanosecond=-18]="TimestampNanosecond",e[e.TimeSecond=-19]="TimeSecond",e[e.TimeMillisecond=-20]="TimeMillisecond",e[e.TimeMicrosecond=-21]="TimeMicrosecond",e[e.TimeNanosecond=-22]="TimeNanosecond",e[e.DenseUnion=-23]="DenseUnion",e[e.SparseUnion=-24]="SparseUnion",e[e.IntervalDayTime=-25]="IntervalDayTime",e[e.IntervalYearMonth=-26]="IntervalYearMonth"}(u||(u={})),function(e){e[e.OFFSET=0]="OFFSET",e[e.DATA=1]="DATA",e[e.VALIDITY=2]="VALIDITY",e[e.TYPE=3]="TYPE"}(d||(d={}));const[m,y]=(()=>{const e=()=>{throw new Error("BigInt is not available in this environment")};function t(){throw e()}return t.asIntN=()=>{throw e()},t.asUintN=()=>{throw e()},"undefined"!==typeof BigInt?[BigInt,!0]:[t,!1]})(),[v,b]=(()=>{const e=()=>{throw new Error("BigInt64Array is not available in this environment")};return"undefined"!==typeof BigInt64Array?[BigInt64Array,!0]:[class{static get BYTES_PER_ELEMENT(){return 8}static of(){throw e()}static from(){throw e()}constructor(){throw e()}},!1]})(),[w,_]=(()=>{const e=()=>{throw new Error("BigUint64Array is not available in this environment")};return"undefined"!==typeof BigUint64Array?[BigUint64Array,!0]:[class{static get BYTES_PER_ELEMENT(){return 8}static of(){throw e()}static from(){throw e()}constructor(){throw e()}},!1]})(),C=e=>"number"===typeof e,I=e=>"boolean"===typeof e,T=e=>"function"===typeof e,S=e=>null!=e&&Object(e)===e,k=e=>S(e)&&T(e.then),A=e=>S(e)&&T(e[Symbol.iterator]),E=e=>S(e)&&T(e[Symbol.asyncIterator]),M=e=>S(e)&&S(e.schema),R=e=>S(e)&&"done"in e&&"value"in e,O=e=>S(e)&&T(e.stat)&&C(e.fd),P=e=>S(e)&&N(e.body),x=e=>"_getDOMStream"in e&&"_getNodeStream"in e,N=e=>S(e)&&T(e.cancel)&&T(e.getReader)&&!x(e),B=e=>S(e)&&T(e.read)&&T(e.pipe)&&I(e.readable)&&!x(e);function D(e){if(null===e)return"null";if(undefined===e)return"undefined";switch(typeof e){case"number":case"bigint":return`${e}`;case"string":return`"${e}"`}return"function"===typeof e[Symbol.toPrimitive]?e[Symbol.toPrimitive]("string"):ArrayBuffer.isView(e)?e instanceof v||e instanceof w?`[${[...e].map((e=>D(e)))}]`:`[${e}]`:ArrayBuffer.isView(e)?`[${e}]`:JSON.stringify(e,((e,t)=>"bigint"===typeof t?`${t}`:t))}function L(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}Object.create;function F(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function U(e){return this instanceof U?(this.v=e,this):new U(e)}function q(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r=Object.create(("function"===typeof AsyncIterator?AsyncIterator:Object).prototype),s("next"),s("throw"),s("return",(function(e){return function(t){return Promise.resolve(t).then(e,l)}})),r[Symbol.asyncIterator]=function(){return this},r;function s(e,t){i[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||a(e,t)}))},t&&(r[e]=t(r[e])))}function a(e,t){try{(n=i[e](t)).value instanceof U?Promise.resolve(n.value.v).then(c,l):u(o[0][2],n)}catch(r){u(o[0][3],r)}var n}function c(e){a("next",e)}function l(e){a("throw",e)}function u(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}function z(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:U(e[r](t)),done:!1}:i?i(t):t}:i}}function H(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=F(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,i,(t=e[n](t)).done,t.value)}))}}}Object.create;"function"===typeof SuppressedError&&SuppressedError;const $=new TextDecoder("utf-8"),j=e=>$.decode(e),K=new TextEncoder,V=e=>K.encode(e),W="undefined"!==typeof SharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;function Q(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.byteLength;const i=e.byteLength,o=new Uint8Array(e.buffer,e.byteOffset,i),s=new Uint8Array(t.buffer,t.byteOffset,Math.min(r,i));return o.set(s,n),e}function Y(e,t){const n=function(e){const t=e[0]?[e[0]]:[];let n,r,i,o;for(let s,a,c=0,l=0,u=e.length;++c<u;)s=t[l],a=e[c],!s||!a||s.buffer!==a.buffer||a.byteOffset<s.byteOffset?a&&(t[++l]=a):(({byteOffset:n,byteLength:i}=s),({byteOffset:r,byteLength:o}=a),n+i<r||r+o<n?a&&(t[++l]=a):t[l]=new Uint8Array(s.buffer,n,r-n+o));return t}(e),r=n.reduce(((e,t)=>e+t.byteLength),0);let i,o,s,a=0,c=-1;const l=Math.min(t||Number.POSITIVE_INFINITY,r);for(const u=n.length;++c<u;){if(i=n[c],o=i.subarray(0,Math.min(i.length,l-a)),l<=a+o.length){o.length<i.length?n[c]=i.subarray(o.length):o.length===i.length&&c++,s?Q(s,o,a):s=o;break}Q(s||(s=new Uint8Array(l)),o,a),a+=o.length}return[s||new Uint8Array(0),n.slice(c),r-(s?s.byteLength:0)]}function G(e,t){let n=R(t)?t.value:t;return n instanceof e?e===Uint8Array?new e(n.buffer,n.byteOffset,n.byteLength):n:n?("string"===typeof n&&(n=V(n)),n instanceof ArrayBuffer||n instanceof W?new e(n):S(r=n)&&T(r.clear)&&T(r.bytes)&&T(r.position)&&T(r.setPosition)&&T(r.capacity)&&T(r.getBufferIdentifier)&&T(r.createLong)?G(e,n.bytes()):ArrayBuffer.isView(n)?n.byteLength<=0?new e(0):new e(n.buffer,n.byteOffset,n.byteLength/e.BYTES_PER_ELEMENT):e.from(n)):new e(0);var r}const J=e=>G(Int32Array,e),X=e=>G(Uint8Array,e),Z=e=>(e.next(),e);function*ee(e,t){const n=function*(e){yield e},r="string"===typeof t||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof W?n(t):A(t)?t:n(t);return yield*Z(function*(t){let n=null;do{n=t.next(yield G(e,n))}while(!n.done)}(r[Symbol.iterator]())),new e}function te(e,t){return q(this,arguments,(function*(){if(k(t))return yield U(yield U(yield*z(H(te(e,yield U(t))))));const n=function(e){return q(this,arguments,(function*(){yield yield U(yield U(e))}))},r="string"===typeof t||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof W?n(t):A(t)?function(e){return q(this,arguments,(function*(){yield U(yield*z(H(Z(function*(e){let t=null;do{t=e.next(yield null===t||void 0===t?void 0:t.value)}while(!t.done)}(e[Symbol.iterator]())))))}))}(t):E(t)?t:n(t);return yield U(yield*z(H(Z(function(t){return q(this,arguments,(function*(){let n=null;do{n=yield U(t.next(yield yield U(G(e,n))))}while(!n.done)}))}(r[Symbol.asyncIterator]()))))),yield U(new e)}))}function ne(e,t,n){if(0!==e){n=n.slice(0,t+1);for(let r=-1;++r<=t;)n[r]+=e}return n}const re=Symbol.for("isArrowBigNum");function ie(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return 0===n.length?Object.setPrototypeOf(G(this.TypedArray,e),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(e,...n),this.constructor.prototype)}function oe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return ie.apply(this,t)}function se(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return ie.apply(this,t)}function ae(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return ie.apply(this,t)}function ce(e){const{buffer:t,byteOffset:n,length:r,signed:i}=e,o=new w(t,n,r),s=i&&o[o.length-1]&BigInt(1)<<BigInt(63);let a=s?BigInt(1):BigInt(0),c=BigInt(0);if(s){for(const e of o)a+=~e*(BigInt(1)<<BigInt(32)*c++);a*=BigInt(-1)}else for(const l of o)a+=l*(BigInt(1)<<BigInt(32)*c++);return a}let le,ue;function de(e){let t="";const n=new Uint32Array(2);let r=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2);const i=new Uint32Array((r=new Uint16Array(r).reverse()).buffer);let o=-1;const s=r.length-1;do{for(n[0]=r[o=0];o<s;)r[o++]=n[1]=n[0]/10,n[0]=(n[0]-10*n[1]<<16)+r[o];r[o]=n[1]=n[0]/10,n[0]=n[0]-10*n[1],t=`${n[0]}${t}`}while(i[0]||i[1]||i[2]||i[3]);return null!==t&&void 0!==t?t:"0"}ie.prototype[re]=!0,ie.prototype.toJSON=function(){return`"${le(this)}"`},ie.prototype.valueOf=function(){return ce(this)},ie.prototype.toString=function(){return le(this)},ie.prototype[Symbol.toPrimitive]=function(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default"){case"number":return ce(this);case"string":return le(this);case"default":return ue(this)}return le(this)},Object.setPrototypeOf(oe.prototype,Object.create(Int32Array.prototype)),Object.setPrototypeOf(se.prototype,Object.create(Uint32Array.prototype)),Object.setPrototypeOf(ae.prototype,Object.create(Uint32Array.prototype)),Object.assign(oe.prototype,ie.prototype,{constructor:oe,signed:!0,TypedArray:Int32Array,BigIntArray:v}),Object.assign(se.prototype,ie.prototype,{constructor:se,signed:!1,TypedArray:Uint32Array,BigIntArray:w}),Object.assign(ae.prototype,ie.prototype,{constructor:ae,signed:!0,TypedArray:Uint32Array,BigIntArray:w}),y?(ue=e=>8===e.byteLength?new e.BigIntArray(e.buffer,e.byteOffset,1)[0]:de(e),le=e=>8===e.byteLength?`${new e.BigIntArray(e.buffer,e.byteOffset,1)[0]}`:de(e)):(le=de,ue=le);class he{static new(e,t){switch(t){case!0:return new oe(e);case!1:return new se(e)}switch(e.constructor){case Int8Array:case Int16Array:case Int32Array:case v:return new oe(e)}return 16===e.byteLength?new ae(e):new se(e)}static signed(e){return new oe(e)}static unsigned(e){return new se(e)}static decimal(e){return new ae(e)}constructor(e,t){return he.new(e,t)}}var pe,fe,ge,me,ye,ve,be,we,_e,Ce,Ie,Te,Se,ke,Ae,Ee,Me,Re,Oe,Pe;class xe{static isNull(e){return(null===e||void 0===e?void 0:e.typeId)===u.Null}static isInt(e){return(null===e||void 0===e?void 0:e.typeId)===u.Int}static isFloat(e){return(null===e||void 0===e?void 0:e.typeId)===u.Float}static isBinary(e){return(null===e||void 0===e?void 0:e.typeId)===u.Binary}static isUtf8(e){return(null===e||void 0===e?void 0:e.typeId)===u.Utf8}static isBool(e){return(null===e||void 0===e?void 0:e.typeId)===u.Bool}static isDecimal(e){return(null===e||void 0===e?void 0:e.typeId)===u.Decimal}static isDate(e){return(null===e||void 0===e?void 0:e.typeId)===u.Date}static isTime(e){return(null===e||void 0===e?void 0:e.typeId)===u.Time}static isTimestamp(e){return(null===e||void 0===e?void 0:e.typeId)===u.Timestamp}static isInterval(e){return(null===e||void 0===e?void 0:e.typeId)===u.Interval}static isList(e){return(null===e||void 0===e?void 0:e.typeId)===u.List}static isStruct(e){return(null===e||void 0===e?void 0:e.typeId)===u.Struct}static isUnion(e){return(null===e||void 0===e?void 0:e.typeId)===u.Union}static isFixedSizeBinary(e){return(null===e||void 0===e?void 0:e.typeId)===u.FixedSizeBinary}static isFixedSizeList(e){return(null===e||void 0===e?void 0:e.typeId)===u.FixedSizeList}static isMap(e){return(null===e||void 0===e?void 0:e.typeId)===u.Map}static isDictionary(e){return(null===e||void 0===e?void 0:e.typeId)===u.Dictionary}static isDenseUnion(e){return xe.isUnion(e)&&e.mode===i.Dense}static isSparseUnion(e){return xe.isUnion(e)&&e.mode===i.Sparse}get typeId(){return u.NONE}}pe=Symbol.toStringTag,xe[pe]=((Pe=xe.prototype).children=null,Pe.ArrayType=Array,Pe[Symbol.toStringTag]="DataType");class Ne extends xe{toString(){return"Null"}get typeId(){return u.Null}}fe=Symbol.toStringTag,Ne[fe]=(e=>e[Symbol.toStringTag]="Null")(Ne.prototype);class Be extends xe{constructor(e,t){super(),this.isSigned=e,this.bitWidth=t}get typeId(){return u.Int}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?v:w}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}ge=Symbol.toStringTag,Be[ge]=(e=>(e.isSigned=null,e.bitWidth=null,e[Symbol.toStringTag]="Int"))(Be.prototype);class De extends Be{constructor(){super(!0,32)}get ArrayType(){return Int32Array}}Object.defineProperty(class extends Be{constructor(){super(!0,8)}get ArrayType(){return Int8Array}}.prototype,"ArrayType",{value:Int8Array}),Object.defineProperty(class extends Be{constructor(){super(!0,16)}get ArrayType(){return Int16Array}}.prototype,"ArrayType",{value:Int16Array}),Object.defineProperty(De.prototype,"ArrayType",{value:Int32Array}),Object.defineProperty(class extends Be{constructor(){super(!0,64)}get ArrayType(){return v}}.prototype,"ArrayType",{value:v}),Object.defineProperty(class extends Be{constructor(){super(!1,8)}get ArrayType(){return Uint8Array}}.prototype,"ArrayType",{value:Uint8Array}),Object.defineProperty(class extends Be{constructor(){super(!1,16)}get ArrayType(){return Uint16Array}}.prototype,"ArrayType",{value:Uint16Array}),Object.defineProperty(class extends Be{constructor(){super(!1,32)}get ArrayType(){return Uint32Array}}.prototype,"ArrayType",{value:Uint32Array}),Object.defineProperty(class extends Be{constructor(){super(!1,64)}get ArrayType(){return w}}.prototype,"ArrayType",{value:w});class Le extends xe{constructor(e){super(),this.precision=e}get typeId(){return u.Float}get ArrayType(){switch(this.precision){case o.HALF:return Uint16Array;case o.SINGLE:return Float32Array;case o.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}}me=Symbol.toStringTag,Le[me]=(e=>(e.precision=null,e[Symbol.toStringTag]="Float"))(Le.prototype);Object.defineProperty(class extends Le{constructor(){super(o.HALF)}}.prototype,"ArrayType",{value:Uint16Array}),Object.defineProperty(class extends Le{constructor(){super(o.SINGLE)}}.prototype,"ArrayType",{value:Float32Array}),Object.defineProperty(class extends Le{constructor(){super(o.DOUBLE)}}.prototype,"ArrayType",{value:Float64Array});class Fe extends xe{constructor(){super()}get typeId(){return u.Binary}toString(){return"Binary"}}ye=Symbol.toStringTag,Fe[ye]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Binary"))(Fe.prototype);class Ue extends xe{constructor(){super()}get typeId(){return u.Utf8}toString(){return"Utf8"}}ve=Symbol.toStringTag,Ue[ve]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Utf8"))(Ue.prototype);class qe extends xe{constructor(){super()}get typeId(){return u.Bool}toString(){return"Bool"}}be=Symbol.toStringTag,qe[be]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Bool"))(qe.prototype);class ze extends xe{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:128;super(),this.scale=e,this.precision=t,this.bitWidth=n}get typeId(){return u.Decimal}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}}we=Symbol.toStringTag,ze[we]=(e=>(e.scale=null,e.precision=null,e.ArrayType=Uint32Array,e[Symbol.toStringTag]="Decimal"))(ze.prototype);class He extends xe{constructor(e){super(),this.unit=e}get typeId(){return u.Date}toString(){return`Date${32*(this.unit+1)}<${s[this.unit]}>`}}_e=Symbol.toStringTag,He[_e]=(e=>(e.unit=null,e.ArrayType=Int32Array,e[Symbol.toStringTag]="Date"))(He.prototype);class $e extends xe{constructor(e,t){super(),this.unit=e,this.bitWidth=t}get typeId(){return u.Time}toString(){return`Time${this.bitWidth}<${a[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return v}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}}Ce=Symbol.toStringTag,$e[Ce]=(e=>(e.unit=null,e.bitWidth=null,e[Symbol.toStringTag]="Time"))($e.prototype);class je extends xe{constructor(e,t){super(),this.unit=e,this.timezone=t}get typeId(){return u.Timestamp}toString(){return`Timestamp<${a[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}}Ie=Symbol.toStringTag,je[Ie]=(e=>(e.unit=null,e.timezone=null,e.ArrayType=Int32Array,e[Symbol.toStringTag]="Timestamp"))(je.prototype);class Ke extends xe{constructor(e){super(),this.unit=e}get typeId(){return u.Interval}toString(){return`Interval<${c[this.unit]}>`}}Te=Symbol.toStringTag,Ke[Te]=(e=>(e.unit=null,e.ArrayType=Int32Array,e[Symbol.toStringTag]="Interval"))(Ke.prototype);class Ve extends xe{constructor(e){super(),this.children=[e]}get typeId(){return u.List}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}}Se=Symbol.toStringTag,Ve[Se]=(e=>(e.children=null,e[Symbol.toStringTag]="List"))(Ve.prototype);class We extends xe{constructor(e){super(),this.children=e}get typeId(){return u.Struct}toString(){return`Struct<{${this.children.map((e=>`${e.name}:${e.type}`)).join(", ")}}>`}}ke=Symbol.toStringTag,We[ke]=(e=>(e.children=null,e[Symbol.toStringTag]="Struct"))(We.prototype);class Qe extends xe{constructor(e,t,n){super(),this.mode=e,this.children=n,this.typeIds=t=Int32Array.from(t),this.typeIdToChildIndex=t.reduce(((e,t,n)=>(e[t]=n)&&e||e),Object.create(null))}get typeId(){return u.Union}toString(){return`${this[Symbol.toStringTag]}<${this.children.map((e=>`${e.type}`)).join(" | ")}>`}}Ae=Symbol.toStringTag,Qe[Ae]=(e=>(e.mode=null,e.typeIds=null,e.children=null,e.typeIdToChildIndex=null,e.ArrayType=Int8Array,e[Symbol.toStringTag]="Union"))(Qe.prototype);class Ye extends xe{constructor(e){super(),this.byteWidth=e}get typeId(){return u.FixedSizeBinary}toString(){return`FixedSizeBinary[${this.byteWidth}]`}}Ee=Symbol.toStringTag,Ye[Ee]=(e=>(e.byteWidth=null,e.ArrayType=Uint8Array,e[Symbol.toStringTag]="FixedSizeBinary"))(Ye.prototype);class Ge extends xe{constructor(e,t){super(),this.listSize=e,this.children=[t]}get typeId(){return u.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}Me=Symbol.toStringTag,Ge[Me]=(e=>(e.children=null,e.listSize=null,e[Symbol.toStringTag]="FixedSizeList"))(Ge.prototype);class Je extends xe{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.children=[e],this.keysSorted=t}get typeId(){return u.Map}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map((e=>`${e.name}:${e.type}`)).join(", ")}}>`}}Re=Symbol.toStringTag,Je[Re]=(e=>(e.children=null,e.keysSorted=null,e[Symbol.toStringTag]="Map_"))(Je.prototype);const Xe=(Ze=-1,()=>++Ze);var Ze;class et extends xe{constructor(e,t,n,r){super(),this.indices=t,this.dictionary=e,this.isOrdered=r||!1,this.id=null==n?Xe():"number"===typeof n?n:n.low}get typeId(){return u.Dictionary}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}}function tt(e){const t=e;switch(e.typeId){case u.Decimal:return e.bitWidth/32;case u.Timestamp:return 2;case u.Date:case u.Interval:return 1+t.unit;case u.FixedSizeList:return t.listSize;case u.FixedSizeBinary:return t.byteWidth;default:return 1}}Oe=Symbol.toStringTag,et[Oe]=(e=>(e.id=null,e.indices=null,e.isOrdered=null,e.dictionary=null,e[Symbol.toStringTag]="Dictionary"))(et.prototype);class nt{visitMany(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.map(((e,t)=>this.visit(e,...n.map((e=>e[t])))))}visit(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.getVisitFn(t[0],!1).apply(this,t)}getVisitFn(e){return function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if("number"===typeof t)return rt(e,t,n);if("string"===typeof t&&t in u)return rt(e,u[t],n);if(t&&t instanceof xe)return rt(e,it(t),n);if((null===t||void 0===t?void 0:t.type)&&t.type instanceof xe)return rt(e,it(t.type),n);return rt(e,u.NONE,n)}(this,e,!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}getVisitFnByTypeId(e){return rt(this,e,!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}visitNull(e){return null}visitBool(e){return null}visitInt(e){return null}visitFloat(e){return null}visitUtf8(e){return null}visitBinary(e){return null}visitFixedSizeBinary(e){return null}visitDate(e){return null}visitTimestamp(e){return null}visitTime(e){return null}visitDecimal(e){return null}visitList(e){return null}visitStruct(e){return null}visitUnion(e){return null}visitDictionary(e){return null}visitInterval(e){return null}visitFixedSizeList(e){return null}visitMap(e){return null}}function rt(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=null;switch(t){case u.Null:r=e.visitNull;break;case u.Bool:r=e.visitBool;break;case u.Int:r=e.visitInt;break;case u.Int8:r=e.visitInt8||e.visitInt;break;case u.Int16:r=e.visitInt16||e.visitInt;break;case u.Int32:r=e.visitInt32||e.visitInt;break;case u.Int64:r=e.visitInt64||e.visitInt;break;case u.Uint8:r=e.visitUint8||e.visitInt;break;case u.Uint16:r=e.visitUint16||e.visitInt;break;case u.Uint32:r=e.visitUint32||e.visitInt;break;case u.Uint64:r=e.visitUint64||e.visitInt;break;case u.Float:r=e.visitFloat;break;case u.Float16:r=e.visitFloat16||e.visitFloat;break;case u.Float32:r=e.visitFloat32||e.visitFloat;break;case u.Float64:r=e.visitFloat64||e.visitFloat;break;case u.Utf8:r=e.visitUtf8;break;case u.Binary:r=e.visitBinary;break;case u.FixedSizeBinary:r=e.visitFixedSizeBinary;break;case u.Date:r=e.visitDate;break;case u.DateDay:r=e.visitDateDay||e.visitDate;break;case u.DateMillisecond:r=e.visitDateMillisecond||e.visitDate;break;case u.Timestamp:r=e.visitTimestamp;break;case u.TimestampSecond:r=e.visitTimestampSecond||e.visitTimestamp;break;case u.TimestampMillisecond:r=e.visitTimestampMillisecond||e.visitTimestamp;break;case u.TimestampMicrosecond:r=e.visitTimestampMicrosecond||e.visitTimestamp;break;case u.TimestampNanosecond:r=e.visitTimestampNanosecond||e.visitTimestamp;break;case u.Time:r=e.visitTime;break;case u.TimeSecond:r=e.visitTimeSecond||e.visitTime;break;case u.TimeMillisecond:r=e.visitTimeMillisecond||e.visitTime;break;case u.TimeMicrosecond:r=e.visitTimeMicrosecond||e.visitTime;break;case u.TimeNanosecond:r=e.visitTimeNanosecond||e.visitTime;break;case u.Decimal:r=e.visitDecimal;break;case u.List:r=e.visitList;break;case u.Struct:r=e.visitStruct;break;case u.Union:r=e.visitUnion;break;case u.DenseUnion:r=e.visitDenseUnion||e.visitUnion;break;case u.SparseUnion:r=e.visitSparseUnion||e.visitUnion;break;case u.Dictionary:r=e.visitDictionary;break;case u.Interval:r=e.visitInterval;break;case u.IntervalDayTime:r=e.visitIntervalDayTime||e.visitInterval;break;case u.IntervalYearMonth:r=e.visitIntervalYearMonth||e.visitInterval;break;case u.FixedSizeList:r=e.visitFixedSizeList;break;case u.Map:r=e.visitMap}if("function"===typeof r)return r;if(!n)return()=>null;throw new Error(`Unrecognized type '${u[t]}'`)}function it(e){switch(e.typeId){case u.Null:return u.Null;case u.Int:{const{bitWidth:t,isSigned:n}=e;switch(t){case 8:return n?u.Int8:u.Uint8;case 16:return n?u.Int16:u.Uint16;case 32:return n?u.Int32:u.Uint32;case 64:return n?u.Int64:u.Uint64}return u.Int}case u.Float:switch(e.precision){case o.HALF:return u.Float16;case o.SINGLE:return u.Float32;case o.DOUBLE:return u.Float64}return u.Float;case u.Binary:return u.Binary;case u.Utf8:return u.Utf8;case u.Bool:return u.Bool;case u.Decimal:return u.Decimal;case u.Time:switch(e.unit){case a.SECOND:return u.TimeSecond;case a.MILLISECOND:return u.TimeMillisecond;case a.MICROSECOND:return u.TimeMicrosecond;case a.NANOSECOND:return u.TimeNanosecond}return u.Time;case u.Timestamp:switch(e.unit){case a.SECOND:return u.TimestampSecond;case a.MILLISECOND:return u.TimestampMillisecond;case a.MICROSECOND:return u.TimestampMicrosecond;case a.NANOSECOND:return u.TimestampNanosecond}return u.Timestamp;case u.Date:switch(e.unit){case s.DAY:return u.DateDay;case s.MILLISECOND:return u.DateMillisecond}return u.Date;case u.Interval:switch(e.unit){case c.DAY_TIME:return u.IntervalDayTime;case c.YEAR_MONTH:return u.IntervalYearMonth}return u.Interval;case u.Map:return u.Map;case u.List:return u.List;case u.Struct:return u.Struct;case u.Union:switch(e.mode){case i.Dense:return u.DenseUnion;case i.Sparse:return u.SparseUnion}return u.Union;case u.FixedSizeBinary:return u.FixedSizeBinary;case u.FixedSizeList:return u.FixedSizeList;case u.Dictionary:return u.Dictionary}throw new Error(`Unrecognized type '${u[e.typeId]}'`)}nt.prototype.visitInt8=null,nt.prototype.visitInt16=null,nt.prototype.visitInt32=null,nt.prototype.visitInt64=null,nt.prototype.visitUint8=null,nt.prototype.visitUint16=null,nt.prototype.visitUint32=null,nt.prototype.visitUint64=null,nt.prototype.visitFloat16=null,nt.prototype.visitFloat32=null,nt.prototype.visitFloat64=null,nt.prototype.visitDateDay=null,nt.prototype.visitDateMillisecond=null,nt.prototype.visitTimestampSecond=null,nt.prototype.visitTimestampMillisecond=null,nt.prototype.visitTimestampMicrosecond=null,nt.prototype.visitTimestampNanosecond=null,nt.prototype.visitTimeSecond=null,nt.prototype.visitTimeMillisecond=null,nt.prototype.visitTimeMicrosecond=null,nt.prototype.visitTimeNanosecond=null,nt.prototype.visitDenseUnion=null,nt.prototype.visitSparseUnion=null,nt.prototype.visitIntervalDayTime=null,nt.prototype.visitIntervalYearMonth=null;const ot=new Float64Array(1),st=new Uint32Array(ot.buffer);function at(e){const t=(31744&e)>>10,n=(1023&e)/1024,r=Math.pow(-1,(32768&e)>>15);switch(t){case 31:return r*(n?Number.NaN:1/0);case 0:return r*(n?6103515625e-14*n:0)}return r*Math.pow(2,t-15)*(1+n)}class ct extends nt{}function lt(e){return(t,n,r)=>{if(t.setValid(n,null!=r))return e(t,n,r)}}const ut=(e,t,n)=>{e[t]=Math.trunc(n%4294967296),e[t+1]=Math.trunc(n/4294967296)},dt=(e,t,n,r)=>{if(n+1<t.length){const{[n]:i,[n+1]:o}=t;e.set(r.subarray(0,o-i),i)}},ht=(e,t,n)=>{let{values:r}=e;r[t]=n},pt=(e,t,n)=>{let{values:r}=e;r[t]=n},ft=(e,t,n)=>{let{values:r}=e;r[t]=function(e){if(e!==e)return 32256;ot[0]=e;const t=(2147483648&st[1])>>16&65535;let n=2146435072&st[1],r=0;return n>=1089470464?st[0]>0?n=31744:(n=(2080374784&n)>>16,r=(1048575&st[1])>>10):n<=1056964608?(r=1048576+(1048575&st[1]),r=1048576+(r<<(n>>20)-998)>>21,n=0):(n=n-1056964608>>10,r=512+(1048575&st[1])>>10),t|n|65535&r}(n)},gt=(e,t,n)=>{let{values:r}=e;((e,t,n)=>{e[t]=Math.trunc(n/864e5)})(r,t,n.valueOf())},mt=(e,t,n)=>{let{values:r}=e;ut(r,2*t,n.valueOf())},yt=(e,t,n)=>{let{values:r}=e;return ut(r,2*t,n/1e3)},vt=(e,t,n)=>{let{values:r}=e;return ut(r,2*t,n)},bt=(e,t,n)=>{let{values:r}=e;return((e,t,n)=>{e[t]=Math.trunc(1e3*n%4294967296),e[t+1]=Math.trunc(1e3*n/4294967296)})(r,2*t,n)},wt=(e,t,n)=>{let{values:r}=e;return((e,t,n)=>{e[t]=Math.trunc(1e6*n%4294967296),e[t+1]=Math.trunc(1e6*n/4294967296)})(r,2*t,n)},_t=(e,t,n)=>{let{values:r}=e;r[t]=n},Ct=(e,t,n)=>{let{values:r}=e;r[t]=n},It=(e,t,n)=>{let{values:r}=e;r[t]=n},Tt=(e,t,n)=>{let{values:r}=e;r[t]=n},St=(e,t,n)=>{const r=e.type.typeIdToChildIndex[e.typeIds[t]],i=e.children[r];Mt.visit(i,e.valueOffsets[t],n)},kt=(e,t,n)=>{const r=e.type.typeIdToChildIndex[e.typeIds[t]],i=e.children[r];Mt.visit(i,t,n)},At=(e,t,n)=>{let{values:r}=e;r.set(n.subarray(0,2),2*t)},Et=(e,t,n)=>{let{values:r}=e;r[t]=12*n[0]+n[1]%12};ct.prototype.visitBool=lt(((e,t,n)=>{let{offset:r,values:i}=e;const o=r+t;n?i[o>>3]|=1<<o%8:i[o>>3]&=~(1<<o%8)})),ct.prototype.visitInt=lt(ht),ct.prototype.visitInt8=lt(ht),ct.prototype.visitInt16=lt(ht),ct.prototype.visitInt32=lt(ht),ct.prototype.visitInt64=lt(ht),ct.prototype.visitUint8=lt(ht),ct.prototype.visitUint16=lt(ht),ct.prototype.visitUint32=lt(ht),ct.prototype.visitUint64=lt(ht),ct.prototype.visitFloat=lt(((e,t,n)=>{switch(e.type.precision){case o.HALF:return ft(e,t,n);case o.SINGLE:case o.DOUBLE:return pt(e,t,n)}})),ct.prototype.visitFloat16=lt(ft),ct.prototype.visitFloat32=lt(pt),ct.prototype.visitFloat64=lt(pt),ct.prototype.visitUtf8=lt(((e,t,n)=>{let{values:r,valueOffsets:i}=e;dt(r,i,t,V(n))})),ct.prototype.visitBinary=lt(((e,t,n)=>{let{values:r,valueOffsets:i}=e;return dt(r,i,t,n)})),ct.prototype.visitFixedSizeBinary=lt(((e,t,n)=>{let{stride:r,values:i}=e;i.set(n.subarray(0,r),r*t)})),ct.prototype.visitDate=lt(((e,t,n)=>{e.type.unit===s.DAY?gt(e,t,n):mt(e,t,n)})),ct.prototype.visitDateDay=lt(gt),ct.prototype.visitDateMillisecond=lt(mt),ct.prototype.visitTimestamp=lt(((e,t,n)=>{switch(e.type.unit){case a.SECOND:return yt(e,t,n);case a.MILLISECOND:return vt(e,t,n);case a.MICROSECOND:return bt(e,t,n);case a.NANOSECOND:return wt(e,t,n)}})),ct.prototype.visitTimestampSecond=lt(yt),ct.prototype.visitTimestampMillisecond=lt(vt),ct.prototype.visitTimestampMicrosecond=lt(bt),ct.prototype.visitTimestampNanosecond=lt(wt),ct.prototype.visitTime=lt(((e,t,n)=>{switch(e.type.unit){case a.SECOND:return _t(e,t,n);case a.MILLISECOND:return Ct(e,t,n);case a.MICROSECOND:return It(e,t,n);case a.NANOSECOND:return Tt(e,t,n)}})),ct.prototype.visitTimeSecond=lt(_t),ct.prototype.visitTimeMillisecond=lt(Ct),ct.prototype.visitTimeMicrosecond=lt(It),ct.prototype.visitTimeNanosecond=lt(Tt),ct.prototype.visitDecimal=lt(((e,t,n)=>{let{values:r,stride:i}=e;r.set(n.subarray(0,i),i*t)})),ct.prototype.visitList=lt(((e,t,n)=>{const r=e.children[0],i=e.valueOffsets,o=Mt.getVisitFn(r);if(Array.isArray(n))for(let s=-1,a=i[t],c=i[t+1];a<c;)o(r,a++,n[++s]);else for(let s=-1,a=i[t],c=i[t+1];a<c;)o(r,a++,n.get(++s))})),ct.prototype.visitStruct=lt(((e,t,n)=>{const r=e.type.children.map((e=>Mt.getVisitFn(e.type))),i=n instanceof Map?(o=t,s=n,(e,t,n,r)=>t&&e(t,o,s.get(n.name))):n instanceof Wn?((e,t)=>(n,r,i,o)=>r&&n(r,e,t.get(o)))(t,n):Array.isArray(n)?((e,t)=>(n,r,i,o)=>r&&n(r,e,t[o]))(t,n):((e,t)=>(n,r,i,o)=>r&&n(r,e,t[i.name]))(t,n);var o,s;e.type.children.forEach(((t,n)=>i(r[n],e.children[n],t,n)))})),ct.prototype.visitUnion=lt(((e,t,n)=>{e.type.mode===i.Dense?St(e,t,n):kt(e,t,n)})),ct.prototype.visitDenseUnion=lt(St),ct.prototype.visitSparseUnion=lt(kt),ct.prototype.visitDictionary=lt(((e,t,n)=>{var r;null===(r=e.dictionary)||void 0===r||r.set(e.values[t],n)})),ct.prototype.visitInterval=lt(((e,t,n)=>{e.type.unit===c.DAY_TIME?At(e,t,n):Et(e,t,n)})),ct.prototype.visitIntervalDayTime=lt(At),ct.prototype.visitIntervalYearMonth=lt(Et),ct.prototype.visitFixedSizeList=lt(((e,t,n)=>{const{stride:r}=e,i=e.children[0],o=Mt.getVisitFn(i);if(Array.isArray(n))for(let s=-1,a=t*r;++s<r;)o(i,a+s,n[s]);else for(let s=-1,a=t*r;++s<r;)o(i,a+s,n.get(s))})),ct.prototype.visitMap=lt(((e,t,n)=>{const r=e.children[0],{valueOffsets:i}=e,o=Mt.getVisitFn(r);let{[t]:s,[t+1]:a}=i;const c=n instanceof Map?n.entries():Object.entries(n);for(const l of c)if(o(r,s,l),++s>=a)break}));const Mt=new ct,Rt=Symbol.for("parent"),Ot=Symbol.for("rowIndex");class Pt{constructor(e,t){return this[Rt]=e,this[Ot]=t,new Proxy(this,new Nt)}toArray(){return Object.values(this.toJSON())}toJSON(){const e=this[Ot],t=this[Rt],n=t.type.children,r={};for(let i=-1,o=n.length;++i<o;)r[n[i].name]=nn.visit(t.children[i],e);return r}toString(){return`{${[...this].map((e=>{let[t,n]=e;return`${D(t)}: ${D(n)}`})).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new xt(this[Rt],this[Ot])}}class xt{constructor(e,t){this.childIndex=0,this.children=e.children,this.rowIndex=t,this.childFields=e.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){const e=this.childIndex;return e<this.numChildren?(this.childIndex=e+1,{done:!1,value:[this.childFields[e].name,nn.visit(this.children[e],this.rowIndex)]}):{done:!0,value:null}}}Object.defineProperties(Pt.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[Rt]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Ot]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});class Nt{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(e){return e[Rt].type.children.map((e=>e.name))}has(e,t){return-1!==e[Rt].type.children.findIndex((e=>e.name===t))}getOwnPropertyDescriptor(e,t){if(-1!==e[Rt].type.children.findIndex((e=>e.name===t)))return{writable:!0,enumerable:!0,configurable:!0}}get(e,t){if(Reflect.has(e,t))return e[t];const n=e[Rt].type.children.findIndex((e=>e.name===t));if(-1!==n){const r=nn.visit(e[Rt].children[n],e[Ot]);return Reflect.set(e,t,r),r}}set(e,t,n){const r=e[Rt].type.children.findIndex((e=>e.name===t));return-1!==r?(Mt.visit(e[Rt].children[r],e[Ot],n),Reflect.set(e,t,n)):!(!Reflect.has(e,t)&&"symbol"!==typeof t)&&Reflect.set(e,t,n)}}class Bt extends nt{}function Dt(e){return(t,n)=>t.getValid(n)?e(t,n):null}const Lt=(e,t)=>4294967296*e[t+1]+(e[t]>>>0),Ft=e=>new Date(e),Ut=(e,t,n)=>{if(n+1>=t.length)return null;const r=t[n],i=t[n+1];return e.subarray(r,i)},qt=(e,t)=>{let{values:n}=e;return((e,t)=>Ft(((e,t)=>864e5*e[t])(e,t)))(n,t)},zt=(e,t)=>{let{values:n}=e;return((e,t)=>Ft(Lt(e,t)))(n,2*t)},Ht=(e,t)=>{let{stride:n,values:r}=e;return r[n*t]},$t=(e,t)=>{let{values:n}=e;return n[t]},jt=(e,t)=>{let{values:n}=e;return 1e3*Lt(n,2*t)},Kt=(e,t)=>{let{values:n}=e;return Lt(n,2*t)},Vt=(e,t)=>{let{values:n}=e;return((e,t)=>e[t+1]/1e3*4294967296+(e[t]>>>0)/1e3)(n,2*t)},Wt=(e,t)=>{let{values:n}=e;return((e,t)=>e[t+1]/1e6*4294967296+(e[t]>>>0)/1e6)(n,2*t)},Qt=(e,t)=>{let{values:n}=e;return n[t]},Yt=(e,t)=>{let{values:n}=e;return n[t]},Gt=(e,t)=>{let{values:n}=e;return n[t]},Jt=(e,t)=>{let{values:n}=e;return n[t]},Xt=(e,t)=>{const n=e.type.typeIdToChildIndex[e.typeIds[t]],r=e.children[n];return nn.visit(r,e.valueOffsets[t])},Zt=(e,t)=>{const n=e.type.typeIdToChildIndex[e.typeIds[t]],r=e.children[n];return nn.visit(r,t)},en=(e,t)=>{let{values:n}=e;return n.subarray(2*t,2*(t+1))},tn=(e,t)=>{let{values:n}=e;const r=n[t],i=new Int32Array(2);return i[0]=Math.trunc(r/12),i[1]=Math.trunc(r%12),i};Bt.prototype.visitNull=Dt(((e,t)=>null)),Bt.prototype.visitBool=Dt(((e,t)=>{let{offset:n,values:r}=e;const i=n+t;return 0!==(r[i>>3]&1<<i%8)})),Bt.prototype.visitInt=Dt(((e,t)=>{let{values:n}=e;return n[t]})),Bt.prototype.visitInt8=Dt(Ht),Bt.prototype.visitInt16=Dt(Ht),Bt.prototype.visitInt32=Dt(Ht),Bt.prototype.visitInt64=Dt($t),Bt.prototype.visitUint8=Dt(Ht),Bt.prototype.visitUint16=Dt(Ht),Bt.prototype.visitUint32=Dt(Ht),Bt.prototype.visitUint64=Dt($t),Bt.prototype.visitFloat=Dt(((e,t)=>{let{type:n,values:r}=e;return n.precision!==o.HALF?r[t]:at(r[t])})),Bt.prototype.visitFloat16=Dt(((e,t)=>{let{stride:n,values:r}=e;return at(r[n*t])})),Bt.prototype.visitFloat32=Dt(Ht),Bt.prototype.visitFloat64=Dt(Ht),Bt.prototype.visitUtf8=Dt(((e,t)=>{let{values:n,valueOffsets:r}=e;const i=Ut(n,r,t);return null!==i?j(i):null})),Bt.prototype.visitBinary=Dt(((e,t)=>{let{values:n,valueOffsets:r}=e;return Ut(n,r,t)})),Bt.prototype.visitFixedSizeBinary=Dt(((e,t)=>{let{stride:n,values:r}=e;return r.subarray(n*t,n*(t+1))})),Bt.prototype.visitDate=Dt(((e,t)=>e.type.unit===s.DAY?qt(e,t):zt(e,t))),Bt.prototype.visitDateDay=Dt(qt),Bt.prototype.visitDateMillisecond=Dt(zt),Bt.prototype.visitTimestamp=Dt(((e,t)=>{switch(e.type.unit){case a.SECOND:return jt(e,t);case a.MILLISECOND:return Kt(e,t);case a.MICROSECOND:return Vt(e,t);case a.NANOSECOND:return Wt(e,t)}})),Bt.prototype.visitTimestampSecond=Dt(jt),Bt.prototype.visitTimestampMillisecond=Dt(Kt),Bt.prototype.visitTimestampMicrosecond=Dt(Vt),Bt.prototype.visitTimestampNanosecond=Dt(Wt),Bt.prototype.visitTime=Dt(((e,t)=>{switch(e.type.unit){case a.SECOND:return Qt(e,t);case a.MILLISECOND:return Yt(e,t);case a.MICROSECOND:return Gt(e,t);case a.NANOSECOND:return Jt(e,t)}})),Bt.prototype.visitTimeSecond=Dt(Qt),Bt.prototype.visitTimeMillisecond=Dt(Yt),Bt.prototype.visitTimeMicrosecond=Dt(Gt),Bt.prototype.visitTimeNanosecond=Dt(Jt),Bt.prototype.visitDecimal=Dt(((e,t)=>{let{values:n,stride:r}=e;return he.decimal(n.subarray(r*t,r*(t+1)))})),Bt.prototype.visitList=Dt(((e,t)=>{const{valueOffsets:n,stride:r,children:i}=e,{[t*r]:o,[t*r+1]:s}=n,a=i[0].slice(o,s-o);return new Wn([a])})),Bt.prototype.visitStruct=Dt(((e,t)=>new Pt(e,t))),Bt.prototype.visitUnion=Dt(((e,t)=>e.type.mode===i.Dense?Xt(e,t):Zt(e,t))),Bt.prototype.visitDenseUnion=Dt(Xt),Bt.prototype.visitSparseUnion=Dt(Zt),Bt.prototype.visitDictionary=Dt(((e,t)=>{var n;return null===(n=e.dictionary)||void 0===n?void 0:n.get(e.values[t])})),Bt.prototype.visitInterval=Dt(((e,t)=>e.type.unit===c.DAY_TIME?en(e,t):tn(e,t))),Bt.prototype.visitIntervalDayTime=Dt(en),Bt.prototype.visitIntervalYearMonth=Dt(tn),Bt.prototype.visitFixedSizeList=Dt(((e,t)=>{const{stride:n,children:r}=e,i=r[0].slice(t*n,n);return new Wn([i])})),Bt.prototype.visitMap=Dt(((e,t)=>{const{valueOffsets:n,children:r}=e,{[t]:i,[t+1]:o}=n,s=r[0];return new sn(s.slice(i,o-i))}));const nn=new Bt,rn=Symbol.for("keys"),on=Symbol.for("vals");class sn{constructor(e){return this[rn]=new Wn([e.children[0]]).memoize(),this[on]=e.children[1],new Proxy(this,new cn)}[Symbol.iterator](){return new an(this[rn],this[on])}get size(){return this[rn].length}toArray(){return Object.values(this.toJSON())}toJSON(){const e=this[rn],t=this[on],n={};for(let r=-1,i=e.length;++r<i;)n[e.get(r)]=nn.visit(t,r);return n}toString(){return`{${[...this].map((e=>{let[t,n]=e;return`${D(t)}: ${D(n)}`})).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}}class an{constructor(e,t){this.keys=e,this.vals=t,this.keyIndex=0,this.numKeys=e.length}[Symbol.iterator](){return this}next(){const e=this.keyIndex;return e===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get(e),nn.visit(this.vals,e)]})}}class cn{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(e){return e[rn].toArray().map(String)}has(e,t){return e[rn].includes(t)}getOwnPropertyDescriptor(e,t){if(-1!==e[rn].indexOf(t))return{writable:!0,enumerable:!0,configurable:!0}}get(e,t){if(Reflect.has(e,t))return e[t];const n=e[rn].indexOf(t);if(-1!==n){const r=nn.visit(Reflect.get(e,on),n);return Reflect.set(e,t,r),r}}set(e,t,n){const r=e[rn].indexOf(t);return-1!==r?(Mt.visit(Reflect.get(e,on),r,n),Reflect.set(e,t,n)):!!Reflect.has(e,t)&&Reflect.set(e,t,n)}}let ln;function un(e,t,n,r){const{length:i=0}=e;let o="number"!==typeof t?0:t,s="number"!==typeof n?i:n;return o<0&&(o=(o%i+i)%i),s<0&&(s=(s%i+i)%i),s<o&&(ln=o,o=s,s=ln),s>i&&(s=i),r?r(e,o,s):[o,s]}Object.defineProperties(sn.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[rn]:{writable:!0,enumerable:!1,configurable:!1,value:null},[on]:{writable:!0,enumerable:!1,configurable:!1,value:null}});const dn=e=>e!==e;function hn(e){if("object"!==typeof e||null===e)return dn(e)?dn:t=>t===e;if(e instanceof Date){const t=e.valueOf();return e=>e instanceof Date&&e.valueOf()===t}return ArrayBuffer.isView(e)?t=>!!t&&function(e,t){let n=0;const r=e.length;if(r!==t.length)return!1;if(r>0)do{if(e[n]!==t[n])return!1}while(++n<r);return!0}(e,t):e instanceof Map?function(e){let t=-1;const n=[];for(const r of e.values())n[++t]=hn(r);return pn(n)}(e):Array.isArray(e)?function(e){const t=[];for(let n=-1,r=e.length;++n<r;)t[n]=hn(e[n]);return pn(t)}(e):e instanceof Wn?function(e){const t=[];for(let n=-1,r=e.length;++n<r;)t[n]=hn(e.get(n));return pn(t)}(e):function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=Object.keys(e);if(!t&&0===n.length)return()=>!1;const r=[];for(let i=-1,o=n.length;++i<o;)r[i]=hn(e[n[i]]);return pn(r,n)}(e,!0)}function pn(e,t){return n=>{if(!n||"object"!==typeof n)return!1;switch(n.constructor){case Array:return function(e,t){const n=e.length;if(t.length!==n)return!1;for(let r=-1;++r<n;)if(!e[r](t[r]))return!1;return!0}(e,n);case Map:return fn(e,n,n.keys());case sn:case Pt:case Object:case void 0:return fn(e,n,t||Object.keys(n))}return n instanceof Wn&&function(e,t){const n=e.length;if(t.length!==n)return!1;for(let r=-1;++r<n;)if(!e[r](t.get(r)))return!1;return!0}(e,n)}}function fn(e,t,n){const r=n[Symbol.iterator](),i=t instanceof Map?t.keys():Object.keys(t)[Symbol.iterator](),o=t instanceof Map?t.values():Object.values(t)[Symbol.iterator]();let s=0;const a=e.length;let c=o.next(),l=r.next(),u=i.next();for(;s<a&&!l.done&&!u.done&&!c.done&&(l.value===u.value&&e[s](c.value));++s,l=r.next(),u=i.next(),c=o.next());return!!(s===a&&l.done&&u.done&&c.done)||(r.return&&r.return(),i.return&&i.return(),o.return&&o.return(),!1)}class gn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;this.numChunks=e,this.getChunkIterator=t,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){const e=this.chunkIterator.next();if(!e.done)return e;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}}function mn(e){return e.reduce(((e,t)=>e+t.nullCount),0)}function yn(e){return e.reduce(((e,t,n)=>(e[n+1]=e[n]+t.length,e)),new Uint32Array(e.length+1))}function vn(e,t,n,r){const i=[];for(let o=-1,s=e.length;++o<s;){const s=e[o],a=t[o],{length:c}=s;if(a>=r)break;if(n>=a+c)continue;if(a>=n&&a+c<=r){i.push(s);continue}const l=Math.max(0,n-a),u=Math.min(r-a,c);i.push(s.slice(l,u-l))}return 0===i.length&&i.push(e[0].slice(0,0)),i}function bn(e,t,n,r){let i=0,o=0,s=t.length-1;do{if(i>=s-1)return n<t[s]?r(e,i,n-t[i]):null;o=i+Math.trunc(.5*(s-i)),n<t[o]?s=o:i=o}while(i<s)}function wn(e,t){return e.getValid(t)}function _n(e){function t(t,n,r){return e(t[n],r)}return function(e){return bn(this.data,this._offsets,e,t)}}function Cn(e){let t;function n(n,r,i){return e(n[r],i,t)}return function(e,r){const i=this.data;t=r;const o=bn(i,this._offsets,e,n);return t=void 0,o}}function In(e){let t;function n(n,r,i){let o=i,s=0,a=0;for(let c=r-1,l=n.length;++c<l;){const r=n[c];if(~(s=e(r,t,o)))return a+s;o=0,a+=r.length}return-1}return function(e,r){t=e;const i=this.data,o="number"!==typeof r?n(i,0,0):bn(i,this._offsets,r,n);return t=void 0,o}}function Tn(e,t,n,r){return 0!==(n&1<<r)}function Sn(e,t,n,r){return(n&1<<r)>>r}function kn(e,t,n){const r=n.byteLength+7&-8;if(e>0||n.byteLength<r){const i=new Uint8Array(r);return i.set(e%8===0?n.subarray(e>>3):An(new En(n,e,t,null,Tn)).subarray(0,r)),i}return n}function An(e){const t=[];let n=0,r=0,i=0;for(const s of e)s&&(i|=1<<r),8===++r&&(t[n++]=i,i=r=0);(0===n||r>0)&&(t[n++]=i);const o=new Uint8Array(t.length+7&-8);return o.set(t),o}class En{constructor(e,t,n,r,i){this.bytes=e,this.length=n,this.context=r,this.get=i,this.bit=t%8,this.byteIndex=t>>3,this.byte=e[this.byteIndex++],this.index=0}next(){return this.index<this.length?(8===this.bit&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}}function Mn(e,t,n){if(n-t<=0)return 0;if(n-t<8){let r=0;for(const i of new En(e,t,n-t,e,Sn))r+=i;return r}const r=n>>3<<3,i=t+(t%8===0?0:8-t%8);return Mn(e,t,i)+Mn(e,r,n)+function(e,t,n){let r=0,i=Math.trunc(t);const o=new DataView(e.buffer,e.byteOffset,e.byteLength),s=void 0===n?e.byteLength:i+n;for(;s-i>=4;)r+=Rn(o.getUint32(i)),i+=4;for(;s-i>=2;)r+=Rn(o.getUint16(i)),i+=2;for(;s-i>=1;)r+=Rn(o.getUint8(i)),i+=1;return r}(e,i>>3,r-i>>3)}function Rn(e){let t=Math.trunc(e);return t-=t>>>1&1431655765,t=(858993459&t)+(t>>>2&858993459),16843009*(t+(t>>>4)&252645135)>>>24}class On extends nt{}function Pn(e,t,n){if(void 0===t)return-1;if(null===t)return function(e,t){const{nullBitmap:n}=e;if(!n||e.nullCount<=0)return-1;let r=0;for(const i of new En(n,e.offset+(t||0),e.length,n,Tn)){if(!i)return r;++r}return-1}(e,n);const r=nn.getVisitFn(e),i=hn(t);for(let o=(n||0)-1,s=e.length;++o<s;)if(i(r(e,o)))return o;return-1}function xn(e,t,n){const r=nn.getVisitFn(e),i=hn(t);for(let o=(n||0)-1,s=e.length;++o<s;)if(i(r(e,o)))return o;return-1}On.prototype.visitNull=function(e,t){return null===t&&e.length>0?0:-1},On.prototype.visitBool=Pn,On.prototype.visitInt=Pn,On.prototype.visitInt8=Pn,On.prototype.visitInt16=Pn,On.prototype.visitInt32=Pn,On.prototype.visitInt64=Pn,On.prototype.visitUint8=Pn,On.prototype.visitUint16=Pn,On.prototype.visitUint32=Pn,On.prototype.visitUint64=Pn,On.prototype.visitFloat=Pn,On.prototype.visitFloat16=Pn,On.prototype.visitFloat32=Pn,On.prototype.visitFloat64=Pn,On.prototype.visitUtf8=Pn,On.prototype.visitBinary=Pn,On.prototype.visitFixedSizeBinary=Pn,On.prototype.visitDate=Pn,On.prototype.visitDateDay=Pn,On.prototype.visitDateMillisecond=Pn,On.prototype.visitTimestamp=Pn,On.prototype.visitTimestampSecond=Pn,On.prototype.visitTimestampMillisecond=Pn,On.prototype.visitTimestampMicrosecond=Pn,On.prototype.visitTimestampNanosecond=Pn,On.prototype.visitTime=Pn,On.prototype.visitTimeSecond=Pn,On.prototype.visitTimeMillisecond=Pn,On.prototype.visitTimeMicrosecond=Pn,On.prototype.visitTimeNanosecond=Pn,On.prototype.visitDecimal=Pn,On.prototype.visitList=Pn,On.prototype.visitStruct=Pn,On.prototype.visitUnion=Pn,On.prototype.visitDenseUnion=xn,On.prototype.visitSparseUnion=xn,On.prototype.visitDictionary=Pn,On.prototype.visitInterval=Pn,On.prototype.visitIntervalDayTime=Pn,On.prototype.visitIntervalYearMonth=Pn,On.prototype.visitFixedSizeList=Pn,On.prototype.visitMap=Pn;const Nn=new On;class Bn extends nt{}function Dn(e){const{type:t}=e;if(0===e.nullCount&&1===e.stride&&(t.typeId===u.Timestamp||t instanceof Be&&64!==t.bitWidth||t instanceof $e&&64!==t.bitWidth||t instanceof Le&&t.precision!==o.HALF))return new gn(e.data.length,(t=>{const n=e.data[t];return n.values.subarray(0,n.length)[Symbol.iterator]()}));let n=0;return new gn(e.data.length,(t=>{const r=e.data[t].length,i=e.slice(n,n+r);return n+=r,new Ln(i)}))}class Ln{constructor(e){this.vector=e,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}}Bn.prototype.visitNull=Dn,Bn.prototype.visitBool=Dn,Bn.prototype.visitInt=Dn,Bn.prototype.visitInt8=Dn,Bn.prototype.visitInt16=Dn,Bn.prototype.visitInt32=Dn,Bn.prototype.visitInt64=Dn,Bn.prototype.visitUint8=Dn,Bn.prototype.visitUint16=Dn,Bn.prototype.visitUint32=Dn,Bn.prototype.visitUint64=Dn,Bn.prototype.visitFloat=Dn,Bn.prototype.visitFloat16=Dn,Bn.prototype.visitFloat32=Dn,Bn.prototype.visitFloat64=Dn,Bn.prototype.visitUtf8=Dn,Bn.prototype.visitBinary=Dn,Bn.prototype.visitFixedSizeBinary=Dn,Bn.prototype.visitDate=Dn,Bn.prototype.visitDateDay=Dn,Bn.prototype.visitDateMillisecond=Dn,Bn.prototype.visitTimestamp=Dn,Bn.prototype.visitTimestampSecond=Dn,Bn.prototype.visitTimestampMillisecond=Dn,Bn.prototype.visitTimestampMicrosecond=Dn,Bn.prototype.visitTimestampNanosecond=Dn,Bn.prototype.visitTime=Dn,Bn.prototype.visitTimeSecond=Dn,Bn.prototype.visitTimeMillisecond=Dn,Bn.prototype.visitTimeMicrosecond=Dn,Bn.prototype.visitTimeNanosecond=Dn,Bn.prototype.visitDecimal=Dn,Bn.prototype.visitList=Dn,Bn.prototype.visitStruct=Dn,Bn.prototype.visitUnion=Dn,Bn.prototype.visitDenseUnion=Dn,Bn.prototype.visitSparseUnion=Dn,Bn.prototype.visitDictionary=Dn,Bn.prototype.visitInterval=Dn,Bn.prototype.visitIntervalDayTime=Dn,Bn.prototype.visitIntervalYearMonth=Dn,Bn.prototype.visitFixedSizeList=Dn,Bn.prototype.visitMap=Dn;const Fn=new Bn,Un=(e,t)=>e+t;class qn extends nt{visitNull(e,t){return 0}visitInt(e,t){return e.type.bitWidth/8}visitFloat(e,t){return e.type.ArrayType.BYTES_PER_ELEMENT}visitBool(e,t){return 1/8}visitDecimal(e,t){return e.type.bitWidth/8}visitDate(e,t){return 4*(e.type.unit+1)}visitTime(e,t){return e.type.bitWidth/8}visitTimestamp(e,t){return e.type.unit===a.SECOND?4:8}visitInterval(e,t){return 4*(e.type.unit+1)}visitStruct(e,t){return e.children.reduce(((e,n)=>e+$n.visit(n,t)),0)}visitFixedSizeBinary(e,t){return e.type.byteWidth}visitMap(e,t){return 8+e.children.reduce(((e,n)=>e+$n.visit(n,t)),0)}visitDictionary(e,t){var n;return e.type.indices.bitWidth/8+((null===(n=e.dictionary)||void 0===n?void 0:n.getByteLength(e.values[t]))||0)}}const zn=(e,t)=>{let{type:n,children:r,typeIds:i,valueOffsets:o}=e;const s=n.typeIdToChildIndex[i[t]];return 8+$n.visit(r[s],o[t])},Hn=(e,t)=>{let{children:n}=e;return 4+$n.visitMany(n,n.map((()=>t))).reduce(Un,0)};qn.prototype.visitUtf8=(e,t)=>{let{valueOffsets:n}=e;return n[t+1]-n[t]+8},qn.prototype.visitBinary=(e,t)=>{let{valueOffsets:n}=e;return n[t+1]-n[t]+8},qn.prototype.visitList=(e,t)=>{let{valueOffsets:n,stride:r,children:i}=e;const o=i[0],{[t*r]:s}=n,{[t*r+1]:a}=n,c=$n.getVisitFn(o.type),l=o.slice(s,a-s);let u=8;for(let d=-1,h=a-s;++d<h;)u+=c(l,d);return u},qn.prototype.visitFixedSizeList=(e,t)=>{let{stride:n,children:r}=e;const i=r[0],o=i.slice(t*n,n),s=$n.getVisitFn(i.type);let a=0;for(let c=-1,l=o.length;++c<l;)a+=s(o,c);return a},qn.prototype.visitUnion=(e,t)=>e.type.mode===i.Dense?zn(e,t):Hn(e,t),qn.prototype.visitDenseUnion=zn,qn.prototype.visitSparseUnion=Hn;const $n=new qn;var jn;const Kn={},Vn={};class Wn{constructor(e){var t,n,r;const i=e[0]instanceof Wn?e.flatMap((e=>e.data)):e;if(0===i.length||i.some((e=>!(e instanceof Yn))))throw new TypeError("Vector constructor expects an Array of Data instances.");const o=null===(t=i[0])||void 0===t?void 0:t.type;switch(i.length){case 0:this._offsets=[0];break;case 1:{const{get:e,set:t,indexOf:n,byteLength:r}=Kn[o.typeId],s=i[0];this.isValid=e=>wn(s,e),this.get=t=>e(s,t),this.set=(e,n)=>t(s,e,n),this.indexOf=e=>n(s,e),this.getByteLength=e=>r(s,e),this._offsets=[0,s.length];break}default:Object.setPrototypeOf(this,Vn[o.typeId]),this._offsets=yn(i)}this.data=i,this.type=o,this.stride=tt(o),this.numChildren=null!==(r=null===(n=o.children)||void 0===n?void 0:n.length)&&void 0!==r?r:0,this.length=this._offsets[this._offsets.length-1]}get byteLength(){return-1===this._byteLength&&(this._byteLength=this.data.reduce(((e,t)=>e+t.byteLength),0)),this._byteLength}get nullCount(){return-1===this._nullCount&&(this._nullCount=mn(this.data)),this._nullCount}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${u[this.type.typeId]}Vector`}isValid(e){return!1}get(e){return null}set(e,t){}indexOf(e,t){return-1}includes(e,t){return this.indexOf(e,t)>0}getByteLength(e){return 0}[Symbol.iterator](){return Fn.visit(this)}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Wn(this.data.concat(t.flatMap((e=>e.data)).flat(Number.POSITIVE_INFINITY)))}slice(e,t){return new Wn(un(this,e,t,((e,t,n)=>{let{data:r,_offsets:i}=e;return vn(r,i,t,n)})))}toJSON(){return[...this]}toArray(){const{type:e,data:t,length:n,stride:r,ArrayType:i}=this;switch(e.typeId){case u.Int:case u.Float:case u.Decimal:case u.Time:case u.Timestamp:switch(t.length){case 0:return new i;case 1:return t[0].values.subarray(0,n*r);default:return t.reduce(((e,t)=>{let{values:n,length:i}=t;return e.array.set(n.subarray(0,i*r),e.offset),e.offset+=i*r,e}),{array:new i(n*r),offset:0}).array}}return[...this]}toString(){return`[${[...this].join(",")}]`}getChild(e){var t;return this.getChildAt(null===(t=this.type.children)||void 0===t?void 0:t.findIndex((t=>t.name===e)))}getChildAt(e){return e>-1&&e<this.numChildren?new Wn(this.data.map((t=>{let{children:n}=t;return n[e]}))):null}get isMemoized(){return!!xe.isDictionary(this.type)&&this.data[0].dictionary.isMemoized}memoize(){if(xe.isDictionary(this.type)){const e=new Qn(this.data[0].dictionary),t=this.data.map((t=>{const n=t.clone();return n.dictionary=e,n}));return new Wn(t)}return new Qn(this)}unmemoize(){if(xe.isDictionary(this.type)&&this.isMemoized){const e=this.data[0].dictionary.unmemoize(),t=this.data.map((t=>{const n=t.clone();return n.dictionary=e,n}));return new Wn(t)}return this}}jn=Symbol.toStringTag,Wn[jn]=(e=>{e.type=xe.prototype,e.data=[],e.length=0,e.stride=1,e.numChildren=0,e._nullCount=-1,e._byteLength=-1,e._offsets=new Uint32Array([0]),e[Symbol.isConcatSpreadable]=!0;const t=Object.keys(u).map((e=>u[e])).filter((e=>"number"===typeof e&&e!==u.NONE));for(const n of t){const t=nn.getVisitFnByTypeId(n),r=Mt.getVisitFnByTypeId(n),i=Nn.getVisitFnByTypeId(n),o=$n.getVisitFnByTypeId(n);Kn[n]={get:t,set:r,indexOf:i,byteLength:o},Vn[n]=Object.create(e,{isValid:{value:_n(wn)},get:{value:_n(nn.getVisitFnByTypeId(n))},set:{value:Cn(Mt.getVisitFnByTypeId(n))},indexOf:{value:In(Nn.getVisitFnByTypeId(n))},getByteLength:{value:_n($n.getVisitFnByTypeId(n))}})}return"Vector"})(Wn.prototype);class Qn extends Wn{constructor(e){super(e.data);const t=this.get,n=this.set,r=this.slice,i=new Array(this.length);Object.defineProperty(this,"get",{value(e){const n=i[e];if(void 0!==n)return n;const r=t.call(this,e);return i[e]=r,r}}),Object.defineProperty(this,"set",{value(e,t){n.call(this,e,t),i[e]=t}}),Object.defineProperty(this,"slice",{value:(e,t)=>new Qn(r.call(this,e,t))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new Wn(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}}class Yn{constructor(e,t,n,r,i){let o,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],a=arguments.length>6?arguments[6]:void 0;this.type=e,this.children=s,this.dictionary=a,this.offset=Math.floor(Math.max(t||0,0)),this.length=Math.floor(Math.max(n||0,0)),this._nullCount=Math.floor(Math.max(r||0,-1)),i instanceof Yn?(this.stride=i.stride,this.values=i.values,this.typeIds=i.typeIds,this.nullBitmap=i.nullBitmap,this.valueOffsets=i.valueOffsets):(this.stride=tt(e),i&&((o=i[0])&&(this.valueOffsets=o),(o=i[1])&&(this.values=o),(o=i[2])&&(this.nullBitmap=o),(o=i[3])&&(this.typeIds=o))),this.nullable=0!==this._nullCount&&this.nullBitmap&&this.nullBitmap.byteLength>0}get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get byteLength(){let e=0;const{valueOffsets:t,values:n,nullBitmap:r,typeIds:i}=this;return t&&(e+=t.byteLength),n&&(e+=n.byteLength),r&&(e+=r.byteLength),i&&(e+=i.byteLength),this.children.reduce(((e,t)=>e+t.byteLength),e)}get nullCount(){let e,t=this._nullCount;return t<=-1&&(e=this.nullBitmap)&&(this._nullCount=t=this.length-Mn(e,this.offset,this.offset+this.length)),t}getValid(e){if(this.nullable&&this.nullCount>0){const t=this.offset+e;return 0!==(this.nullBitmap[t>>3]&1<<t%8)}return!0}setValid(e,t){if(!this.nullable)return t;if(!this.nullBitmap||this.nullBitmap.byteLength<=e>>3){const{nullBitmap:e}=this._changeLengthAndBackfillNullBitmap(this.length);Object.assign(this,{nullBitmap:e,_nullCount:0})}const{nullBitmap:n,offset:r}=this,i=r+e>>3,o=(r+e)%8,s=n[i]>>o&1;return t?0===s&&(n[i]|=1<<o,this._nullCount=this.nullCount+1):1===s&&(n[i]&=~(1<<o),this._nullCount=this.nullCount-1),t}clone(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.type,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.offset,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.length,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._nullCount,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.children;return new Yn(e,t,n,r,i,o,this.dictionary)}slice(e,t){const{stride:n,typeId:r,children:i}=this,o=+(0===this._nullCount)-1,s=16===r?n:1,a=this._sliceBuffers(e,t,n,r);return this.clone(this.type,this.offset+e,t,o,a,0===i.length||this.valueOffsets?i:this._sliceChildren(i,s*e,s*t))}_changeLengthAndBackfillNullBitmap(e){if(this.typeId===u.Null)return this.clone(this.type,0,e,0);const{length:t,nullCount:n}=this,r=new Uint8Array((e+63&-64)>>3).fill(255,0,t>>3);r[t>>3]=(1<<t-(-8&t))-1,n>0&&r.set(kn(this.offset,t,this.nullBitmap),0);const i=this.buffers;return i[d.VALIDITY]=r,this.clone(this.type,0,e,n+(e-t),i)}_sliceBuffers(e,t,n,r){let i;const{buffers:o}=this;return(i=o[d.TYPE])&&(o[d.TYPE]=i.subarray(e,e+t)),(i=o[d.OFFSET])&&(o[d.OFFSET]=i.subarray(e,e+t+1))||(i=o[d.DATA])&&(o[d.DATA]=6===r?i:i.subarray(n*e,n*(e+t))),o}_sliceChildren(e,t,n){return e.map((e=>e.slice(t,n)))}}Yn.prototype.children=Object.freeze([]);class Gn extends nt{visit(e){return this.getVisitFn(e.type).call(this,e)}visitNull(e){const{type:t,offset:n=0,length:r=0}=e;return new Yn(t,n,r,0)}visitBool(e){const{type:t,offset:n=0}=e,r=X(e.nullBitmap),i=G(t.ArrayType,e.data),{length:o=i.length>>3,nullCount:s=(e.nullBitmap?-1:0)}=e;return new Yn(t,n,o,s,[void 0,i,r])}visitInt(e){const{type:t,offset:n=0}=e,r=X(e.nullBitmap),i=G(t.ArrayType,e.data),{length:o=i.length,nullCount:s=(e.nullBitmap?-1:0)}=e;return new Yn(t,n,o,s,[void 0,i,r])}visitFloat(e){const{type:t,offset:n=0}=e,r=X(e.nullBitmap),i=G(t.ArrayType,e.data),{length:o=i.length,nullCount:s=(e.nullBitmap?-1:0)}=e;return new Yn(t,n,o,s,[void 0,i,r])}visitUtf8(e){const{type:t,offset:n=0}=e,r=X(e.data),i=X(e.nullBitmap),o=J(e.valueOffsets),{length:s=o.length-1,nullCount:a=(e.nullBitmap?-1:0)}=e;return new Yn(t,n,s,a,[o,r,i])}visitBinary(e){const{type:t,offset:n=0}=e,r=X(e.data),i=X(e.nullBitmap),o=J(e.valueOffsets),{length:s=o.length-1,nullCount:a=(e.nullBitmap?-1:0)}=e;return new Yn(t,n,s,a,[o,r,i])}visitFixedSizeBinary(e){const{type:t,offset:n=0}=e,r=X(e.nullBitmap),i=G(t.ArrayType,e.data),{length:o=i.length/tt(t),nullCount:s=(e.nullBitmap?-1:0)}=e;return new Yn(t,n,o,s,[void 0,i,r])}visitDate(e){const{type:t,offset:n=0}=e,r=X(e.nullBitmap),i=G(t.ArrayType,e.data),{length:o=i.length/tt(t),nullCount:s=(e.nullBitmap?-1:0)}=e;return new Yn(t,n,o,s,[void 0,i,r])}visitTimestamp(e){const{type:t,offset:n=0}=e,r=X(e.nullBitmap),i=G(t.ArrayType,e.data),{length:o=i.length/tt(t),nullCount:s=(e.nullBitmap?-1:0)}=e;return new Yn(t,n,o,s,[void 0,i,r])}visitTime(e){const{type:t,offset:n=0}=e,r=X(e.nullBitmap),i=G(t.ArrayType,e.data),{length:o=i.length/tt(t),nullCount:s=(e.nullBitmap?-1:0)}=e;return new Yn(t,n,o,s,[void 0,i,r])}visitDecimal(e){const{type:t,offset:n=0}=e,r=X(e.nullBitmap),i=G(t.ArrayType,e.data),{length:o=i.length/tt(t),nullCount:s=(e.nullBitmap?-1:0)}=e;return new Yn(t,n,o,s,[void 0,i,r])}visitList(e){const{type:t,offset:n=0,child:r}=e,i=X(e.nullBitmap),o=J(e.valueOffsets),{length:s=o.length-1,nullCount:a=(e.nullBitmap?-1:0)}=e;return new Yn(t,n,s,a,[o,void 0,i],[r])}visitStruct(e){const{type:t,offset:n=0,children:r=[]}=e,i=X(e.nullBitmap),{length:o=r.reduce(((e,t)=>{let{length:n}=t;return Math.max(e,n)}),0),nullCount:s=(e.nullBitmap?-1:0)}=e;return new Yn(t,n,o,s,[void 0,void 0,i],r)}visitUnion(e){const{type:t,offset:n=0,children:r=[]}=e,i=X(e.nullBitmap),o=G(t.ArrayType,e.typeIds),{length:s=o.length,nullCount:a=(e.nullBitmap?-1:0)}=e;if(xe.isSparseUnion(t))return new Yn(t,n,s,a,[void 0,void 0,i,o],r);const c=J(e.valueOffsets);return new Yn(t,n,s,a,[c,void 0,i,o],r)}visitDictionary(e){const{type:t,offset:n=0}=e,r=X(e.nullBitmap),i=G(t.indices.ArrayType,e.data),{dictionary:o=new Wn([(new Gn).visit({type:t.dictionary})])}=e,{length:s=i.length,nullCount:a=(e.nullBitmap?-1:0)}=e;return new Yn(t,n,s,a,[void 0,i,r],[],o)}visitInterval(e){const{type:t,offset:n=0}=e,r=X(e.nullBitmap),i=G(t.ArrayType,e.data),{length:o=i.length/tt(t),nullCount:s=(e.nullBitmap?-1:0)}=e;return new Yn(t,n,o,s,[void 0,i,r])}visitFixedSizeList(e){const{type:t,offset:n=0,child:r=(new Gn).visit({type:t.valueType})}=e,i=X(e.nullBitmap),{length:o=r.length/tt(t),nullCount:s=(e.nullBitmap?-1:0)}=e;return new Yn(t,n,o,s,[void 0,void 0,i],[r])}visitMap(e){const{type:t,offset:n=0,child:r=(new Gn).visit({type:t.childType})}=e,i=X(e.nullBitmap),o=J(e.valueOffsets),{length:s=o.length-1,nullCount:a=(e.nullBitmap?-1:0)}=e;return new Yn(t,n,s,a,[o,void 0,i],[r])}}function Jn(e){return(new Gn).visit(e)}class Xn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;this.fields=e||[],this.metadata=t||new Map,n||(n=tr(e)),this.dictionaries=n}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map((e=>e.name))}toString(){return`Schema<{ ${this.fields.map(((e,t)=>`${t}: ${e}`)).join(", ")} }>`}select(e){const t=new Set(e),n=this.fields.filter((e=>t.has(e.name)));return new Xn(n,this.metadata)}selectAt(e){const t=e.map((e=>this.fields[e])).filter(Boolean);return new Xn(t,this.metadata)}assign(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=t[0]instanceof Xn?t[0]:Array.isArray(t[0])?new Xn(t[0]):new Xn(t),i=[...this.fields],o=er(er(new Map,this.metadata),r.metadata),s=r.fields.filter((e=>{const t=i.findIndex((t=>t.name===e.name));return!~t||(i[t]=e.clone({metadata:er(er(new Map,i[t].metadata),e.metadata)}))&&!1})),a=tr(s,new Map);return new Xn([...i,...s],o,new Map([...this.dictionaries,...a]))}}Xn.prototype.fields=null,Xn.prototype.metadata=null,Xn.prototype.dictionaries=null;class Zn{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0;this.name=e,this.type=t,this.nullable=n,this.metadata=r||new Map}static new(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];let[r,i,o,s]=t;return t[0]&&"object"===typeof t[0]&&(({name:r}=t[0]),void 0===i&&(i=t[0].type),void 0===o&&(o=t[0].nullable),void 0===s&&(s=t[0].metadata)),new Zn(`${r}`,i,o,s)}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];let[r,i,o,s]=t;return t[0]&&"object"===typeof t[0]?({name:r=this.name,type:i=this.type,nullable:o=this.nullable,metadata:s=this.metadata}=t[0]):[r=this.name,i=this.type,o=this.nullable,s=this.metadata]=t,Zn.new(r,i,o,s)}}function er(e,t){return new Map([...e||new Map,...t||new Map])}function tr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map;for(let n=-1,r=e.length;++n<r;){const r=e[n].type;if(xe.isDictionary(r))if(t.has(r.id)){if(t.get(r.id)!==r.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}else t.set(r.id,r.dictionary);r.children&&r.children.length>0&&tr(r.children,t)}return t}Zn.prototype.type=null,Zn.prototype.name=null,Zn.prototype.nullable=null,Zn.prototype.metadata=null;class nr extends nt{compareSchemas(e,t){return e===t||t instanceof e.constructor&&this.compareManyFields(e.fields,t.fields)}compareManyFields(e,t){return e===t||Array.isArray(e)&&Array.isArray(t)&&e.length===t.length&&e.every(((e,n)=>this.compareFields(e,t[n])))}compareFields(e,t){return e===t||t instanceof e.constructor&&e.name===t.name&&e.nullable===t.nullable&&this.visit(e.type,t.type)}}function rr(e,t){return t instanceof e.constructor}function ir(e,t){return e===t||rr(e,t)}function or(e,t){return e===t||rr(e,t)&&e.bitWidth===t.bitWidth&&e.isSigned===t.isSigned}function sr(e,t){return e===t||rr(e,t)&&e.precision===t.precision}function ar(e,t){return e===t||rr(e,t)&&e.unit===t.unit}function cr(e,t){return e===t||rr(e,t)&&e.unit===t.unit&&e.timezone===t.timezone}function lr(e,t){return e===t||rr(e,t)&&e.unit===t.unit&&e.bitWidth===t.bitWidth}function ur(e,t){return e===t||rr(e,t)&&e.mode===t.mode&&e.typeIds.every(((e,n)=>e===t.typeIds[n]))&&hr.compareManyFields(e.children,t.children)}function dr(e,t){return e===t||rr(e,t)&&e.unit===t.unit}nr.prototype.visitNull=ir,nr.prototype.visitBool=ir,nr.prototype.visitInt=or,nr.prototype.visitInt8=or,nr.prototype.visitInt16=or,nr.prototype.visitInt32=or,nr.prototype.visitInt64=or,nr.prototype.visitUint8=or,nr.prototype.visitUint16=or,nr.prototype.visitUint32=or,nr.prototype.visitUint64=or,nr.prototype.visitFloat=sr,nr.prototype.visitFloat16=sr,nr.prototype.visitFloat32=sr,nr.prototype.visitFloat64=sr,nr.prototype.visitUtf8=ir,nr.prototype.visitBinary=ir,nr.prototype.visitFixedSizeBinary=function(e,t){return e===t||rr(e,t)&&e.byteWidth===t.byteWidth},nr.prototype.visitDate=ar,nr.prototype.visitDateDay=ar,nr.prototype.visitDateMillisecond=ar,nr.prototype.visitTimestamp=cr,nr.prototype.visitTimestampSecond=cr,nr.prototype.visitTimestampMillisecond=cr,nr.prototype.visitTimestampMicrosecond=cr,nr.prototype.visitTimestampNanosecond=cr,nr.prototype.visitTime=lr,nr.prototype.visitTimeSecond=lr,nr.prototype.visitTimeMillisecond=lr,nr.prototype.visitTimeMicrosecond=lr,nr.prototype.visitTimeNanosecond=lr,nr.prototype.visitDecimal=ir,nr.prototype.visitList=function(e,t){return e===t||rr(e,t)&&e.children.length===t.children.length&&hr.compareManyFields(e.children,t.children)},nr.prototype.visitStruct=function(e,t){return e===t||rr(e,t)&&e.children.length===t.children.length&&hr.compareManyFields(e.children,t.children)},nr.prototype.visitUnion=ur,nr.prototype.visitDenseUnion=ur,nr.prototype.visitSparseUnion=ur,nr.prototype.visitDictionary=function(e,t){return e===t||rr(e,t)&&e.id===t.id&&e.isOrdered===t.isOrdered&&hr.visit(e.indices,t.indices)&&hr.visit(e.dictionary,t.dictionary)},nr.prototype.visitInterval=dr,nr.prototype.visitIntervalDayTime=dr,nr.prototype.visitIntervalYearMonth=dr,nr.prototype.visitFixedSizeList=function(e,t){return e===t||rr(e,t)&&e.listSize===t.listSize&&e.children.length===t.children.length&&hr.compareManyFields(e.children,t.children)},nr.prototype.visitMap=function(e,t){return e===t||rr(e,t)&&e.keysSorted===t.keysSorted&&e.children.length===t.children.length&&hr.compareManyFields(e.children,t.children)};const hr=new nr;function pr(e,t){return hr.compareSchemas(e,t)}var fr,gr;class mr{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];switch(t.length){case 2:if([this.schema]=t,!(this.schema instanceof Xn))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=Jn({nullCount:0,type:new We(this.schema.fields),children:this.schema.fields.map((e=>Jn({type:e.type,nullCount:0})))})]=t,!(this.data instanceof Yn))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=yr(this.schema,this.data.children);break;case 1:{const[e]=t,{fields:n,children:r,length:i}=Object.keys(e).reduce(((t,n,r)=>(t.children[r]=e[n],t.length=Math.max(t.length,e[n].length),t.fields[r]=Zn.new({name:n,type:e[n].type,nullable:!0}),t)),{length:0,fields:new Array,children:new Array}),o=new Xn(n),s=Jn({type:new We(n),length:i,children:r,nullCount:0});[this.schema,this.data]=yr(o,s.children,i);break}default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=vr(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(e){return this.data.getValid(e)}get(e){return nn.visit(this.data,e)}set(e,t){return Mt.visit(this.data,e,t)}indexOf(e,t){return Nn.visit(this.data,e,t)}getByteLength(e){return $n.visit(this.data,e)}[Symbol.iterator](){return Fn.visit(new Wn([this.data]))}toArray(){return[...this]}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Cr(this.schema,[this,...t])}slice(e,t){const[n]=new Wn([this.data]).slice(e,t).data;return new mr(this.schema,n)}getChild(e){var t;return this.getChildAt(null===(t=this.schema.fields)||void 0===t?void 0:t.findIndex((t=>t.name===e)))}getChildAt(e){return e>-1&&e<this.schema.fields.length?new Wn([this.data.children[e]]):null}setChild(e,t){var n;return this.setChildAt(null===(n=this.schema.fields)||void 0===n?void 0:n.findIndex((t=>t.name===e)),t)}setChildAt(e,t){let n=this.schema,r=this.data;if(e>-1&&e<this.numCols){t||(t=new Wn([Jn({type:new Ne,length:this.numRows})]));const i=n.fields.slice(),o=r.children.slice(),s=i[e].clone({type:t.type});[i[e],o[e]]=[s,t.data[0]],n=new Xn(i,new Map(this.schema.metadata)),r=Jn({type:new We(i),children:o})}return new mr(n,r)}select(e){const t=this.schema.select(e),n=new We(t.fields),r=[];for(const i of e){const e=this.schema.fields.findIndex((e=>e.name===i));~e&&(r[e]=this.data.children[e])}return new mr(t,Jn({type:n,length:this.numRows,children:r}))}selectAt(e){const t=this.schema.selectAt(e),n=e.map((e=>this.data.children[e])).filter(Boolean),r=Jn({type:new We(t.fields),length:this.numRows,children:n});return new mr(t,r)}}function yr(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.reduce(((e,t)=>Math.max(e,t.length)),0);var r;const i=[...e.fields],o=[...t],s=(n+63&-64)>>3;for(const[a,c]of e.fields.entries()){const e=t[a];e&&e.length===n||(i[a]=c.clone({nullable:!0}),o[a]=null!==(r=null===e||void 0===e?void 0:e._changeLengthAndBackfillNullBitmap(n))&&void 0!==r?r:Jn({type:c.type,length:n,nullCount:n,nullBitmap:new Uint8Array(s)}))}return[e.assign(i),Jn({type:new We(i),length:n,children:o})]}function vr(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map;for(let r=-1,i=e.length;++r<i;){const i=e[r].type,o=t[r];if(xe.isDictionary(i))if(n.has(i.id)){if(n.get(i.id)!==o.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}else o.dictionary&&n.set(i.id,o.dictionary);i.children&&i.children.length>0&&vr(i.children,o.children,n)}return n}fr=Symbol.toStringTag,mr[fr]=(e=>(e._nullCount=-1,e[Symbol.isConcatSpreadable]=!0,"RecordBatch"))(mr.prototype);class br extends mr{constructor(e){const t=e.fields.map((e=>Jn({type:e.type})));super(e,Jn({type:new We(e.fields),nullCount:0,children:t}))}}function wr(e,t){return function(e,t){const n=[...e.fields],r=[],i={numBatches:t.reduce(((e,t)=>Math.max(e,t.length)),0)};let o=0,s=0,a=-1;const c=t.length;let l,u=[];for(;i.numBatches-- >0;){for(s=Number.POSITIVE_INFINITY,a=-1;++a<c;)u[a]=l=t[a].shift(),s=Math.min(s,l?l.length:s);Number.isFinite(s)&&(u=_r(n,s,u,t,i),s>0&&(r[o++]=Jn({type:new We(n),length:s,nullCount:0,children:u.slice()})))}return[e=e.assign(n),r.map((t=>new mr(e,t)))]}(e,t.map((e=>e.data.concat())))}function _r(e,t,n,r,i){var o;const s=(t+63&-64)>>3;for(let a=-1,c=r.length;++a<c;){const c=n[a],l=null===c||void 0===c?void 0:c.length;if(l>=t)l===t?n[a]=c:(n[a]=c.slice(0,t),i.numBatches=Math.max(i.numBatches,r[a].unshift(c.slice(t,l-t))));else{const r=e[a];e[a]=r.clone({nullable:!0}),n[a]=null!==(o=null===c||void 0===c?void 0:c._changeLengthAndBackfillNullBitmap(t))&&void 0!==o?o:Jn({type:r.type,length:t,nullCount:t,nullBitmap:new Uint8Array(s)})}}return n}class Cr{constructor(){for(var e,t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];if(0===r.length)return this.batches=[],this.schema=new Xn([]),this._offsets=[0],this;let o,s;r[0]instanceof Xn&&(o=r.shift()),r[r.length-1]instanceof Uint32Array&&(s=r.pop());const a=e=>{if(e){if(e instanceof mr)return[e];if(e instanceof Cr)return e.batches;if(e instanceof Yn){if(e.type instanceof We)return[new mr(new Xn(e.type.children),e)]}else{if(Array.isArray(e))return e.flatMap((e=>a(e)));if("function"===typeof e[Symbol.iterator])return[...e].flatMap((e=>a(e)));if("object"===typeof e){const t=Object.keys(e),n=t.map((t=>new Wn([e[t]]))),r=new Xn(t.map(((e,t)=>new Zn(String(e),n[t].type)))),[,i]=wr(r,n);return 0===i.length?[new mr(e)]:i}}}return[]},c=r.flatMap((e=>a(e)));if(o=null!==(t=null!==o&&void 0!==o?o:null===(e=c[0])||void 0===e?void 0:e.schema)&&void 0!==t?t:new Xn([]),!(o instanceof Xn))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(const l of c){if(!(l instanceof mr))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!pr(o,l.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=o,this.batches=c,this._offsets=null!==s&&void 0!==s?s:yn(this.data)}get data(){return this.batches.map((e=>{let{data:t}=e;return t}))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce(((e,t)=>e+t.length),0)}get nullCount(){return-1===this._nullCount&&(this._nullCount=mn(this.data)),this._nullCount}isValid(e){return!1}get(e){return null}set(e,t){}indexOf(e,t){return-1}getByteLength(e){return 0}[Symbol.iterator](){return this.batches.length>0?Fn.visit(new Wn(this.data)):new Array(0)[Symbol.iterator]()}toArray(){return[...this]}toString(){return`[\n  ${this.toArray().join(",\n  ")}\n]`}concat(){const e=this.schema;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];const i=this.data.concat(n.flatMap((e=>{let{data:t}=e;return t})));return new Cr(e,i.map((t=>new mr(e,t))))}slice(e,t){const n=this.schema;[e,t]=un({length:this.numRows},e,t);const r=vn(this.data,this._offsets,e,t);return new Cr(n,r.map((e=>new mr(n,e))))}getChild(e){return this.getChildAt(this.schema.fields.findIndex((t=>t.name===e)))}getChildAt(e){if(e>-1&&e<this.schema.fields.length){const t=this.data.map((t=>t.children[e]));if(0===t.length){const{type:n}=this.schema.fields[e],r=Jn({type:n,length:0,nullCount:0});t.push(r._changeLengthAndBackfillNullBitmap(this.numRows))}return new Wn(t)}return null}setChild(e,t){var n;return this.setChildAt(null===(n=this.schema.fields)||void 0===n?void 0:n.findIndex((t=>t.name===e)),t)}setChildAt(e,t){let n=this.schema,r=[...this.batches];if(e>-1&&e<this.numCols){t||(t=new Wn([Jn({type:new Ne,length:this.numRows})]));const i=n.fields.slice(),o=i[e].clone({type:t.type}),s=this.schema.fields.map(((e,t)=>this.getChildAt(t)));[i[e],s[e]]=[o,t],[n,r]=wr(n,s)}return new Cr(n,r)}select(e){const t=this.schema.fields.reduce(((e,t,n)=>e.set(t.name,n)),new Map);return this.selectAt(e.map((e=>t.get(e))).filter((e=>e>-1)))}selectAt(e){const t=this.schema.selectAt(e),n=this.batches.map((t=>t.selectAt(e)));return new Cr(t,n)}assign(e){const t=this.schema.fields,[n,r]=e.schema.fields.reduce(((e,n,r)=>{const[i,o]=e,s=t.findIndex((e=>e.name===n.name));return~s?o[s]=r:i.push(r),e}),[[],[]]),i=this.schema.assign(e.schema),o=[...t.map(((e,t)=>[t,r[t]])).map((t=>{let[n,r]=t;return void 0===r?this.getChildAt(n):e.getChildAt(r)})),...n.map((t=>e.getChildAt(t)))].filter(Boolean);return new Cr(...wr(i,o))}}gr=Symbol.toStringTag,Cr[gr]=(e=>(e.schema=null,e.batches=[],e._offsets=new Uint32Array([0]),e._nullCount=-1,e[Symbol.isConcatSpreadable]=!0,e.isValid=_n(wn),e.get=_n(nn.getVisitFn(u.Struct)),e.set=Cn(Mt.getVisitFn(u.Struct)),e.indexOf=In(Nn.getVisitFn(u.Struct)),e.getByteLength=_n($n.getVisitFn(u.Struct)),"Table"))(Cr.prototype);class Ir{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static sizeOf(){return 24}static createBlock(e,t,n,r){return e.prep(8,24),e.writeInt64(r),e.pad(4),e.writeInt32(n),e.writeInt64(t),e.offset()}}const Tr=new Int32Array(2),Sr=new Float32Array(Tr.buffer),kr=new Float64Array(Tr.buffer),Ar=1===new Uint16Array(new Uint8Array([1,0]).buffer)[0];class Er{constructor(e,t){this.low=0|e,this.high=0|t}static create(e,t){return 0==e&&0==t?Er.ZERO:new Er(e,t)}toFloat64(){return(this.low>>>0)+4294967296*this.high}equals(e){return this.low==e.low&&this.high==e.high}}var Mr,Rr,Or,Pr,xr;Er.ZERO=new Er(0,0),function(e){e[e.UTF8_BYTES=1]="UTF8_BYTES",e[e.UTF16_STRING=2]="UTF16_STRING"}(Mr||(Mr={}));class Nr{constructor(e){this.bytes_=e,this.position_=0}static allocate(e){return new Nr(new Uint8Array(e))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(e){this.position_=e}capacity(){return this.bytes_.length}readInt8(e){return this.readUint8(e)<<24>>24}readUint8(e){return this.bytes_[e]}readInt16(e){return this.readUint16(e)<<16>>16}readUint16(e){return this.bytes_[e]|this.bytes_[e+1]<<8}readInt32(e){return this.bytes_[e]|this.bytes_[e+1]<<8|this.bytes_[e+2]<<16|this.bytes_[e+3]<<24}readUint32(e){return this.readInt32(e)>>>0}readInt64(e){return new Er(this.readInt32(e),this.readInt32(e+4))}readUint64(e){return new Er(this.readUint32(e),this.readUint32(e+4))}readFloat32(e){return Tr[0]=this.readInt32(e),Sr[0]}readFloat64(e){return Tr[Ar?0:1]=this.readInt32(e),Tr[Ar?1:0]=this.readInt32(e+4),kr[0]}writeInt8(e,t){this.bytes_[e]=t}writeUint8(e,t){this.bytes_[e]=t}writeInt16(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8}writeUint16(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8}writeInt32(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8,this.bytes_[e+2]=t>>16,this.bytes_[e+3]=t>>24}writeUint32(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8,this.bytes_[e+2]=t>>16,this.bytes_[e+3]=t>>24}writeInt64(e,t){this.writeInt32(e,t.low),this.writeInt32(e+4,t.high)}writeUint64(e,t){this.writeUint32(e,t.low),this.writeUint32(e+4,t.high)}writeFloat32(e,t){Sr[0]=t,this.writeInt32(e,Tr[0])}writeFloat64(e,t){kr[0]=t,this.writeInt32(e,Tr[Ar?0:1]),this.writeInt32(e+4,Tr[Ar?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+4+4)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let e="";for(let t=0;t<4;t++)e+=String.fromCharCode(this.readInt8(this.position_+4+t));return e}__offset(e,t){const n=e-this.readInt32(e);return t<this.readInt16(n)?this.readInt16(n+t):0}__union(e,t){return e.bb_pos=t+this.readInt32(t),e.bb=this,e}__string(e,t){e+=this.readInt32(e);const n=this.readInt32(e);let r="",i=0;if(e+=4,t===Mr.UTF8_BYTES)return this.bytes_.subarray(e,e+n);for(;i<n;){let t;const n=this.readUint8(e+i++);if(n<192)t=n;else{const r=this.readUint8(e+i++);if(n<224)t=(31&n)<<6|63&r;else{const o=this.readUint8(e+i++);if(n<240)t=(15&n)<<12|(63&r)<<6|63&o;else{t=(7&n)<<18|(63&r)<<12|(63&o)<<6|63&this.readUint8(e+i++)}}}t<65536?r+=String.fromCharCode(t):(t-=65536,r+=String.fromCharCode(55296+(t>>10),56320+(1023&t)))}return r}__union_with_string(e,t){return"string"===typeof e?this.__string(t):this.__union(e,t)}__indirect(e){return e+this.readInt32(e)}__vector(e){return e+this.readInt32(e)+4}__vector_len(e){return this.readInt32(e+this.readInt32(e))}__has_identifier(e){if(4!=e.length)throw new Error("FlatBuffers: file identifier must be length 4");for(let t=0;t<4;t++)if(e.charCodeAt(t)!=this.readInt8(this.position()+4+t))return!1;return!0}createLong(e,t){return Er.create(e,t)}createScalarList(e,t){const n=[];for(let r=0;r<t;++r)null!==e(r)&&n.push(e(r));return n}createObjList(e,t){const n=[];for(let r=0;r<t;++r){const t=e(r);null!==t&&n.push(t.unpack())}return n}}class Br{constructor(e){let t;this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null,t=e||1024,this.bb=Nr.allocate(t),this.space=t}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(e){this.force_defaults=e}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(e,t){e>this.minalign&&(this.minalign=e);const n=1+~(this.bb.capacity()-this.space+t)&e-1;for(;this.space<n+e+t;){const e=this.bb.capacity();this.bb=Br.growByteBuffer(this.bb),this.space+=this.bb.capacity()-e}this.pad(n)}pad(e){for(let t=0;t<e;t++)this.bb.writeInt8(--this.space,0)}writeInt8(e){this.bb.writeInt8(this.space-=1,e)}writeInt16(e){this.bb.writeInt16(this.space-=2,e)}writeInt32(e){this.bb.writeInt32(this.space-=4,e)}writeInt64(e){this.bb.writeInt64(this.space-=8,e)}writeFloat32(e){this.bb.writeFloat32(this.space-=4,e)}writeFloat64(e){this.bb.writeFloat64(this.space-=8,e)}addInt8(e){this.prep(1,0),this.writeInt8(e)}addInt16(e){this.prep(2,0),this.writeInt16(e)}addInt32(e){this.prep(4,0),this.writeInt32(e)}addInt64(e){this.prep(8,0),this.writeInt64(e)}addFloat32(e){this.prep(4,0),this.writeFloat32(e)}addFloat64(e){this.prep(8,0),this.writeFloat64(e)}addFieldInt8(e,t,n){(this.force_defaults||t!=n)&&(this.addInt8(t),this.slot(e))}addFieldInt16(e,t,n){(this.force_defaults||t!=n)&&(this.addInt16(t),this.slot(e))}addFieldInt32(e,t,n){(this.force_defaults||t!=n)&&(this.addInt32(t),this.slot(e))}addFieldInt64(e,t,n){!this.force_defaults&&t.equals(n)||(this.addInt64(t),this.slot(e))}addFieldFloat32(e,t,n){(this.force_defaults||t!=n)&&(this.addFloat32(t),this.slot(e))}addFieldFloat64(e,t,n){(this.force_defaults||t!=n)&&(this.addFloat64(t),this.slot(e))}addFieldOffset(e,t,n){(this.force_defaults||t!=n)&&(this.addOffset(t),this.slot(e))}addFieldStruct(e,t,n){t!=n&&(this.nested(t),this.slot(e))}nested(e){if(e!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")}slot(e){null!==this.vtable&&(this.vtable[e]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(e){const t=e.capacity();if(3221225472&t)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");const n=t<<1,r=Nr.allocate(n);return r.setPosition(n-t),r.bytes().set(e.bytes(),n-t),r}addOffset(e){this.prep(4,0),this.writeInt32(this.offset()-e+4)}startObject(e){this.notNested(),null==this.vtable&&(this.vtable=[]),this.vtable_in_use=e;for(let t=0;t<e;t++)this.vtable[t]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(null==this.vtable||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);const e=this.offset();let t=this.vtable_in_use-1;for(;t>=0&&0==this.vtable[t];t--);const n=t+1;for(;t>=0;t--)this.addInt16(0!=this.vtable[t]?e-this.vtable[t]:0);this.addInt16(e-this.object_start);const r=2*(n+2);this.addInt16(r);let i=0;const o=this.space;e:for(t=0;t<this.vtables.length;t++){const e=this.bb.capacity()-this.vtables[t];if(r==this.bb.readInt16(e)){for(let t=2;t<r;t+=2)if(this.bb.readInt16(o+t)!=this.bb.readInt16(e+t))continue e;i=this.vtables[t];break}}return i?(this.space=this.bb.capacity()-e,this.bb.writeInt32(this.space,i-e)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-e,this.offset()-e)),this.isNested=!1,e}finish(e,t,n){const r=n?4:0;if(t){const e=t;if(this.prep(this.minalign,8+r),4!=e.length)throw new Error("FlatBuffers: file identifier must be length 4");for(let t=3;t>=0;t--)this.writeInt8(e.charCodeAt(t))}this.prep(this.minalign,4+r),this.addOffset(e),r&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(e,t){this.finish(e,t,!0)}requiredField(e,t){const n=this.bb.capacity()-e,r=n-this.bb.readInt32(n);if(!(0!=this.bb.readInt16(r+t)))throw new Error("FlatBuffers: field "+t+" must be set")}startVector(e,t,n){this.notNested(),this.vector_num_elems=t,this.prep(4,e*t),this.prep(n,e*t)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(e){if(!e)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(e))return this.string_maps.get(e);const t=this.createString(e);return this.string_maps.set(e,t),t}createString(e){if(!e)return 0;let t;if(e instanceof Uint8Array)t=e;else{t=[];let n=0;for(;n<e.length;){let r;const i=e.charCodeAt(n++);if(i<55296||i>=56320)r=i;else{r=(i<<10)+e.charCodeAt(n++)+-56613888}r<128?t.push(r):(r<2048?t.push(r>>6&31|192):(r<65536?t.push(r>>12&15|224):t.push(r>>18&7|240,r>>12&63|128),t.push(r>>6&63|128)),t.push(63&r|128))}}this.addInt8(0),this.startVector(1,t.length,1),this.bb.setPosition(this.space-=t.length);for(let n=0,r=this.space,i=this.bb.bytes();n<t.length;n++)i[r++]=t[n];return this.endVector()}createLong(e,t){return Er.create(e,t)}createObjectOffset(e){return null===e?0:"string"===typeof e?this.createString(e):e.pack(this)}createObjectOffsetList(e){const t=[];for(let n=0;n<e.length;++n){const r=e[n];if(null===r)throw new Error("FlatBuffers: Argument for createObjectOffsetList cannot contain null.");t.push(this.createObjectOffset(r))}return t}createStructOffsetList(e,t){return t(this,e.length),this.createObjectOffsetList(e),this.endVector()}}class Dr{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsKeyValue(e,t){return(t||new Dr).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsKeyValue(e,t){return e.setPosition(e.position()+4),(t||new Dr).__init(e.readInt32(e.position())+e.position(),e)}key(e){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}value(e){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}static startKeyValue(e){e.startObject(2)}static addKey(e,t){e.addFieldOffset(0,t,0)}static addValue(e,t){e.addFieldOffset(1,t,0)}static endKeyValue(e){return e.endObject()}static createKeyValue(e,t,n){return Dr.startKeyValue(e),Dr.addKey(e,t),Dr.addValue(e,n),Dr.endKeyValue(e)}}!function(e){e[e.V1=0]="V1",e[e.V2=1]="V2",e[e.V3=2]="V3",e[e.V4=3]="V4",e[e.V5=4]="V5"}(Rr||(Rr={})),function(e){e[e.Little=0]="Little",e[e.Big=1]="Big"}(Or||(Or={})),function(e){e[e.DenseArray=0]="DenseArray"}(Pr||(Pr={}));class Lr{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsInt(e,t){return(t||new Lr).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsInt(e,t){return e.setPosition(e.position()+4),(t||new Lr).__init(e.readInt32(e.position())+e.position(),e)}bitWidth(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}isSigned(){const e=this.bb.__offset(this.bb_pos,6);return!!e&&!!this.bb.readInt8(this.bb_pos+e)}static startInt(e){e.startObject(2)}static addBitWidth(e,t){e.addFieldInt32(0,t,0)}static addIsSigned(e,t){e.addFieldInt8(1,+t,0)}static endInt(e){return e.endObject()}static createInt(e,t,n){return Lr.startInt(e),Lr.addBitWidth(e,t),Lr.addIsSigned(e,n),Lr.endInt(e)}}class Fr{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDictionaryEncoding(e,t){return(t||new Fr).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDictionaryEncoding(e,t){return e.setPosition(e.position()+4),(t||new Fr).__init(e.readInt32(e.position())+e.position(),e)}id(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}indexType(e){const t=this.bb.__offset(this.bb_pos,6);return t?(e||new Lr).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}isOrdered(){const e=this.bb.__offset(this.bb_pos,8);return!!e&&!!this.bb.readInt8(this.bb_pos+e)}dictionaryKind(){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt16(this.bb_pos+e):Pr.DenseArray}static startDictionaryEncoding(e){e.startObject(4)}static addId(e,t){e.addFieldInt64(0,t,e.createLong(0,0))}static addIndexType(e,t){e.addFieldOffset(1,t,0)}static addIsOrdered(e,t){e.addFieldInt8(2,+t,0)}static addDictionaryKind(e,t){e.addFieldInt16(3,t,Pr.DenseArray)}static endDictionaryEncoding(e){return e.endObject()}}!function(e){e[e.NONE=0]="NONE",e[e.Null=1]="Null",e[e.Int=2]="Int",e[e.FloatingPoint=3]="FloatingPoint",e[e.Binary=4]="Binary",e[e.Utf8=5]="Utf8",e[e.Bool=6]="Bool",e[e.Decimal=7]="Decimal",e[e.Date=8]="Date",e[e.Time=9]="Time",e[e.Timestamp=10]="Timestamp",e[e.Interval=11]="Interval",e[e.List=12]="List",e[e.Struct_=13]="Struct_",e[e.Union=14]="Union",e[e.FixedSizeBinary=15]="FixedSizeBinary",e[e.FixedSizeList=16]="FixedSizeList",e[e.Map=17]="Map",e[e.Duration=18]="Duration",e[e.LargeBinary=19]="LargeBinary",e[e.LargeUtf8=20]="LargeUtf8",e[e.LargeList=21]="LargeList"}(xr||(xr={}));class Ur{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsField(e,t){return(t||new Ur).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsField(e,t){return e.setPosition(e.position()+4),(t||new Ur).__init(e.readInt32(e.position())+e.position(),e)}name(e){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}nullable(){const e=this.bb.__offset(this.bb_pos,6);return!!e&&!!this.bb.readInt8(this.bb_pos+e)}typeType(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readUint8(this.bb_pos+e):xr.NONE}type(e){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__union(e,this.bb_pos+t):null}dictionary(e){const t=this.bb.__offset(this.bb_pos,12);return t?(e||new Fr).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}children(e,t){const n=this.bb.__offset(this.bb_pos,14);return n?(t||new Ur).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}childrenLength(){const e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__vector_len(this.bb_pos+e):0}customMetadata(e,t){const n=this.bb.__offset(this.bb_pos,16);return n?(t||new Dr).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}customMetadataLength(){const e=this.bb.__offset(this.bb_pos,16);return e?this.bb.__vector_len(this.bb_pos+e):0}static startField(e){e.startObject(7)}static addName(e,t){e.addFieldOffset(0,t,0)}static addNullable(e,t){e.addFieldInt8(1,+t,0)}static addTypeType(e,t){e.addFieldInt8(2,t,xr.NONE)}static addType(e,t){e.addFieldOffset(3,t,0)}static addDictionary(e,t){e.addFieldOffset(4,t,0)}static addChildren(e,t){e.addFieldOffset(5,t,0)}static createChildrenVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startChildrenVector(e,t){e.startVector(4,t,4)}static addCustomMetadata(e,t){e.addFieldOffset(6,t,0)}static createCustomMetadataVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startCustomMetadataVector(e,t){e.startVector(4,t,4)}static endField(e){return e.endObject()}}class qr{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsSchema(e,t){return(t||new qr).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsSchema(e,t){return e.setPosition(e.position()+4),(t||new qr).__init(e.readInt32(e.position())+e.position(),e)}endianness(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Or.Little}fields(e,t){const n=this.bb.__offset(this.bb_pos,6);return n?(t||new Ur).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}fieldsLength(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}customMetadata(e,t){const n=this.bb.__offset(this.bb_pos,8);return n?(t||new Dr).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}customMetadataLength(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}features(e){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt64(this.bb.__vector(this.bb_pos+t)+8*e):this.bb.createLong(0,0)}featuresLength(){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__vector_len(this.bb_pos+e):0}static startSchema(e){e.startObject(4)}static addEndianness(e,t){e.addFieldInt16(0,t,Or.Little)}static addFields(e,t){e.addFieldOffset(1,t,0)}static createFieldsVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startFieldsVector(e,t){e.startVector(4,t,4)}static addCustomMetadata(e,t){e.addFieldOffset(2,t,0)}static createCustomMetadataVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startCustomMetadataVector(e,t){e.startVector(4,t,4)}static addFeatures(e,t){e.addFieldOffset(3,t,0)}static createFeaturesVector(e,t){e.startVector(8,t.length,8);for(let n=t.length-1;n>=0;n--)e.addInt64(t[n]);return e.endVector()}static startFeaturesVector(e,t){e.startVector(8,t,8)}static endSchema(e){return e.endObject()}static finishSchemaBuffer(e,t){e.finish(t)}static finishSizePrefixedSchemaBuffer(e,t){e.finish(t,void 0,!0)}static createSchema(e,t,n,r,i){return qr.startSchema(e),qr.addEndianness(e,t),qr.addFields(e,n),qr.addCustomMetadata(e,r),qr.addFeatures(e,i),qr.endSchema(e)}}class zr{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsFooter(e,t){return(t||new zr).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsFooter(e,t){return e.setPosition(e.position()+4),(t||new zr).__init(e.readInt32(e.position())+e.position(),e)}version(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Rr.V1}schema(e){const t=this.bb.__offset(this.bb_pos,6);return t?(e||new qr).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}dictionaries(e,t){const n=this.bb.__offset(this.bb_pos,8);return n?(t||new Ir).__init(this.bb.__vector(this.bb_pos+n)+24*e,this.bb):null}dictionariesLength(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}recordBatches(e,t){const n=this.bb.__offset(this.bb_pos,10);return n?(t||new Ir).__init(this.bb.__vector(this.bb_pos+n)+24*e,this.bb):null}recordBatchesLength(){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__vector_len(this.bb_pos+e):0}customMetadata(e,t){const n=this.bb.__offset(this.bb_pos,12);return n?(t||new Dr).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}customMetadataLength(){const e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__vector_len(this.bb_pos+e):0}static startFooter(e){e.startObject(5)}static addVersion(e,t){e.addFieldInt16(0,t,Rr.V1)}static addSchema(e,t){e.addFieldOffset(1,t,0)}static addDictionaries(e,t){e.addFieldOffset(2,t,0)}static startDictionariesVector(e,t){e.startVector(24,t,8)}static addRecordBatches(e,t){e.addFieldOffset(3,t,0)}static startRecordBatchesVector(e,t){e.startVector(24,t,8)}static addCustomMetadata(e,t){e.addFieldOffset(4,t,0)}static createCustomMetadataVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startCustomMetadataVector(e,t){e.startVector(4,t,4)}static endFooter(e){return e.endObject()}static finishFooterBuffer(e,t){e.finish(t)}static finishSizePrefixedFooterBuffer(e,t){e.finish(t,void 0,!0)}}var Hr=Er,$r=Br,jr=Nr;class Kr{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.V4,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;this.schema=e,this.version=t,n&&(this._recordBatches=n),i&&(this._dictionaryBatches=i)}static decode(e){e=new jr(X(e));const t=zr.getRootAsFooter(e),n=Xn.decode(t.schema());return new Vr(n,t)}static encode(e){const t=new $r,n=Xn.encode(t,e.schema);zr.startRecordBatchesVector(t,e.numRecordBatches);for(const r of[...e.recordBatches()].slice().reverse())Wr.encode(t,r);const i=t.endVector();zr.startDictionariesVector(t,e.numDictionaries);for(const r of[...e.dictionaryBatches()].slice().reverse())Wr.encode(t,r);const o=t.endVector();return zr.startFooter(t),zr.addSchema(t,n),zr.addVersion(t,r.V4),zr.addRecordBatches(t,i),zr.addDictionaries(t,o),zr.finishFooterBuffer(t,zr.endFooter(t)),t.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}*recordBatches(){for(let e,t=-1,n=this.numRecordBatches;++t<n;)(e=this.getRecordBatch(t))&&(yield e)}*dictionaryBatches(){for(let e,t=-1,n=this.numDictionaries;++t<n;)(e=this.getDictionaryBatch(t))&&(yield e)}getRecordBatch(e){return e>=0&&e<this.numRecordBatches&&this._recordBatches[e]||null}getDictionaryBatch(e){return e>=0&&e<this.numDictionaries&&this._dictionaryBatches[e]||null}}class Vr extends Kr{constructor(e,t){super(e,t.version()),this._footer=t}get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}getRecordBatch(e){if(e>=0&&e<this.numRecordBatches){const t=this._footer.recordBatches(e);if(t)return Wr.decode(t)}return null}getDictionaryBatch(e){if(e>=0&&e<this.numDictionaries){const t=this._footer.dictionaries(e);if(t)return Wr.decode(t)}return null}}class Wr{constructor(e,t,n){this.metaDataLength=e,this.offset="number"===typeof n?n:n.low,this.bodyLength="number"===typeof t?t:t.low}static decode(e){return new Wr(e.metaDataLength(),e.bodyLength(),e.offset())}static encode(e,t){const{metaDataLength:n}=t,r=new Hr(t.offset,0),i=new Hr(t.bodyLength,0);return Ir.createBlock(e,r,n,i)}}const Qr={fromIterable:e=>Yr(function*(e){let t,n,r,i,o=!1,s=[],a=0;function c(){return"peek"===r?Y(s,i)[0]:([n,s,a]=Y(s,i),n)}({cmd:r,size:i}=yield null);const l=(u=e,ee(Uint8Array,u))[Symbol.iterator]();var u;try{do{if(({done:t,value:n}=Number.isNaN(i-a)?l.next():l.next(i-a)),!t&&n.byteLength>0&&(s.push(n),a+=n.byteLength),t||i<=a)do{({cmd:r,size:i}=yield c())}while(i<a)}while(!t)}catch(d){(o=!0)&&"function"===typeof l.throw&&l.throw(d)}finally{!1===o&&"function"===typeof l.return&&l.return(null)}return null}(e)),fromAsyncIterable:e=>Yr(function(e){return q(this,arguments,(function*(){let t,n,r,i,o=!1,s=[],a=0;function c(){return"peek"===r?Y(s,i)[0]:([n,s,a]=Y(s,i),n)}({cmd:r,size:i}=yield yield U(null));const l=(u=e,te(Uint8Array,u))[Symbol.asyncIterator]();var u;try{do{if(({done:t,value:n}=Number.isNaN(i-a)?yield U(l.next()):yield U(l.next(i-a))),!t&&n.byteLength>0&&(s.push(n),a+=n.byteLength),t||i<=a)do{({cmd:r,size:i}=yield yield U(c()))}while(i<a)}while(!t)}catch(d){(o=!0)&&"function"===typeof l.throw&&(yield U(l.throw(d)))}finally{!1===o&&"function"===typeof l.return&&(yield U(l.return(new Uint8Array(0))))}return yield U(null)}))}(e)),fromDOMStream:e=>Yr(function(e){return q(this,arguments,(function*(){let t,n,r,i=!1,o=!1,s=[],a=0;function c(){return"peek"===n?Y(s,r)[0]:([t,s,a]=Y(s,r),t)}({cmd:n,size:r}=yield yield U(null));const l=new Gr(e);try{do{if(({done:i,value:t}=Number.isNaN(r-a)?yield U(l.read()):yield U(l.read(r-a))),!i&&t.byteLength>0&&(s.push(X(t)),a+=t.byteLength),i||r<=a)do{({cmd:n,size:r}=yield yield U(c()))}while(r<a)}while(!i)}catch(u){(o=!0)&&(yield U(l.cancel(u)))}finally{!1===o?yield U(l.cancel()):e.locked&&l.releaseLock()}return yield U(null)}))}(e)),fromNodeStream:e=>Yr(function(e){return q(this,arguments,(function*(){const t=[];let n,r,i,o="error",s=!1,a=null,c=0,l=[];function u(){return"peek"===n?Y(l,r)[0]:([i,l,c]=Y(l,r),i)}if(({cmd:n,size:r}=yield yield U(null)),e.isTTY)return yield yield U(new Uint8Array(0)),yield U(null);try{t[0]=Jr(e,"end"),t[1]=Jr(e,"error");do{if(t[2]=Jr(e,"readable"),[o,a]=yield U(Promise.race(t.map((e=>e[2])))),"error"===o)break;if((s="end"===o)||(Number.isFinite(r-c)?(i=X(e.read(r-c)),i.byteLength<r-c&&(i=X(e.read()))):i=X(e.read()),i.byteLength>0&&(l.push(i),c+=i.byteLength)),s||r<=c)do{({cmd:n,size:r}=yield yield U(u()))}while(r<c)}while(!s)}finally{yield U(d(t,"error"===o?a:null))}return yield U(null);function d(t,n){return i=l=null,new Promise(((r,i)=>{for(const[n,s]of t)e.off(n,s);try{const t=e.destroy;t&&t.call(e,n),n=void 0}catch(o){n=o||n}finally{null!=n?i(n):r()}}))}}))}(e)),toDOMStream(e,t){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(e,t){throw new Error('"toNodeStream" not available in this environment')}},Yr=e=>(e.next(),e);class Gr{constructor(e){this.source=e,this.reader=null,this.reader=this.source.getReader(),this.reader.closed.catch((()=>{}))}get closed(){return this.reader?this.reader.closed.catch((()=>{})):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=null}cancel(e){return L(this,void 0,void 0,(function*(){const{reader:t,source:n}=this;t&&(yield t.cancel(e).catch((()=>{}))),n&&n.locked&&this.releaseLock()}))}read(e){return L(this,void 0,void 0,(function*(){if(0===e)return{done:null==this.reader,value:new Uint8Array(0)};const t=yield this.reader.read();return!t.done&&(t.value=X(t)),t}))}}const Jr=(e,t)=>{const n=e=>r([t,e]);let r;return[t,n,new Promise((i=>(r=i)&&e.once(t,n)))]};const Xr=Object.freeze({done:!0,value:void 0});class Zr{constructor(e){this._json=e}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}}class ei{tee(){return this._getDOMStream().tee()}pipe(e,t){return this._getNodeStream().pipe(e,t)}pipeTo(e,t){return this._getDOMStream().pipeTo(e,t)}pipeThrough(e,t){return this._getDOMStream().pipeThrough(e,t)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}}class ti extends ei{constructor(){super(),this._values=[],this.resolvers=[],this._closedPromise=new Promise((e=>this._closedPromiseResolve=e))}get closed(){return this._closedPromise}cancel(e){return L(this,void 0,void 0,(function*(){yield this.return(e)}))}write(e){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(e):this.resolvers.shift().resolve({done:!1,value:e}))}abort(e){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:e}:this.resolvers.shift().reject({done:!0,value:e}))}close(){if(this._closedPromiseResolve){const{resolvers:e}=this;for(;e.length>0;)e.shift().resolve(Xr);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(e){return Qr.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,e)}toNodeStream(e){return Qr.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,e)}throw(e){return L(this,void 0,void 0,(function*(){return yield this.abort(e),Xr}))}return(e){return L(this,void 0,void 0,(function*(){return yield this.close(),Xr}))}read(e){return L(this,void 0,void 0,(function*(){return(yield this.next(e,"read")).value}))}peek(e){return L(this,void 0,void 0,(function*(){return(yield this.next(e,"peek")).value}))}next(){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise(((e,t)=>{this.resolvers.push({resolve:e,reject:t})})):Promise.resolve(Xr)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error("AsyncQueue is closed")}}class ni extends ti{write(e){if((e=X(e)).byteLength>0)return super.write(e)}toString(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?j(this.toUint8Array(!0)):this.toUint8Array(!1).then(j)}toUint8Array(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?Y(this._values)[0]:(()=>L(this,void 0,void 0,(function*(){var e,t;const n=[];let r=0;try{for(var i,o=H(this);!(i=yield o.next()).done;){const e=i.value;n.push(e),r+=e.byteLength}}catch(s){e={error:s}}finally{try{i&&!i.done&&(t=o.return)&&(yield t.call(o))}finally{if(e)throw e.error}}return Y(n,r)[0]})))()}}class ri{constructor(e){e&&(this.source=new oi(Qr.fromIterable(e)))}[Symbol.iterator](){return this}next(e){return this.source.next(e)}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}peek(e){return this.source.peek(e)}read(e){return this.source.read(e)}}class ii{constructor(e){e instanceof ii?this.source=e.source:e instanceof ni?this.source=new si(Qr.fromAsyncIterable(e)):B(e)?this.source=new si(Qr.fromNodeStream(e)):N(e)?this.source=new si(Qr.fromDOMStream(e)):P(e)?this.source=new si(Qr.fromDOMStream(e.body)):A(e)?this.source=new si(Qr.fromIterable(e)):(k(e)||E(e))&&(this.source=new si(Qr.fromAsyncIterable(e)))}[Symbol.asyncIterator](){return this}next(e){return this.source.next(e)}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}get closed(){return this.source.closed}cancel(e){return this.source.cancel(e)}peek(e){return this.source.peek(e)}read(e){return this.source.read(e)}}class oi{constructor(e){this.source=e}cancel(e){this.return(e)}peek(e){return this.next(e,"peek").value}read(e){return this.next(e,"read").value}next(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"read";return this.source.next({cmd:t,size:e})}throw(e){return Object.create(this.source.throw&&this.source.throw(e)||Xr)}return(e){return Object.create(this.source.return&&this.source.return(e)||Xr)}}class si{constructor(e){this.source=e,this._closedPromise=new Promise((e=>this._closedPromiseResolve=e))}cancel(e){return L(this,void 0,void 0,(function*(){yield this.return(e)}))}get closed(){return this._closedPromise}read(e){return L(this,void 0,void 0,(function*(){return(yield this.next(e,"read")).value}))}peek(e){return L(this,void 0,void 0,(function*(){return(yield this.next(e,"peek")).value}))}next(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"read";return L(this,void 0,void 0,(function*(){return yield this.source.next({cmd:t,size:e})}))}throw(e){return L(this,void 0,void 0,(function*(){const t=this.source.throw&&(yield this.source.throw(e))||Xr;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(t)}))}return(e){return L(this,void 0,void 0,(function*(){const t=this.source.return&&(yield this.source.return(e))||Xr;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(t)}))}}class ai extends ri{constructor(e,t){super(),this.position=0,this.buffer=X(e),this.size="undefined"===typeof t?this.buffer.byteLength:t}readInt32(e){const{buffer:t,byteOffset:n}=this.readAt(e,4);return new DataView(t,n).getInt32(0,!0)}seek(e){return this.position=Math.min(e,this.size),e<this.size}read(e){const{buffer:t,size:n,position:r}=this;return t&&r<n?("number"!==typeof e&&(e=Number.POSITIVE_INFINITY),this.position=Math.min(n,r+Math.min(n-r,e)),t.subarray(r,this.position)):null}readAt(e,t){const n=this.buffer,r=Math.min(this.size,e+t);return n?n.subarray(e,r):new Uint8Array(t)}close(){this.buffer&&(this.buffer=null)}throw(e){return this.close(),{done:!0,value:e}}return(e){return this.close(),{done:!0,value:e}}}class ci extends ii{constructor(e,t){super(),this.position=0,this._handle=e,"number"===typeof t?this.size=t:this._pending=(()=>L(this,void 0,void 0,(function*(){this.size=(yield e.stat()).size,delete this._pending})))()}readInt32(e){return L(this,void 0,void 0,(function*(){const{buffer:t,byteOffset:n}=yield this.readAt(e,4);return new DataView(t,n).getInt32(0,!0)}))}seek(e){return L(this,void 0,void 0,(function*(){return this._pending&&(yield this._pending),this.position=Math.min(e,this.size),e<this.size}))}read(e){return L(this,void 0,void 0,(function*(){this._pending&&(yield this._pending);const{_handle:t,size:n,position:r}=this;if(t&&r<n){"number"!==typeof e&&(e=Number.POSITIVE_INFINITY);let i=r,o=0,s=0;const a=Math.min(n,i+Math.min(n-i,e)),c=new Uint8Array(Math.max(0,(this.position=a)-i));for(;(i+=s)<a&&(o+=s)<c.byteLength;)({bytesRead:s}=yield t.read(c,o,c.byteLength-o,i));return c}return null}))}readAt(e,t){return L(this,void 0,void 0,(function*(){this._pending&&(yield this._pending);const{_handle:n,size:r}=this;if(n&&e+t<r){const i=Math.min(r,e+t),o=new Uint8Array(i-e);return(yield n.read(o,0,t,e)).buffer}return new Uint8Array(t)}))}close(){return L(this,void 0,void 0,(function*(){const e=this._handle;this._handle=null,e&&(yield e.close())}))}throw(e){return L(this,void 0,void 0,(function*(){return yield this.close(),{done:!0,value:e}}))}return(e){return L(this,void 0,void 0,(function*(){return yield this.close(),{done:!0,value:e}}))}}function li(e){return e<0&&(e=4294967295+e+1),`0x${e.toString(16)}`}const ui=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8];class di{constructor(e){this.buffer=e}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(e){const t=new Uint32Array([this.buffer[1]>>>16,65535&this.buffer[1],this.buffer[0]>>>16,65535&this.buffer[0]]),n=new Uint32Array([e.buffer[1]>>>16,65535&e.buffer[1],e.buffer[0]>>>16,65535&e.buffer[0]]);let r=t[3]*n[3];this.buffer[0]=65535&r;let i=r>>>16;return r=t[2]*n[3],i+=r,r=t[3]*n[2]>>>0,i+=r,this.buffer[0]+=i<<16,this.buffer[1]=i>>>0<r?65536:0,this.buffer[1]+=i>>>16,this.buffer[1]+=t[1]*n[3]+t[2]*n[2]+t[3]*n[1],this.buffer[1]+=t[0]*n[3]+t[1]*n[2]+t[2]*n[1]+t[3]*n[0]<<16,this}_plus(e){const t=this.buffer[0]+e.buffer[0]>>>0;this.buffer[1]+=e.buffer[1],t<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=t}lessThan(e){return this.buffer[1]<e.buffer[1]||this.buffer[1]===e.buffer[1]&&this.buffer[0]<e.buffer[0]}equals(e){return this.buffer[1]===e.buffer[1]&&this.buffer[0]==e.buffer[0]}greaterThan(e){return e.lessThan(this)}hex(){return`${li(this.buffer[1])} ${li(this.buffer[0])}`}}class hi extends di{times(e){return this._times(e),this}plus(e){return this._plus(e),this}static from(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint32Array(2);return hi.fromString("string"===typeof e?e:e.toString(),t)}static fromNumber(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint32Array(2);return hi.fromString(e.toString(),t)}static fromString(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint32Array(2);const n=e.length,r=new hi(t);for(let i=0;i<n;){const t=8<n-i?8:n-i,o=new hi(new Uint32Array([Number.parseInt(e.slice(i,i+t),10),0])),s=new hi(new Uint32Array([ui[t],0]));r.times(s),r.plus(o),i+=t}return r}static convertArray(e){const t=new Uint32Array(2*e.length);for(let n=-1,r=e.length;++n<r;)hi.from(e[n],new Uint32Array(t.buffer,t.byteOffset+2*n*4,2));return t}static multiply(e,t){return new hi(new Uint32Array(e.buffer)).times(t)}static add(e,t){return new hi(new Uint32Array(e.buffer)).plus(t)}}class pi extends di{negate(){return this.buffer[0]=1+~this.buffer[0],this.buffer[1]=~this.buffer[1],0==this.buffer[0]&&++this.buffer[1],this}times(e){return this._times(e),this}plus(e){return this._plus(e),this}lessThan(e){const t=this.buffer[1]|0,n=e.buffer[1]|0;return t<n||t===n&&this.buffer[0]<e.buffer[0]}static from(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint32Array(2);return pi.fromString("string"===typeof e?e:e.toString(),t)}static fromNumber(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint32Array(2);return pi.fromString(e.toString(),t)}static fromString(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint32Array(2);const n=e.startsWith("-"),r=e.length,i=new pi(t);for(let o=n?1:0;o<r;){const t=8<r-o?8:r-o,n=new pi(new Uint32Array([Number.parseInt(e.slice(o,o+t),10),0])),s=new pi(new Uint32Array([ui[t],0]));i.times(s),i.plus(n),o+=t}return n?i.negate():i}static convertArray(e){const t=new Uint32Array(2*e.length);for(let n=-1,r=e.length;++n<r;)pi.from(e[n],new Uint32Array(t.buffer,t.byteOffset+2*n*4,2));return t}static multiply(e,t){return new pi(new Uint32Array(e.buffer)).times(t)}static add(e,t){return new pi(new Uint32Array(e.buffer)).plus(t)}}class fi{constructor(e){this.buffer=e}high(){return new pi(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new pi(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=1+~this.buffer[0],this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],0==this.buffer[0]&&++this.buffer[1],0==this.buffer[1]&&++this.buffer[2],0==this.buffer[2]&&++this.buffer[3],this}times(e){const t=new hi(new Uint32Array([this.buffer[3],0])),n=new hi(new Uint32Array([this.buffer[2],0])),r=new hi(new Uint32Array([this.buffer[1],0])),i=new hi(new Uint32Array([this.buffer[0],0])),o=new hi(new Uint32Array([e.buffer[3],0])),s=new hi(new Uint32Array([e.buffer[2],0])),a=new hi(new Uint32Array([e.buffer[1],0])),c=new hi(new Uint32Array([e.buffer[0],0]));let l=hi.multiply(i,c);this.buffer[0]=l.low();const u=new hi(new Uint32Array([l.high(),0]));l=hi.multiply(r,c),u.plus(l),l=hi.multiply(i,a),u.plus(l),this.buffer[1]=u.low(),this.buffer[3]=u.lessThan(l)?1:0,this.buffer[2]=u.high();return new hi(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(hi.multiply(n,c)).plus(hi.multiply(r,a)).plus(hi.multiply(i,s)),this.buffer[3]+=hi.multiply(t,c).plus(hi.multiply(n,a)).plus(hi.multiply(r,s)).plus(hi.multiply(i,o)).low(),this}plus(e){const t=new Uint32Array(4);return t[3]=this.buffer[3]+e.buffer[3]>>>0,t[2]=this.buffer[2]+e.buffer[2]>>>0,t[1]=this.buffer[1]+e.buffer[1]>>>0,t[0]=this.buffer[0]+e.buffer[0]>>>0,t[0]<this.buffer[0]>>>0&&++t[1],t[1]<this.buffer[1]>>>0&&++t[2],t[2]<this.buffer[2]>>>0&&++t[3],this.buffer[3]=t[3],this.buffer[2]=t[2],this.buffer[1]=t[1],this.buffer[0]=t[0],this}hex(){return`${li(this.buffer[3])} ${li(this.buffer[2])} ${li(this.buffer[1])} ${li(this.buffer[0])}`}static multiply(e,t){return new fi(new Uint32Array(e.buffer)).times(t)}static add(e,t){return new fi(new Uint32Array(e.buffer)).plus(t)}static from(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint32Array(4);return fi.fromString("string"===typeof e?e:e.toString(),t)}static fromNumber(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint32Array(4);return fi.fromString(e.toString(),t)}static fromString(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint32Array(4);const n=e.startsWith("-"),r=e.length,i=new fi(t);for(let o=n?1:0;o<r;){const t=8<r-o?8:r-o,n=new fi(new Uint32Array([Number.parseInt(e.slice(o,o+t),10),0,0,0])),s=new fi(new Uint32Array([ui[t],0,0,0]));i.times(s),i.plus(n),o+=t}return n?i.negate():i}static convertArray(e){const t=new Uint32Array(4*e.length);for(let n=-1,r=e.length;++n<r;)fi.from(e[n],new Uint32Array(t.buffer,t.byteOffset+16*n,4));return t}}class gi extends nt{constructor(e,t,n,r){super(),this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=e,this.nodes=t,this.buffers=n,this.dictionaries=r}visit(e){return super.visit(e instanceof Zn?e.type:e)}visitNull(e){let{length:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Jn({type:e,length:t})}visitBool(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Jn({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e)})}visitInt(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Jn({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e)})}visitFloat(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Jn({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e)})}visitUtf8(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Jn({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),valueOffsets:this.readOffsets(e),data:this.readData(e)})}visitBinary(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Jn({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),valueOffsets:this.readOffsets(e),data:this.readData(e)})}visitFixedSizeBinary(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Jn({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e)})}visitDate(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Jn({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e)})}visitTimestamp(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Jn({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e)})}visitTime(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Jn({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e)})}visitDecimal(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Jn({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e)})}visitList(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Jn({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),valueOffsets:this.readOffsets(e),child:this.visit(e.children[0])})}visitStruct(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Jn({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),children:this.visitMany(e.children)})}visitUnion(e){return e.mode===i.Sparse?this.visitSparseUnion(e):this.visitDenseUnion(e)}visitDenseUnion(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Jn({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),typeIds:this.readTypeIds(e),valueOffsets:this.readOffsets(e),children:this.visitMany(e.children)})}visitSparseUnion(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Jn({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),typeIds:this.readTypeIds(e),children:this.visitMany(e.children)})}visitDictionary(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Jn({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e.indices),dictionary:this.readDictionary(e)})}visitInterval(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Jn({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e)})}visitFixedSizeList(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Jn({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),child:this.visit(e.children[0])})}visitMap(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Jn({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),valueOffsets:this.readOffsets(e),child:this.visit(e.children[0])})}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.nextBufferRange();return t>0&&this.readData(e,n)||new Uint8Array(0)}readOffsets(e,t){return this.readData(e,t)}readTypeIds(e,t){return this.readData(e,t)}readData(e){let{length:t,offset:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextBufferRange();return this.bytes.subarray(n,n+t)}readDictionary(e){return this.dictionaries.get(e.id)}}class mi extends gi{constructor(e,t,n,r){super(new Uint8Array(0),t,n,r),this.sources=e}readNullBitmap(e,t){let{offset:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.nextBufferRange();return t<=0?new Uint8Array(0):An(this.sources[n])}readOffsets(e){let{offset:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextBufferRange();return G(Uint8Array,G(Int32Array,this.sources[t]))}readTypeIds(e){let{offset:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextBufferRange();return G(Uint8Array,G(e.ArrayType,this.sources[t]))}readData(e){let{offset:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextBufferRange();const{sources:n}=this;return xe.isTimestamp(e)||(xe.isInt(e)||xe.isTime(e))&&64===e.bitWidth||xe.isDate(e)&&e.unit===s.MILLISECOND?G(Uint8Array,pi.convertArray(n[t])):xe.isDecimal(e)?G(Uint8Array,fi.convertArray(n[t])):xe.isBinary(e)||xe.isFixedSizeBinary(e)?function(e){const t=e.join(""),n=new Uint8Array(t.length/2);for(let r=0;r<t.length;r+=2)n[r>>1]=Number.parseInt(t.slice(r,r+2),16);return n}(n[t]):xe.isBool(e)?An(n[t]):xe.isUtf8(e)?V(n[t].join("")):G(Uint8Array,G(e.ArrayType,n[t].map((e=>+e))))}}var yi,vi,bi,wi,_i,Ci,Ii,Ti;!function(e){e[e.BUFFER=0]="BUFFER"}(yi||(yi={})),function(e){e[e.LZ4_FRAME=0]="LZ4_FRAME",e[e.ZSTD=1]="ZSTD"}(vi||(vi={}));class Si{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsBodyCompression(e,t){return(t||new Si).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsBodyCompression(e,t){return e.setPosition(e.position()+4),(t||new Si).__init(e.readInt32(e.position())+e.position(),e)}codec(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt8(this.bb_pos+e):vi.LZ4_FRAME}method(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt8(this.bb_pos+e):yi.BUFFER}static startBodyCompression(e){e.startObject(2)}static addCodec(e,t){e.addFieldInt8(0,t,vi.LZ4_FRAME)}static addMethod(e,t){e.addFieldInt8(1,t,yi.BUFFER)}static endBodyCompression(e){return e.endObject()}static createBodyCompression(e,t,n){return Si.startBodyCompression(e),Si.addCodec(e,t),Si.addMethod(e,n),Si.endBodyCompression(e)}}class ki{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createBuffer(e,t,n){return e.prep(8,16),e.writeInt64(n),e.writeInt64(t),e.offset()}}class Ai{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createFieldNode(e,t,n){return e.prep(8,16),e.writeInt64(n),e.writeInt64(t),e.offset()}}class Ei{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsRecordBatch(e,t){return(t||new Ei).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsRecordBatch(e,t){return e.setPosition(e.position()+4),(t||new Ei).__init(e.readInt32(e.position())+e.position(),e)}length(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}nodes(e,t){const n=this.bb.__offset(this.bb_pos,6);return n?(t||new Ai).__init(this.bb.__vector(this.bb_pos+n)+16*e,this.bb):null}nodesLength(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}buffers(e,t){const n=this.bb.__offset(this.bb_pos,8);return n?(t||new ki).__init(this.bb.__vector(this.bb_pos+n)+16*e,this.bb):null}buffersLength(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}compression(e){const t=this.bb.__offset(this.bb_pos,10);return t?(e||new Si).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}static startRecordBatch(e){e.startObject(4)}static addLength(e,t){e.addFieldInt64(0,t,e.createLong(0,0))}static addNodes(e,t){e.addFieldOffset(1,t,0)}static startNodesVector(e,t){e.startVector(16,t,8)}static addBuffers(e,t){e.addFieldOffset(2,t,0)}static startBuffersVector(e,t){e.startVector(16,t,8)}static addCompression(e,t){e.addFieldOffset(3,t,0)}static endRecordBatch(e){return e.endObject()}}class Mi{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDictionaryBatch(e,t){return(t||new Mi).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDictionaryBatch(e,t){return e.setPosition(e.position()+4),(t||new Mi).__init(e.readInt32(e.position())+e.position(),e)}id(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}data(e){const t=this.bb.__offset(this.bb_pos,6);return t?(e||new Ei).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}isDelta(){const e=this.bb.__offset(this.bb_pos,8);return!!e&&!!this.bb.readInt8(this.bb_pos+e)}static startDictionaryBatch(e){e.startObject(3)}static addId(e,t){e.addFieldInt64(0,t,e.createLong(0,0))}static addData(e,t){e.addFieldOffset(1,t,0)}static addIsDelta(e,t){e.addFieldInt8(2,+t,0)}static endDictionaryBatch(e){return e.endObject()}}!function(e){e[e.HALF=0]="HALF",e[e.SINGLE=1]="SINGLE",e[e.DOUBLE=2]="DOUBLE"}(bi||(bi={}));class Ri{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsFloatingPoint(e,t){return(t||new Ri).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsFloatingPoint(e,t){return e.setPosition(e.position()+4),(t||new Ri).__init(e.readInt32(e.position())+e.position(),e)}precision(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):bi.HALF}static startFloatingPoint(e){e.startObject(1)}static addPrecision(e,t){e.addFieldInt16(0,t,bi.HALF)}static endFloatingPoint(e){return e.endObject()}static createFloatingPoint(e,t){return Ri.startFloatingPoint(e),Ri.addPrecision(e,t),Ri.endFloatingPoint(e)}}class Oi{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDecimal(e,t){return(t||new Oi).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDecimal(e,t){return e.setPosition(e.position()+4),(t||new Oi).__init(e.readInt32(e.position())+e.position(),e)}precision(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}scale(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt32(this.bb_pos+e):0}bitWidth(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readInt32(this.bb_pos+e):128}static startDecimal(e){e.startObject(3)}static addPrecision(e,t){e.addFieldInt32(0,t,0)}static addScale(e,t){e.addFieldInt32(1,t,0)}static addBitWidth(e,t){e.addFieldInt32(2,t,128)}static endDecimal(e){return e.endObject()}static createDecimal(e,t,n,r){return Oi.startDecimal(e),Oi.addPrecision(e,t),Oi.addScale(e,n),Oi.addBitWidth(e,r),Oi.endDecimal(e)}}!function(e){e[e.DAY=0]="DAY",e[e.MILLISECOND=1]="MILLISECOND"}(wi||(wi={}));class Pi{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDate(e,t){return(t||new Pi).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDate(e,t){return e.setPosition(e.position()+4),(t||new Pi).__init(e.readInt32(e.position())+e.position(),e)}unit(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):wi.MILLISECOND}static startDate(e){e.startObject(1)}static addUnit(e,t){e.addFieldInt16(0,t,wi.MILLISECOND)}static endDate(e){return e.endObject()}static createDate(e,t){return Pi.startDate(e),Pi.addUnit(e,t),Pi.endDate(e)}}!function(e){e[e.SECOND=0]="SECOND",e[e.MILLISECOND=1]="MILLISECOND",e[e.MICROSECOND=2]="MICROSECOND",e[e.NANOSECOND=3]="NANOSECOND"}(_i||(_i={}));class xi{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsTime(e,t){return(t||new xi).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsTime(e,t){return e.setPosition(e.position()+4),(t||new xi).__init(e.readInt32(e.position())+e.position(),e)}unit(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):_i.MILLISECOND}bitWidth(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt32(this.bb_pos+e):32}static startTime(e){e.startObject(2)}static addUnit(e,t){e.addFieldInt16(0,t,_i.MILLISECOND)}static addBitWidth(e,t){e.addFieldInt32(1,t,32)}static endTime(e){return e.endObject()}static createTime(e,t,n){return xi.startTime(e),xi.addUnit(e,t),xi.addBitWidth(e,n),xi.endTime(e)}}class Ni{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsTimestamp(e,t){return(t||new Ni).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsTimestamp(e,t){return e.setPosition(e.position()+4),(t||new Ni).__init(e.readInt32(e.position())+e.position(),e)}unit(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):_i.SECOND}timezone(e){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}static startTimestamp(e){e.startObject(2)}static addUnit(e,t){e.addFieldInt16(0,t,_i.SECOND)}static addTimezone(e,t){e.addFieldOffset(1,t,0)}static endTimestamp(e){return e.endObject()}static createTimestamp(e,t,n){return Ni.startTimestamp(e),Ni.addUnit(e,t),Ni.addTimezone(e,n),Ni.endTimestamp(e)}}!function(e){e[e.YEAR_MONTH=0]="YEAR_MONTH",e[e.DAY_TIME=1]="DAY_TIME",e[e.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"}(Ci||(Ci={}));class Bi{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsInterval(e,t){return(t||new Bi).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsInterval(e,t){return e.setPosition(e.position()+4),(t||new Bi).__init(e.readInt32(e.position())+e.position(),e)}unit(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Ci.YEAR_MONTH}static startInterval(e){e.startObject(1)}static addUnit(e,t){e.addFieldInt16(0,t,Ci.YEAR_MONTH)}static endInterval(e){return e.endObject()}static createInterval(e,t){return Bi.startInterval(e),Bi.addUnit(e,t),Bi.endInterval(e)}}!function(e){e[e.Sparse=0]="Sparse",e[e.Dense=1]="Dense"}(Ii||(Ii={}));class Di{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsUnion(e,t){return(t||new Di).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsUnion(e,t){return e.setPosition(e.position()+4),(t||new Di).__init(e.readInt32(e.position())+e.position(),e)}mode(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Ii.Sparse}typeIds(e){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb.__vector(this.bb_pos+t)+4*e):0}typeIdsLength(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}typeIdsArray(){const e=this.bb.__offset(this.bb_pos,6);return e?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}static startUnion(e){e.startObject(2)}static addMode(e,t){e.addFieldInt16(0,t,Ii.Sparse)}static addTypeIds(e,t){e.addFieldOffset(1,t,0)}static createTypeIdsVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addInt32(t[n]);return e.endVector()}static startTypeIdsVector(e,t){e.startVector(4,t,4)}static endUnion(e){return e.endObject()}static createUnion(e,t,n){return Di.startUnion(e),Di.addMode(e,t),Di.addTypeIds(e,n),Di.endUnion(e)}}class Li{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsFixedSizeBinary(e,t){return(t||new Li).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsFixedSizeBinary(e,t){return e.setPosition(e.position()+4),(t||new Li).__init(e.readInt32(e.position())+e.position(),e)}byteWidth(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}static startFixedSizeBinary(e){e.startObject(1)}static addByteWidth(e,t){e.addFieldInt32(0,t,0)}static endFixedSizeBinary(e){return e.endObject()}static createFixedSizeBinary(e,t){return Li.startFixedSizeBinary(e),Li.addByteWidth(e,t),Li.endFixedSizeBinary(e)}}class Fi{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsFixedSizeList(e,t){return(t||new Fi).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsFixedSizeList(e,t){return e.setPosition(e.position()+4),(t||new Fi).__init(e.readInt32(e.position())+e.position(),e)}listSize(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}static startFixedSizeList(e){e.startObject(1)}static addListSize(e,t){e.addFieldInt32(0,t,0)}static endFixedSizeList(e){return e.endObject()}static createFixedSizeList(e,t){return Fi.startFixedSizeList(e),Fi.addListSize(e,t),Fi.endFixedSizeList(e)}}class Ui{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsMap(e,t){return(t||new Ui).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsMap(e,t){return e.setPosition(e.position()+4),(t||new Ui).__init(e.readInt32(e.position())+e.position(),e)}keysSorted(){const e=this.bb.__offset(this.bb_pos,4);return!!e&&!!this.bb.readInt8(this.bb_pos+e)}static startMap(e){e.startObject(1)}static addKeysSorted(e,t){e.addFieldInt8(0,+t,0)}static endMap(e){return e.endObject()}static createMap(e,t){return Ui.startMap(e),Ui.addKeysSorted(e,t),Ui.endMap(e)}}!function(e){e[e.NONE=0]="NONE",e[e.Schema=1]="Schema",e[e.DictionaryBatch=2]="DictionaryBatch",e[e.RecordBatch=3]="RecordBatch",e[e.Tensor=4]="Tensor",e[e.SparseTensor=5]="SparseTensor"}(Ti||(Ti={}));class qi{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsMessage(e,t){return(t||new qi).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsMessage(e,t){return e.setPosition(e.position()+4),(t||new qi).__init(e.readInt32(e.position())+e.position(),e)}version(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Rr.V1}headerType(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readUint8(this.bb_pos+e):Ti.NONE}header(e){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__union(e,this.bb_pos+t):null}bodyLength(){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}customMetadata(e,t){const n=this.bb.__offset(this.bb_pos,12);return n?(t||new Dr).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}customMetadataLength(){const e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__vector_len(this.bb_pos+e):0}static startMessage(e){e.startObject(5)}static addVersion(e,t){e.addFieldInt16(0,t,Rr.V1)}static addHeaderType(e,t){e.addFieldInt8(1,t,Ti.NONE)}static addHeader(e,t){e.addFieldOffset(2,t,0)}static addBodyLength(e,t){e.addFieldInt64(3,t,e.createLong(0,0))}static addCustomMetadata(e,t){e.addFieldOffset(4,t,0)}static createCustomMetadataVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startCustomMetadataVector(e,t){e.startVector(4,t,4)}static endMessage(e){return e.endObject()}static finishMessageBuffer(e,t){e.finish(t)}static finishSizePrefixedMessageBuffer(e,t){e.finish(t,void 0,!0)}static createMessage(e,t,n,r,i,o){return qi.startMessage(e),qi.addVersion(e,t),qi.addHeaderType(e,n),qi.addHeader(e,r),qi.addBodyLength(e,i),qi.addCustomMetadata(e,o),qi.endMessage(e)}}class zi{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsNull(e,t){return(t||new zi).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsNull(e,t){return e.setPosition(e.position()+4),(t||new zi).__init(e.readInt32(e.position())+e.position(),e)}static startNull(e){e.startObject(0)}static endNull(e){return e.endObject()}static createNull(e){return zi.startNull(e),zi.endNull(e)}}class Hi{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsBinary(e,t){return(t||new Hi).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsBinary(e,t){return e.setPosition(e.position()+4),(t||new Hi).__init(e.readInt32(e.position())+e.position(),e)}static startBinary(e){e.startObject(0)}static endBinary(e){return e.endObject()}static createBinary(e){return Hi.startBinary(e),Hi.endBinary(e)}}class $i{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsBool(e,t){return(t||new $i).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsBool(e,t){return e.setPosition(e.position()+4),(t||new $i).__init(e.readInt32(e.position())+e.position(),e)}static startBool(e){e.startObject(0)}static endBool(e){return e.endObject()}static createBool(e){return $i.startBool(e),$i.endBool(e)}}class ji{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsUtf8(e,t){return(t||new ji).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsUtf8(e,t){return e.setPosition(e.position()+4),(t||new ji).__init(e.readInt32(e.position())+e.position(),e)}static startUtf8(e){e.startObject(0)}static endUtf8(e){return e.endObject()}static createUtf8(e){return ji.startUtf8(e),ji.endUtf8(e)}}class Ki{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsList(e,t){return(t||new Ki).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsList(e,t){return e.setPosition(e.position()+4),(t||new Ki).__init(e.readInt32(e.position())+e.position(),e)}static startList(e){e.startObject(0)}static endList(e){return e.endObject()}static createList(e){return Ki.startList(e),Ki.endList(e)}}class Vi{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsStruct_(e,t){return(t||new Vi).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsStruct_(e,t){return e.setPosition(e.position()+4),(t||new Vi).__init(e.readInt32(e.position())+e.position(),e)}static startStruct_(e){e.startObject(0)}static endStruct_(e){return e.endObject()}static createStruct_(e){return Vi.startStruct_(e),Vi.endStruct_(e)}}var Wi=Er;const Qi=new class extends nt{visit(e,t){return null==e||null==t?void 0:super.visit(e,t)}visitNull(e,t){return zi.startNull(t),zi.endNull(t)}visitInt(e,t){return Lr.startInt(t),Lr.addBitWidth(t,e.bitWidth),Lr.addIsSigned(t,e.isSigned),Lr.endInt(t)}visitFloat(e,t){return Ri.startFloatingPoint(t),Ri.addPrecision(t,e.precision),Ri.endFloatingPoint(t)}visitBinary(e,t){return Hi.startBinary(t),Hi.endBinary(t)}visitBool(e,t){return $i.startBool(t),$i.endBool(t)}visitUtf8(e,t){return ji.startUtf8(t),ji.endUtf8(t)}visitDecimal(e,t){return Oi.startDecimal(t),Oi.addScale(t,e.scale),Oi.addPrecision(t,e.precision),Oi.addBitWidth(t,e.bitWidth),Oi.endDecimal(t)}visitDate(e,t){return Pi.startDate(t),Pi.addUnit(t,e.unit),Pi.endDate(t)}visitTime(e,t){return xi.startTime(t),xi.addUnit(t,e.unit),xi.addBitWidth(t,e.bitWidth),xi.endTime(t)}visitTimestamp(e,t){const n=e.timezone&&t.createString(e.timezone)||void 0;return Ni.startTimestamp(t),Ni.addUnit(t,e.unit),void 0!==n&&Ni.addTimezone(t,n),Ni.endTimestamp(t)}visitInterval(e,t){return Bi.startInterval(t),Bi.addUnit(t,e.unit),Bi.endInterval(t)}visitList(e,t){return Ki.startList(t),Ki.endList(t)}visitStruct(e,t){return Vi.startStruct_(t),Vi.endStruct_(t)}visitUnion(e,t){Di.startTypeIdsVector(t,e.typeIds.length);const n=Di.createTypeIdsVector(t,e.typeIds);return Di.startUnion(t),Di.addMode(t,e.mode),Di.addTypeIds(t,n),Di.endUnion(t)}visitDictionary(e,t){const n=this.visit(e.indices,t);return Fr.startDictionaryEncoding(t),Fr.addId(t,new Wi(e.id,0)),Fr.addIsOrdered(t,e.isOrdered),void 0!==n&&Fr.addIndexType(t,n),Fr.endDictionaryEncoding(t)}visitFixedSizeBinary(e,t){return Li.startFixedSizeBinary(t),Li.addByteWidth(t,e.byteWidth),Li.endFixedSizeBinary(t)}visitFixedSizeList(e,t){return Fi.startFixedSizeList(t),Fi.addListSize(t,e.listSize),Fi.endFixedSizeList(t)}visitMap(e,t){return Ui.startMap(t),Ui.addKeysSorted(t,e.keysSorted),Ui.endMap(t)}};function Yi(e){return new so(e.count,Ji(e.columns),Xi(e.columns))}function Gi(e,t){return(e.children||[]).filter(Boolean).map((e=>Zn.fromJSON(e,t)))}function Ji(e){return(e||[]).reduce(((e,t)=>{return[...e,new lo(t.count,(n=t.VALIDITY,(n||[]).reduce(((e,t)=>e+ +(0===t)),0))),...Ji(t.children)];var n}),[])}function Xi(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];for(let n=-1,r=(e||[]).length;++n<r;){const r=e[n];r.VALIDITY&&t.push(new co(t.length,r.VALIDITY.length)),r.TYPE&&t.push(new co(t.length,r.TYPE.length)),r.OFFSET&&t.push(new co(t.length,r.OFFSET.length)),r.DATA&&t.push(new co(t.length,r.DATA.length)),t=Xi(r.children,t)}return t}function Zi(e){return new Map(Object.entries(e||{}))}function eo(e){return new Be(e.isSigned,e.bitWidth)}function to(e,t){const n=e.type.name;switch(n){case"NONE":case"null":return new Ne;case"binary":return new Fe;case"utf8":return new Ue;case"bool":return new qe;case"list":return new Ve((t||[])[0]);case"struct":case"struct_":return new We(t||[])}switch(n){case"int":{const t=e.type;return new Be(t.isSigned,t.bitWidth)}case"floatingpoint":{const t=e.type;return new Le(o[t.precision])}case"decimal":{const t=e.type;return new ze(t.scale,t.precision,t.bitWidth)}case"date":{const t=e.type;return new He(s[t.unit])}case"time":{const t=e.type;return new $e(a[t.unit],t.bitWidth)}case"timestamp":{const t=e.type;return new je(a[t.unit],t.timezone)}case"interval":{const t=e.type;return new Ke(c[t.unit])}case"union":{const n=e.type;return new Qe(i[n.mode],n.typeIds||[],t||[])}case"fixedsizebinary":{const t=e.type;return new Ye(t.byteWidth)}case"fixedsizelist":{const n=e.type;return new Ge(n.listSize,(t||[])[0])}case"map":{const n=e.type;return new Je((t||[])[0],n.keysSorted)}}throw new Error(`Unrecognized type: "${n}"`)}var no=Er,ro=Br,io=Nr;class oo{constructor(e,t,n,r){this._version=t,this._headerType=n,this.body=new Uint8Array(0),r&&(this._createHeader=()=>r),this._bodyLength="number"===typeof e?e:e.low}static fromJSON(e,t){const n=new oo(0,r.V4,t);return n._createHeader=function(e,t){return()=>{switch(t){case l.Schema:return Xn.fromJSON(e);case l.RecordBatch:return so.fromJSON(e);case l.DictionaryBatch:return ao.fromJSON(e)}throw new Error(`Unrecognized Message type: { name: ${l[t]}, type: ${t} }`)}}(e,t),n}static decode(e){e=new io(X(e));const t=qi.getRootAsMessage(e),n=t.bodyLength(),r=t.version(),i=t.headerType(),o=new oo(n,r,i);return o._createHeader=function(e,t){return()=>{switch(t){case l.Schema:return Xn.decode(e.header(new qr));case l.RecordBatch:return so.decode(e.header(new Ei),e.version());case l.DictionaryBatch:return ao.decode(e.header(new Mi),e.version())}throw new Error(`Unrecognized Message type: { name: ${l[t]}, type: ${t} }`)}}(t,i),o}static encode(e){const t=new ro;let n=-1;return e.isSchema()?n=Xn.encode(t,e.header()):e.isRecordBatch()?n=so.encode(t,e.header()):e.isDictionaryBatch()&&(n=ao.encode(t,e.header())),qi.startMessage(t),qi.addVersion(t,r.V4),qi.addHeader(t,n),qi.addHeaderType(t,e.headerType),qi.addBodyLength(t,new no(e.bodyLength,0)),qi.finishMessageBuffer(t,qi.endMessage(t)),t.asUint8Array()}static from(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(e instanceof Xn)return new oo(0,r.V4,l.Schema,e);if(e instanceof so)return new oo(t,r.V4,l.RecordBatch,e);if(e instanceof ao)return new oo(t,r.V4,l.DictionaryBatch,e);throw new Error(`Unrecognized Message header: ${e}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===l.Schema}isRecordBatch(){return this.headerType===l.RecordBatch}isDictionaryBatch(){return this.headerType===l.DictionaryBatch}}class so{constructor(e,t,n){this._nodes=t,this._buffers=n,this._length="number"===typeof e?e:e.low}get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}}class ao{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._data=e,this._isDelta=n,this._id="number"===typeof t?t:t.low}get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}}class co{constructor(e,t){this.offset="number"===typeof e?e:e.low,this.length="number"===typeof t?t:t.low}}class lo{constructor(e,t){this.length="number"===typeof e?e:e.low,this.nullCount="number"===typeof t?t:t.low}}function uo(e,t){const n=[];for(let r,i=-1,o=-1,s=e.childrenLength();++i<s;)(r=e.children(i))&&(n[++o]=Zn.decode(r,t));return n}function ho(e){const t=new Map;if(e)for(let n,r,i=-1,o=Math.trunc(e.customMetadataLength());++i<o;)(n=e.customMetadata(i))&&null!=(r=n.key())&&t.set(r,n.value());return t}function po(e){return new Be(e.isSigned(),e.bitWidth())}function fo(e,t){const n=e.typeType();switch(n){case xr.NONE:case xr.Null:return new Ne;case xr.Binary:return new Fe;case xr.Utf8:return new Ue;case xr.Bool:return new qe;case xr.List:return new Ve((t||[])[0]);case xr.Struct_:return new We(t||[])}switch(n){case xr.Int:{const t=e.type(new Lr);return new Be(t.isSigned(),t.bitWidth())}case xr.FloatingPoint:{const t=e.type(new Ri);return new Le(t.precision())}case xr.Decimal:{const t=e.type(new Oi);return new ze(t.scale(),t.precision(),t.bitWidth())}case xr.Date:{const t=e.type(new Pi);return new He(t.unit())}case xr.Time:{const t=e.type(new xi);return new $e(t.unit(),t.bitWidth())}case xr.Timestamp:{const t=e.type(new Ni);return new je(t.unit(),t.timezone())}case xr.Interval:{const t=e.type(new Bi);return new Ke(t.unit())}case xr.Union:{const n=e.type(new Di);return new Qe(n.mode(),n.typeIdsArray()||[],t||[])}case xr.FixedSizeBinary:{const t=e.type(new Li);return new Ye(t.byteWidth())}case xr.FixedSizeList:{const n=e.type(new Fi);return new Ge(n.listSize(),(t||[])[0])}case xr.Map:{const n=e.type(new Ui);return new Je((t||[])[0],n.keysSorted())}}throw new Error(`Unrecognized type: "${xr[n]}" (${n})`)}Zn.encode=function(e,t){let n=-1,r=-1,i=-1;const o=t.type;let s=t.typeId;xe.isDictionary(o)?(s=o.dictionary.typeId,i=Qi.visit(o,e),r=Qi.visit(o.dictionary,e)):r=Qi.visit(o,e);const a=(o.children||[]).map((t=>Zn.encode(e,t))),c=Ur.createChildrenVector(e,a),l=t.metadata&&t.metadata.size>0?Ur.createCustomMetadataVector(e,[...t.metadata].map((t=>{let[n,r]=t;const i=e.createString(`${n}`),o=e.createString(`${r}`);return Dr.startKeyValue(e),Dr.addKey(e,i),Dr.addValue(e,o),Dr.endKeyValue(e)}))):-1;t.name&&(n=e.createString(t.name));Ur.startField(e),Ur.addType(e,r),Ur.addTypeType(e,s),Ur.addChildren(e,c),Ur.addNullable(e,!!t.nullable),-1!==n&&Ur.addName(e,n);-1!==i&&Ur.addDictionary(e,i);-1!==l&&Ur.addCustomMetadata(e,l);return Ur.endField(e)},Zn.decode=function(e,t){let n,r,i,o,s,a;t&&(a=e.dictionary())?t.has(n=a.id().low)?(o=(o=a.indexType())?po(o):new De,s=new et(t.get(n),o,n,a.isOrdered()),r=new Zn(e.name(),s,e.nullable(),ho(e))):(o=(o=a.indexType())?po(o):new De,t.set(n,i=fo(e,uo(e,t))),s=new et(i,o,n,a.isOrdered()),r=new Zn(e.name(),s,e.nullable(),ho(e))):(i=fo(e,uo(e,t)),r=new Zn(e.name(),i,e.nullable(),ho(e)));return r||null},Zn.fromJSON=function(e,t){let n,r,i,o,s,a;return t&&(o=e.dictionary)?t.has(n=o.id)?(r=(r=o.indexType)?eo(r):new De,a=new et(t.get(n),r,n,o.isOrdered),i=new Zn(e.name,a,e.nullable,Zi(e.customMetadata))):(r=(r=o.indexType)?eo(r):new De,t.set(n,s=to(e,Gi(e,t))),a=new et(s,r,n,o.isOrdered),i=new Zn(e.name,a,e.nullable,Zi(e.customMetadata))):(s=to(e,Gi(e,t)),i=new Zn(e.name,s,e.nullable,Zi(e.customMetadata))),i||null},Xn.encode=function(e,t){const n=t.fields.map((t=>Zn.encode(e,t)));qr.startFieldsVector(e,n.length);const r=qr.createFieldsVector(e,n),i=t.metadata&&t.metadata.size>0?qr.createCustomMetadataVector(e,[...t.metadata].map((t=>{let[n,r]=t;const i=e.createString(`${n}`),o=e.createString(`${r}`);return Dr.startKeyValue(e),Dr.addKey(e,i),Dr.addValue(e,o),Dr.endKeyValue(e)}))):-1;qr.startSchema(e),qr.addFields(e,r),qr.addEndianness(e,go?Or.Little:Or.Big),-1!==i&&qr.addCustomMetadata(e,i);return qr.endSchema(e)},Xn.decode=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map;const n=function(e,t){const n=[];for(let r,i=-1,o=-1,s=e.fieldsLength();++i<s;)(r=e.fields(i))&&(n[++o]=Zn.decode(r,t));return n}(e,t);return new Xn(n,ho(e),t)},Xn.fromJSON=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map;return new Xn(function(e,t){return(e.fields||[]).filter(Boolean).map((e=>Zn.fromJSON(e,t)))}(e,t),Zi(e.customMetadata),t)},so.encode=function(e,t){const n=t.nodes||[],r=t.buffers||[];Ei.startNodesVector(e,n.length);for(const s of n.slice().reverse())lo.encode(e,s);const i=e.endVector();Ei.startBuffersVector(e,r.length);for(const s of r.slice().reverse())co.encode(e,s);const o=e.endVector();return Ei.startRecordBatch(e),Ei.addLength(e,new no(t.length,0)),Ei.addNodes(e,i),Ei.addBuffers(e,o),Ei.endRecordBatch(e)},so.decode=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.V4;if(null!==e.compression())throw new Error("Record batch compression not implemented");return new so(e.length(),function(e){const t=[];for(let n,r=-1,i=-1,o=e.nodesLength();++r<o;)(n=e.nodes(r))&&(t[++i]=lo.decode(n));return t}(e),function(e,t){const n=[];for(let i,o=-1,s=-1,a=e.buffersLength();++o<a;)(i=e.buffers(o))&&(t<r.V4&&(i.bb_pos+=8*(o+1)),n[++s]=co.decode(i));return n}(e,t))},so.fromJSON=Yi,ao.encode=function(e,t){const n=so.encode(e,t.data);return Mi.startDictionaryBatch(e),Mi.addId(e,new no(t.id,0)),Mi.addIsDelta(e,t.isDelta),Mi.addData(e,n),Mi.endDictionaryBatch(e)},ao.decode=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.V4;return new ao(so.decode(e.data(),t),e.id(),e.isDelta())},ao.fromJSON=function(e){return new ao(Yi(e.data),e.id,e.isDelta)},lo.encode=function(e,t){return Ai.createFieldNode(e,new no(t.length,0),new no(t.nullCount,0))},lo.decode=function(e){return new lo(e.length(),e.nullCount())},co.encode=function(e,t){return ki.createBuffer(e,new no(t.offset,0),new no(t.length,0))},co.decode=function(e){return new co(e.offset(),e.length())};const go=(()=>{const e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),256===new Int16Array(e)[0]})(),mo=e=>`Expected ${l[e]} Message in stream, but was null or length 0.`,yo=e=>`Header pointer of flatbuffer-encoded ${l[e]} Message is null or length 0.`,vo=(e,t)=>`Expected to read ${e} metadata bytes, but only read ${t}.`,bo=(e,t)=>`Expected to read ${e} bytes for message body, but only read ${t}.`;class wo{constructor(e){this.source=e instanceof ri?e:new ri(e)}[Symbol.iterator](){return this}next(){let e;return(e=this.readMetadataLength()).done||-1===e.value&&(e=this.readMetadataLength()).done||(e=this.readMetadata(e.value)).done?Xr:e}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}readMessage(e){let t;if((t=this.next()).done)return null;if(null!=e&&t.value.headerType!==e)throw new Error(mo(e));return t.value}readMessageBody(e){if(e<=0)return new Uint8Array(0);const t=X(this.source.read(e));if(t.byteLength<e)throw new Error(bo(e,t.byteLength));return t.byteOffset%8===0&&t.byteOffset+t.byteLength<=t.buffer.byteLength?t:t.slice()}readSchema(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=l.Schema,n=this.readMessage(t),r=null===n||void 0===n?void 0:n.header();if(e&&!r)throw new Error(yo(t));return r}readMetadataLength(){const e=this.source.read(Io),t=e&&new Nr(e),n=(null===t||void 0===t?void 0:t.readInt32(0))||0;return{done:0===n,value:n}}readMetadata(e){const t=this.source.read(e);if(!t)return Xr;if(t.byteLength<e)throw new Error(vo(e,t.byteLength));return{done:!1,value:oo.decode(t)}}}class _o{constructor(e,t){this.source=e instanceof ii?e:O(e)?new ci(e,t):new ii(e)}[Symbol.asyncIterator](){return this}next(){return L(this,void 0,void 0,(function*(){let e;return(e=yield this.readMetadataLength()).done||-1===e.value&&(e=yield this.readMetadataLength()).done||(e=yield this.readMetadata(e.value)).done?Xr:e}))}throw(e){return L(this,void 0,void 0,(function*(){return yield this.source.throw(e)}))}return(e){return L(this,void 0,void 0,(function*(){return yield this.source.return(e)}))}readMessage(e){return L(this,void 0,void 0,(function*(){let t;if((t=yield this.next()).done)return null;if(null!=e&&t.value.headerType!==e)throw new Error(mo(e));return t.value}))}readMessageBody(e){return L(this,void 0,void 0,(function*(){if(e<=0)return new Uint8Array(0);const t=X(yield this.source.read(e));if(t.byteLength<e)throw new Error(bo(e,t.byteLength));return t.byteOffset%8===0&&t.byteOffset+t.byteLength<=t.buffer.byteLength?t:t.slice()}))}readSchema(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return L(this,void 0,void 0,(function*(){const t=l.Schema,n=yield this.readMessage(t),r=null===n||void 0===n?void 0:n.header();if(e&&!r)throw new Error(yo(t));return r}))}readMetadataLength(){return L(this,void 0,void 0,(function*(){const e=yield this.source.read(Io),t=e&&new Nr(e),n=(null===t||void 0===t?void 0:t.readInt32(0))||0;return{done:0===n,value:n}}))}readMetadata(e){return L(this,void 0,void 0,(function*(){const t=yield this.source.read(e);if(!t)return Xr;if(t.byteLength<e)throw new Error(vo(e,t.byteLength));return{done:!1,value:oo.decode(t)}}))}}class Co extends wo{constructor(e){super(new Uint8Array(0)),this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=e instanceof Zr?e:new Zr(e)}next(){const{_json:e}=this;if(!this._schema){this._schema=!0;return{done:!1,value:oo.fromJSON(e.schema,l.Schema)}}if(this._dictionaryIndex<e.dictionaries.length){const t=e.dictionaries[this._dictionaryIndex++];this._body=t.data.columns;return{done:!1,value:oo.fromJSON(t,l.DictionaryBatch)}}if(this._batchIndex<e.batches.length){const t=e.batches[this._batchIndex++];this._body=t.columns;return{done:!1,value:oo.fromJSON(t,l.RecordBatch)}}return this._body=[],Xr}readMessageBody(e){return function e(t){return(t||[]).reduce(((t,n)=>[...t,...n.VALIDITY&&[n.VALIDITY]||[],...n.TYPE&&[n.TYPE]||[],...n.OFFSET&&[n.OFFSET]||[],...n.DATA&&[n.DATA]||[],...e(n.children)]),[])}(this._body)}readMessage(e){let t;if((t=this.next()).done)return null;if(null!=e&&t.value.headerType!==e)throw new Error(mo(e));return t.value}readSchema(){const e=l.Schema,t=this.readMessage(e),n=null===t||void 0===t?void 0:t.header();if(!t||!n)throw new Error(yo(e));return n}}const Io=4,To="ARROW1",So=new Uint8Array(6);for(let vm=0;vm<6;vm+=1)So[vm]=To.codePointAt(vm);function ko(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=-1,r=So.length;++n<r;)if(So[n]!==e[t+n])return!1;return!0}const Ao=So.length,Eo=Ao+Io,Mo=2*Ao+Io;class Ro extends ei{constructor(e){super(),this._impl=e}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(e){return this._impl.throw(e)}return(e){return this._impl.return(e)}cancel(){return this._impl.cancel()}reset(e){return this._impl.reset(e),this._DOMStream=void 0,this._nodeStream=void 0,this}open(e){const t=this._impl.open(e);return k(t)?t.then((()=>this)):this}readRecordBatch(e){return this._impl.isFile()?this._impl.readRecordBatch(e):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return Qr.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return Qr.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(e){throw new Error('"throughNode" not available in this environment')}static throughDOM(e,t){throw new Error('"throughDOM" not available in this environment')}static from(e){return e instanceof Ro?e:M(e)?function(e){return new Oo(new qo(e))}(e):O(e)?function(e){return L(this,void 0,void 0,(function*(){const{size:t}=yield e.stat(),n=new ci(e,t);return t>=Mo&&ko(yield n.readAt(0,Ao+7&-8))?new No(new Uo(n)):new Po(new Lo(n))}))}(e):k(e)?(()=>L(this,void 0,void 0,(function*(){return yield Ro.from(yield e)})))():P(e)||N(e)||B(e)||E(e)?function(e){return L(this,void 0,void 0,(function*(){const t=yield e.peek(Ao+7&-8);return t&&t.byteLength>=4?ko(t)?new xo(new Fo(yield e.read())):new Po(new Lo(e)):new Po(new Lo(function(){return q(this,arguments,(function*(){}))}()))}))}(new ii(e)):function(e){const t=e.peek(Ao+7&-8);return t&&t.byteLength>=4?ko(t)?new xo(new Fo(e.read())):new Oo(new Do(e)):new Oo(new Do(function*(){}()))}(new ri(e))}static readAll(e){return e instanceof Ro?e.isSync()?Ho(e):$o(e):M(e)||ArrayBuffer.isView(e)||A(e)||R(e)?Ho(e):$o(e)}}class Oo extends Ro{constructor(e){super(e),this._impl=e}readAll(){return[...this]}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return q(this,arguments,(function*(){yield U(yield*z(H(this[Symbol.iterator]())))}))}}class Po extends Ro{constructor(e){super(e),this._impl=e}readAll(){var e,t;return L(this,void 0,void 0,(function*(){const n=new Array;try{for(var r,i=H(this);!(r=yield i.next()).done;){const e=r.value;n.push(e)}}catch(o){e={error:o}}finally{try{r&&!r.done&&(t=i.return)&&(yield t.call(i))}finally{if(e)throw e.error}}return n}))}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}}class xo extends Oo{constructor(e){super(e),this._impl=e}}class No extends Po{constructor(e){super(e),this._impl=e}}class Bo{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Map;this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=e}get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(e){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=e,this.dictionaries=new Map,this}_loadRecordBatch(e,t){const n=this._loadVectors(e,t,this.schema.fields),r=Jn({type:new We(this.schema.fields),length:e.length,children:n});return new mr(this.schema,r)}_loadDictionaryBatch(e,t){const{id:n,isDelta:r}=e,{dictionaries:i,schema:o}=this,s=i.get(n);if(r||!s){const i=o.dictionaries.get(n),a=this._loadVectors(e.data,t,[i]);return(s&&r?s.concat(new Wn(a)):new Wn(a)).memoize()}return s.memoize()}_loadVectors(e,t,n){return new gi(t,e.nodes,e.buffers,this.dictionaries).visitMany(n)}}class Do extends Bo{constructor(e,t){super(t),this._reader=M(e)?new Co(this._handle=e):new wo(this._handle=e)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(e){return this.closed||(this.autoDestroy=zo(this,e),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(e){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(e):Xr}return(e){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(e):Xr}next(){if(this.closed)return Xr;let e;const{_reader:t}=this;for(;e=this._readNextMessageAndValidate();)if(e.isSchema())this.reset(e.header());else{if(e.isRecordBatch()){this._recordBatchIndex++;const n=e.header(),r=t.readMessageBody(e.bodyLength);return{done:!1,value:this._loadRecordBatch(n,r)}}if(e.isDictionaryBatch()){this._dictionaryIndex++;const n=e.header(),r=t.readMessageBody(e.bodyLength),i=this._loadDictionaryBatch(n,r);this.dictionaries.set(n.id,i)}}return this.schema&&0===this._recordBatchIndex?(this._recordBatchIndex++,{done:!1,value:new br(this.schema)}):this.return()}_readNextMessageAndValidate(e){return this._reader.readMessage(e)}}class Lo extends Bo{constructor(e,t){super(t),this._reader=new _o(this._handle=e)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){return L(this,void 0,void 0,(function*(){!this.closed&&(this.closed=!0)&&(yield this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}))}open(e){return L(this,void 0,void 0,(function*(){return this.closed||(this.autoDestroy=zo(this,e),this.schema||(this.schema=yield this._reader.readSchema())||(yield this.cancel())),this}))}throw(e){return L(this,void 0,void 0,(function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.throw(e):Xr}))}return(e){return L(this,void 0,void 0,(function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.return(e):Xr}))}next(){return L(this,void 0,void 0,(function*(){if(this.closed)return Xr;let e;const{_reader:t}=this;for(;e=yield this._readNextMessageAndValidate();)if(e.isSchema())yield this.reset(e.header());else{if(e.isRecordBatch()){this._recordBatchIndex++;const n=e.header(),r=yield t.readMessageBody(e.bodyLength);return{done:!1,value:this._loadRecordBatch(n,r)}}if(e.isDictionaryBatch()){this._dictionaryIndex++;const n=e.header(),r=yield t.readMessageBody(e.bodyLength),i=this._loadDictionaryBatch(n,r);this.dictionaries.set(n.id,i)}}return this.schema&&0===this._recordBatchIndex?(this._recordBatchIndex++,{done:!1,value:new br(this.schema)}):yield this.return()}))}_readNextMessageAndValidate(e){return L(this,void 0,void 0,(function*(){return yield this._reader.readMessage(e)}))}}class Fo extends Do{constructor(e,t){super(e instanceof ai?e:new ai(e),t)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isSync(){return!0}isFile(){return!0}open(e){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(const e of this._footer.dictionaryBatches())e&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(e)}readRecordBatch(e){var t;if(this.closed)return null;this._footer||this.open();const n=null===(t=this._footer)||void 0===t?void 0:t.getRecordBatch(e);if(n&&this._handle.seek(n.offset)){const e=this._reader.readMessage(l.RecordBatch);if(null===e||void 0===e?void 0:e.isRecordBatch()){const t=e.header(),n=this._reader.readMessageBody(e.bodyLength);return this._loadRecordBatch(t,n)}}return null}_readDictionaryBatch(e){var t;const n=null===(t=this._footer)||void 0===t?void 0:t.getDictionaryBatch(e);if(n&&this._handle.seek(n.offset)){const e=this._reader.readMessage(l.DictionaryBatch);if(null===e||void 0===e?void 0:e.isDictionaryBatch()){const t=e.header(),n=this._reader.readMessageBody(e.bodyLength),r=this._loadDictionaryBatch(t,n);this.dictionaries.set(t.id,r)}}}_readFooter(){const{_handle:e}=this,t=e.size-Eo,n=e.readInt32(t),r=e.readAt(t-n,n);return Kr.decode(r)}_readNextMessageAndValidate(e){var t;if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){const n=null===(t=this._footer)||void 0===t?void 0:t.getRecordBatch(this._recordBatchIndex);if(n&&this._handle.seek(n.offset))return this._reader.readMessage(e)}return null}}class Uo extends Lo{constructor(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i="number"!==typeof n[0]?n.shift():void 0,o=n[0]instanceof Map?n.shift():void 0;super(e instanceof ci?e:new ci(e,i),o)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isFile(){return!0}isAsync(){return!0}open(e){const t=Object.create(null,{open:{get:()=>super.open}});return L(this,void 0,void 0,(function*(){if(!this.closed&&!this._footer){this.schema=(this._footer=yield this._readFooter()).schema;for(const e of this._footer.dictionaryBatches())e&&(yield this._readDictionaryBatch(this._dictionaryIndex++))}return yield t.open.call(this,e)}))}readRecordBatch(e){var t;return L(this,void 0,void 0,(function*(){if(this.closed)return null;this._footer||(yield this.open());const n=null===(t=this._footer)||void 0===t?void 0:t.getRecordBatch(e);if(n&&(yield this._handle.seek(n.offset))){const e=yield this._reader.readMessage(l.RecordBatch);if(null===e||void 0===e?void 0:e.isRecordBatch()){const t=e.header(),n=yield this._reader.readMessageBody(e.bodyLength);return this._loadRecordBatch(t,n)}}return null}))}_readDictionaryBatch(e){var t;return L(this,void 0,void 0,(function*(){const n=null===(t=this._footer)||void 0===t?void 0:t.getDictionaryBatch(e);if(n&&(yield this._handle.seek(n.offset))){const e=yield this._reader.readMessage(l.DictionaryBatch);if(null===e||void 0===e?void 0:e.isDictionaryBatch()){const t=e.header(),n=yield this._reader.readMessageBody(e.bodyLength),r=this._loadDictionaryBatch(t,n);this.dictionaries.set(t.id,r)}}}))}_readFooter(){return L(this,void 0,void 0,(function*(){const{_handle:e}=this;e._pending&&(yield e._pending);const t=e.size-Eo,n=yield e.readInt32(t),r=yield e.readAt(t-n,n);return Kr.decode(r)}))}_readNextMessageAndValidate(e){return L(this,void 0,void 0,(function*(){if(this._footer||(yield this.open()),this._footer&&this._recordBatchIndex<this.numRecordBatches){const t=this._footer.getRecordBatch(this._recordBatchIndex);if(t&&(yield this._handle.seek(t.offset)))return yield this._reader.readMessage(e)}return null}))}}class qo extends Do{constructor(e,t){super(e,t)}_loadVectors(e,t,n){return new mi(t,e.nodes,e.buffers,this.dictionaries).visitMany(n)}}function zo(e,t){return t&&"boolean"===typeof t.autoDestroy?t.autoDestroy:e.autoDestroy}function*Ho(e){const t=Ro.from(e);try{if(!t.open({autoDestroy:!1}).closed)do{yield t}while(!t.reset().open().closed)}finally{t.cancel()}}function $o(e){return q(this,arguments,(function*(){const t=yield U(Ro.from(e));try{if(!(yield U(t.open({autoDestroy:!1}))).closed)do{yield yield U(t)}while(!(yield U(t.reset().open())).closed)}finally{yield U(t.cancel())}}))}class jo extends nt{constructor(){super(),this._byteLength=0,this._nodes=[],this._buffers=[],this._bufferRegions=[]}static assemble(){const e=t=>t.flatMap((t=>Array.isArray(t)?e(t):t instanceof mr?t.data.children:t.data)),t=new jo;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t.visitMany(e(r)),t}visit(e){if(e instanceof Wn)return this.visitMany(e.data),this;const{type:t}=e;if(!xe.isDictionary(t)){const{length:n,nullCount:r}=e;if(n>2147483647)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");xe.isNull(t)||Ko.call(this,r<=0?new Uint8Array(0):kn(e.offset,n,e.nullBitmap)),this.nodes.push(new lo(n,r))}return super.visit(e)}visitNull(e){return this}visitDictionary(e){return this.visit(e.clone(e.type.indices))}get nodes(){return this._nodes}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get bufferRegions(){return this._bufferRegions}}function Ko(e){const t=e.byteLength+7&-8;return this.buffers.push(e),this.bufferRegions.push(new co(this._byteLength,t)),this._byteLength+=t,this}function Vo(e){return Ko.call(this,e.values.subarray(0,e.length*e.stride))}function Wo(e){const{length:t,values:n,valueOffsets:r}=e,i=r[0],o=r[t],s=Math.min(o-i,n.byteLength-i);return Ko.call(this,ne(-r[0],t,r)),Ko.call(this,n.subarray(i,i+s)),this}function Qo(e){const{length:t,valueOffsets:n}=e;return n&&Ko.call(this,ne(n[0],t,n)),this.visit(e.children[0])}function Yo(e){return this.visitMany(e.type.children.map(((t,n)=>e.children[n])).filter(Boolean))[0]}jo.prototype.visitBool=function(e){let t;return e.nullCount>=e.length?Ko.call(this,new Uint8Array(0)):(t=e.values)instanceof Uint8Array?Ko.call(this,kn(e.offset,e.length,t)):Ko.call(this,An(e.values))},jo.prototype.visitInt=Vo,jo.prototype.visitFloat=Vo,jo.prototype.visitUtf8=Wo,jo.prototype.visitBinary=Wo,jo.prototype.visitFixedSizeBinary=Vo,jo.prototype.visitDate=Vo,jo.prototype.visitTimestamp=Vo,jo.prototype.visitTime=Vo,jo.prototype.visitDecimal=Vo,jo.prototype.visitList=Qo,jo.prototype.visitStruct=Yo,jo.prototype.visitUnion=function(e){const{type:t,length:n,typeIds:r,valueOffsets:o}=e;if(Ko.call(this,r),t.mode===i.Sparse)return Yo.call(this,e);if(t.mode===i.Dense){if(e.offset<=0)return Ko.call(this,o),Yo.call(this,e);{const i=r.reduce(((e,t)=>Math.max(e,t)),r[0]),s=new Int32Array(i+1),a=new Int32Array(i+1).fill(-1),c=new Int32Array(n),l=ne(-o[0],n,o);for(let e,t,o=-1;++o<n;)-1===(t=a[e=r[o]])&&(t=a[e]=l[e]),c[o]=l[o]-t,++s[e];Ko.call(this,c);for(let r,o=-1,u=t.children.length;++o<u;)if(r=e.children[o]){const e=t.typeIds[o],i=Math.min(n,s[e]);this.visit(r.slice(a[e],i))}}}return this},jo.prototype.visitInterval=Vo,jo.prototype.visitFixedSizeList=Qo,jo.prototype.visitMap=Qo;class Go extends ei{constructor(e){super(),this._position=0,this._started=!1,this._sink=new ni,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,S(e)||(e={autoDestroy:!0,writeLegacyIpcFormat:!1}),this._autoDestroy="boolean"!==typeof e.autoDestroy||e.autoDestroy,this._writeLegacyIpcFormat="boolean"===typeof e.writeLegacyIpcFormat&&e.writeLegacyIpcFormat}static throughNode(e){throw new Error('"throughNode" not available in this environment')}static throughDOM(e,t){throw new Error('"throughDOM" not available in this environment')}toString(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._sink.toString(e)}toUint8Array(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._sink.toUint8Array(e)}writeAll(e){return k(e)?e.then((e=>this.writeAll(e))):E(e)?es(this,e):Zo(this,e)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream(e){return this._sink.toDOMStream(e)}toNodeStream(e){return this._sink.toNodeStream(e)}close(){return this.reset()._sink.close()}abort(e){return this.reset()._sink.abort(e)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._sink,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;var n;return e===this._sink||e instanceof ni?this._sink=e:(this._sink=new ni,e&&(S(n=e)&&T(n.abort)&&T(n.getWriter)&&!x(n))?this.toDOMStream({type:"bytes"}).pipeTo(e):e&&(e=>S(e)&&T(e.end)&&T(e.write)&&I(e.writable)&&!x(e))(e)&&this.toNodeStream({objectMode:!1}).pipe(e)),this._started&&this._schema&&this._writeFooter(this._schema),this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,t&&pr(t,this._schema)||(null==t?(this._position=0,this._schema=null):(this._started=!0,this._schema=t,this._writeSchema(t))),this}write(e){let t=null;if(!this._sink)throw new Error("RecordBatchWriter is closed");if(null==e)return this.finish()&&void 0;if(e instanceof Cr&&!(t=e.schema))return this.finish()&&void 0;if(e instanceof mr&&!(t=e.schema))return this.finish()&&void 0;if(t&&!pr(t,this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,t)}e instanceof mr?e instanceof br||this._writeRecordBatch(e):e instanceof Cr?this.writeAll(e.batches):A(e)&&this.writeAll(e)}_writeMessage(e){const t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:8)-1,n=oo.encode(e),r=n.byteLength,i=this._writeLegacyIpcFormat?4:8,o=r+i+t&~t,s=o-r-i;return e.headerType===l.RecordBatch?this._recordBatchBlocks.push(new Wr(o,e.bodyLength,this._position)):e.headerType===l.DictionaryBatch&&this._dictionaryBlocks.push(new Wr(o,e.bodyLength,this._position)),this._writeLegacyIpcFormat||this._write(Int32Array.of(-1)),this._write(Int32Array.of(o-i)),r>0&&this._write(n),this._writePadding(s)}_write(e){if(this._started){const t=X(e);t&&t.byteLength>0&&(this._sink.write(t),this._position+=t.byteLength)}return this}_writeSchema(e){return this._writeMessage(oo.from(e))}_writeFooter(e){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write(So)}_writePadding(e){return e>0?this._write(new Uint8Array(e)):this}_writeRecordBatch(e){const{byteLength:t,nodes:n,bufferRegions:r,buffers:i}=jo.assemble(e),o=new so(e.numRows,n,r),s=oo.from(o,t);return this._writeDictionaries(e)._writeMessage(s)._writeBodyBuffers(i)}_writeDictionaryBatch(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._dictionaryDeltaOffsets.set(t,e.length+(this._dictionaryDeltaOffsets.get(t)||0));const{byteLength:r,nodes:i,bufferRegions:o,buffers:s}=jo.assemble(new Wn([e])),a=new so(e.length,i,o),c=new ao(a,t,n),l=oo.from(c,r);return this._writeMessage(l)._writeBodyBuffers(s)}_writeBodyBuffers(e){let t,n,r;for(let i=-1,o=e.length;++i<o;)(t=e[i])&&(n=t.byteLength)>0&&(this._write(t),(r=(n+7&-8)-n)>0&&this._writePadding(r));return this}_writeDictionaries(e){for(let[t,n]of e.dictionaries){let e=this._dictionaryDeltaOffsets.get(t)||0;if(0===e||(n=null===n||void 0===n?void 0:n.slice(e)).length>0)for(const r of n.data)this._writeDictionaryBatch(r,t,e>0),e+=r.length}return this}}class Jo extends Go{static writeAll(e,t){const n=new Jo(t);return k(e)?e.then((e=>n.writeAll(e))):E(e)?es(n,e):Zo(n,e)}}class Xo extends Go{static writeAll(e){const t=new Xo;return k(e)?e.then((e=>t.writeAll(e))):E(e)?es(t,e):Zo(t,e)}constructor(){super(),this._autoDestroy=!0}_writeSchema(e){return this._writeMagic()._writePadding(2)}_writeFooter(e){const t=Kr.encode(new Kr(e,r.V4,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter(e)._write(t)._write(Int32Array.of(t.byteLength))._writeMagic()}}function Zo(e,t){let n=t;t instanceof Cr&&(n=t.batches,e.reset(void 0,t.schema));for(const r of n)e.write(r);return e.finish()}function es(e,t){var n,r,i,o;return L(this,void 0,void 0,(function*(){try{for(n=H(t);!(r=yield n.next()).done;){const t=r.value;e.write(t)}}catch(s){i={error:s}}finally{try{r&&!r.done&&(o=n.return)&&(yield o.call(n))}finally{if(i)throw i.error}}return e.finish()}))}function ts(e){const t=Ro.from(e);return k(t)?t.then((e=>ts(e))):t.isAsync()?t.readAll().then((e=>new Cr(e))):new Cr(t.readAll())}function ns(e){return("stream"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"stream")?Jo:Xo).writeAll(e).toUint8Array(!0)}var rs,is=function(){function e(e,t,n,r){var i=this;this.getCell=function(e,t){var n=e<i.headerRows&&t<i.headerColumns,r=e>=i.headerRows&&t<i.headerColumns,o=e<i.headerRows&&t>=i.headerColumns;if(n){var s=["blank"];return t>0&&s.push("level"+e),{type:"blank",classNames:s.join(" "),content:""}}if(o)return{type:"columns",classNames:(s=["col_heading","level"+e,"col"+(c=t-i.headerColumns)]).join(" "),content:i.getContent(i.columnsTable,c,e)};if(r){s=["row_heading","level"+t,"row"+(a=e-i.headerRows)];return{type:"index",id:"T_".concat(i.uuid,"level").concat(t,"_row").concat(a),classNames:s.join(" "),content:i.getContent(i.indexTable,a,t)}}s=["data","row"+(a=e-i.headerRows),"col"+(c=t-i.headerColumns)];var a,c,l=i.styler?i.getContent(i.styler.displayValuesTable,a,c):i.getContent(i.dataTable,a,c);return{type:"data",id:"T_".concat(i.uuid,"row").concat(a,"_col").concat(c),classNames:s.join(" "),content:l}},this.getContent=function(e,t,n){var r=e.getChildAt(n);return null===r?"":i.getColumnTypeId(e,n)===u.Timestamp?i.nanosToDate(r.get(t)):r.get(t)},this.dataTable=ts(e),this.indexTable=ts(t),this.columnsTable=ts(n),this.styler=r?{caption:r.caption,displayValuesTable:ts(r.displayValues),styles:r.styles,uuid:r.uuid}:void 0}return Object.defineProperty(e.prototype,"rows",{get:function(){return this.indexTable.numRows+this.columnsTable.numCols},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columns",{get:function(){return this.indexTable.numCols+this.columnsTable.numRows},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"headerRows",{get:function(){return this.rows-this.dataRows},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"headerColumns",{get:function(){return this.columns-this.dataColumns},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataRows",{get:function(){return this.dataTable.numRows},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataColumns",{get:function(){return this.dataTable.numCols},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uuid",{get:function(){return this.styler&&this.styler.uuid},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"caption",{get:function(){return this.styler&&this.styler.caption},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"styles",{get:function(){return this.styler&&this.styler.styles},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"table",{get:function(){return this.dataTable},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this.indexTable},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnTable",{get:function(){return this.columnsTable},enumerable:!1,configurable:!0}),e.prototype.serialize=function(){return{data:ns(this.dataTable),index:ns(this.indexTable),columns:ns(this.columnsTable)}},e.prototype.getColumnTypeId=function(e,t){return e.schema.fields[t].type.typeId},e.prototype.nanosToDate=function(e){return new Date(e/1e6)},e}(),os=function(){return os=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},os.apply(this,arguments)};!function(e){e.COMPONENT_READY="streamlit:componentReady",e.SET_COMPONENT_VALUE="streamlit:setComponentValue",e.SET_FRAME_HEIGHT="streamlit:setFrameHeight"}(rs||(rs={}));var ss=function(){function e(){}return e.API_VERSION=1,e.RENDER_EVENT="streamlit:render",e.events=new EventTarget,e.registeredMessageListener=!1,e.setComponentReady=function(){e.registeredMessageListener||(window.addEventListener("message",e.onMessageEvent),e.registeredMessageListener=!0),e.sendBackMsg(rs.COMPONENT_READY,{apiVersion:e.API_VERSION})},e.setFrameHeight=function(t){void 0===t&&(t=document.body.scrollHeight),t!==e.lastFrameHeight&&(e.lastFrameHeight=t,e.sendBackMsg(rs.SET_FRAME_HEIGHT,{height:t}))},e.setComponentValue=function(t){var n;t instanceof is?(n="dataframe",t=t.serialize()):!function(e){var t=!1;try{t=e instanceof BigInt64Array||e instanceof BigUint64Array}catch(n){}return e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array||t}(t)?t instanceof ArrayBuffer?(n="bytes",t=new Uint8Array(t)):n="json":(n="bytes",t=new Uint8Array(t.buffer)),e.sendBackMsg(rs.SET_COMPONENT_VALUE,{value:t,dataType:n})},e.onMessageEvent=function(t){if(t.data.type===e.RENDER_EVENT)e.onRenderMessage(t.data)},e.onRenderMessage=function(t){var n=t.args;null==n&&(console.error("Got null args in onRenderMessage. This should never happen"),n={});var r=t.dfs&&t.dfs.length>0?e.argsDataframeToObject(t.dfs):{};n=os(os({},n),r);var i=Boolean(t.disabled),o=t.theme;o&&as(o);var s={disabled:i,args:n,theme:o},a=new CustomEvent(e.RENDER_EVENT,{detail:s});e.events.dispatchEvent(a)},e.argsDataframeToObject=function(t){var n=t.map((function(t){var n=t.key,r=t.value;return[n,e.toArrowTable(r)]}));return Object.fromEntries(n)},e.toArrowTable=function(e){var t,n=(t=e.data).data,r=t.index,i=t.columns,o=t.styler;return new is(n,r,i,o)},e.sendBackMsg=function(e,t){window.parent.postMessage(os({isStreamlitMessage:!0,type:e},t),"*")},e}(),as=function(e){var t=document.createElement("style");document.head.appendChild(t),t.innerHTML="\n    :root {\n      --primary-color: ".concat(e.primaryColor,";\n      --background-color: ").concat(e.backgroundColor,";\n      --secondary-background-color: ").concat(e.secondaryBackgroundColor,";\n      --text-color: ").concat(e.textColor,";\n      --font: ").concat(e.font,";\n    }\n\n    body {\n      background-color: var(--background-color);\n      color: var(--text-color);\n    }\n  ")};var cs=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ls=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return cs(t,e),t.prototype.componentDidMount=function(){ss.setFrameHeight()},t.prototype.componentDidUpdate=function(){ss.setFrameHeight()},t}(h.PureComponent);const us={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},ds=400,hs=499,ps=500,fs=599,gs=[us.OPENID_SCOPE,us.PROFILE_SCOPE,us.OFFLINE_ACCESS_SCOPE],ms=[...gs,us.EMAIL_SCOPE],ys="Content-Type",vs="Retry-After",bs="X-AnchorMailbox",ws="x-ms-request-id",_s="x-ms-httpver",Cs="idtoken",Is="client.info",Ts="adal.idtoken",Ss="error",ks="error.description",As="active-account",Es="active-account-filters",Ms="common",Rs="organizations",Os="consumers",Ps="access_token",xs="xms_cc",Ns={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},Bs={PLAIN:"plain",S256:"S256"},Ds={QUERY:"query",FRAGMENT:"fragment"},Ls={...Ds,FORM_POST:"form_post"},Fs="authorization_code",Us="refresh_token",qs="MSSTS",zs="ADFS",Hs="Generic",$s="-",js=".",Ks={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},Vs="appmetadata",Ws="1",Qs="authority-metadata",Ys=86400,Gs="config",Js="cache",Xs="network",Zs="hardcoded_values",ea={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},ta={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},na=60,ra=3600,ia="throttling",oa="retry-after, h429",sa="invalid_grant",aa="client_mismatch",ca="username",la="password",ua=200,da=400,ha="1",pa="3",fa="4",ga="2",ma="4",ya="5",va="0",ba="1",wa="2",_a="3",Ca="4",Ia="pop";var Ta;!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(Ta||(Ta={}));class Sa{constructor(e,t,n){this.level=Ta.Info;const r=e||Sa.createDefaultLoggerOptions();this.localCallback=r.loggerCallback||(()=>{}),this.piiLoggingEnabled=r.piiLoggingEnabled||!1,this.level="number"===typeof r.logLevel?r.logLevel:Ta.Info,this.correlationId=r.correlationId||us.EMPTY_STRING,this.packageName=t||us.EMPTY_STRING,this.packageVersion=n||us.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Ta.Info}}clone(e,t,n){return new Sa({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;const n=`${`[${(new Date).toUTCString()}] : [${t.correlationId||this.correlationId||""}]`} : ${this.packageName}@${this.packageVersion} : ${Ta[t.logLevel]} - ${e}`;this.executeCallback(t.logLevel,n,t.containsPii||!1)}executeCallback(e,t,n){this.localCallback&&this.localCallback(e,t,n)}error(e,t){this.logMessage(e,{logLevel:Ta.Error,containsPii:!1,correlationId:t||us.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:Ta.Error,containsPii:!0,correlationId:t||us.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:Ta.Warning,containsPii:!1,correlationId:t||us.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:Ta.Warning,containsPii:!0,correlationId:t||us.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:Ta.Info,containsPii:!1,correlationId:t||us.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:Ta.Info,containsPii:!0,correlationId:t||us.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:Ta.Verbose,containsPii:!1,correlationId:t||us.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:Ta.Verbose,containsPii:!0,correlationId:t||us.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:Ta.Trace,containsPii:!1,correlationId:t||us.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:Ta.Trace,containsPii:!0,correlationId:t||us.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}const ka="AAD",Aa="OIDC",Ea="none",Ma="unexpected_error",Ra="post_request_failed",Oa={[Ma]:"Unexpected error in authentication.",[Ra]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};class Pa extends Error{constructor(e,t,n){super(t?`${e}: ${t}`:e),Object.setPrototypeOf(this,Pa.prototype),this.errorCode=e||us.EMPTY_STRING,this.errorMessage=t||us.EMPTY_STRING,this.subError=n||us.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function xa(e,t){return new Pa(e,t?`${Oa[e]} ${t}`:Oa[e])}const Na="client_info_decoding_error",Ba="client_info_empty_error",Da="token_parsing_error",La="null_or_empty_token",Fa="endpoints_resolution_error",Ua="network_error",qa="openid_config_error",za="hash_not_deserialized",Ha="invalid_state",$a="state_mismatch",ja="state_not_found",Ka="nonce_mismatch",Va="auth_time_not_found",Wa="max_age_transpired",Qa="multiple_matching_tokens",Ya="multiple_matching_accounts",Ga="multiple_matching_appMetadata",Ja="request_cannot_be_made",Xa="cannot_remove_empty_scope",Za="cannot_append_scopeset",ec="empty_input_scopeset",tc="device_code_polling_cancelled",nc="device_code_expired",rc="device_code_unknown_error",ic="no_account_in_silent_request",oc="invalid_cache_record",sc="invalid_cache_environment",ac="no_account_found",cc="no_crypto_object",lc="unexpected_credential_type",uc="invalid_assertion",dc="invalid_client_credential",hc="token_refresh_required",pc="user_timeout_reached",fc="token_claims_cnf_required_for_signedjwt",gc="authorization_code_missing_from_server_response",mc="binding_key_not_removed",yc="end_session_endpoint_not_supported",vc="key_id_missing",bc="no_network_connectivity",wc="user_canceled",_c="missing_tenant_id_error",Cc="method_not_implemented",Ic="nested_app_auth_bridge_disabled",Tc={[Na]:"The client info could not be parsed/decoded correctly",[Ba]:"The client info was empty",[Da]:"Token cannot be parsed",[La]:"The token is null or empty",[Fa]:"Endpoints cannot be resolved",[Ua]:"Network request failed",[qa]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[za]:"The hash parameters could not be deserialized",[Ha]:"State was not the expected format",[$a]:"State mismatch error",[ja]:"State not found",[Ka]:"Nonce mismatch error",[Va]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[Wa]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[Qa]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[Ya]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[Ga]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[Ja]:"Token request cannot be made without authorization code or refresh token.",[Xa]:"Cannot remove null or empty scope from ScopeSet",[Za]:"Cannot append ScopeSet",[ec]:"Empty input ScopeSet cannot be processed",[tc]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[nc]:"Device code is expired.",[rc]:"Device code stopped polling for unknown reasons.",[ic]:"Please pass an account object, silent flow is not supported without account information",[oc]:"Cache record object was null or undefined.",[sc]:"Invalid environment when attempting to create cache entry",[ac]:"No account found in cache for given key.",[cc]:"No crypto object detected.",[lc]:"Unexpected credential type.",[uc]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[dc]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[hc]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[pc]:"User defined timeout for device code polling reached",[fc]:"Cannot generate a POP jwt if the token_claims are not populated",[gc]:"Server response does not contain an authorization code to proceed",[mc]:"Could not remove the credential's binding key from storage.",[yc]:"The provided authority does not support logout",[vc]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[bc]:"No network connectivity. Check your internet connection.",[wc]:"User cancelled the flow.",[_c]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[Cc]:"This method has not been implemented",[Ic]:"The nested app auth bridge is disabled"};class Sc extends Pa{constructor(e,t){super(e,t?`${Tc[e]}: ${t}`:Tc[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,Sc.prototype)}}function kc(e,t){return new Sc(e,t)}const Ac={createNewGuid:()=>{throw kc(Cc)},base64Decode:()=>{throw kc(Cc)},base64Encode:()=>{throw kc(Cc)},base64UrlEncode:()=>{throw kc(Cc)},encodeKid:()=>{throw kc(Cc)},async getPublicKeyThumbprint(){throw kc(Cc)},async removeTokenBindingKey(){throw kc(Cc)},async clearKeystore(){throw kc(Cc)},async signJwt(){throw kc(Cc)},async hashString(){throw kc(Cc)}},Ec="@azure/msal-common",Mc="14.15.0";function Rc(e,t){const n=function(e){if(!e)throw kc(La);const t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw kc(Da);return t[2]}(e);try{const e=t(n);return JSON.parse(e)}catch(r){throw kc(Da)}}function Oc(e,t){if(0===t||Date.now()-3e5>e+t)throw kc(Wa)}function Pc(){return Math.round((new Date).getTime()/1e3)}function xc(e,t){const n=Number(e)||0;return Pc()+t>n}function Nc(e){return[Hc(e),$c(e),jc(e),Kc(e),Vc(e)].join($s).toLowerCase()}function Bc(e,t,n,r,i){return{credentialType:Ks.ID_TOKEN,homeAccountId:e,environment:t,clientId:r,secret:n,realm:i}}function Dc(e,t,n,r,i,o,s,a,c,l,u,d,h,p,f){const g={homeAccountId:e,credentialType:Ks.ACCESS_TOKEN,secret:n,cachedAt:Pc().toString(),expiresOn:s.toString(),extendedExpiresOn:a.toString(),environment:t,clientId:r,realm:i,target:o,tokenType:u||ta.BEARER};if(d&&(g.userAssertionHash=d),l&&(g.refreshOn=l.toString()),p&&(g.requestedClaims=p,g.requestedClaimsHash=f),g.tokenType?.toLowerCase()!==ta.BEARER.toLowerCase())switch(g.credentialType=Ks.ACCESS_TOKEN_WITH_AUTH_SCHEME,g.tokenType){case ta.POP:const e=Rc(n,c);if(!e?.cnf?.kid)throw kc(fc);g.keyId=e.cnf.kid;break;case ta.SSH:g.keyId=h}return g}function Lc(e,t,n,r,i,o,s){const a={credentialType:Ks.REFRESH_TOKEN,homeAccountId:e,environment:t,clientId:r,secret:n};return o&&(a.userAssertionHash=o),i&&(a.familyId=i),s&&(a.expiresOn=s.toString()),a}function Fc(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")}function Uc(e){return!!e&&(Fc(e)&&e.hasOwnProperty("realm")&&e.hasOwnProperty("target")&&(e.credentialType===Ks.ACCESS_TOKEN||e.credentialType===Ks.ACCESS_TOKEN_WITH_AUTH_SCHEME))}function qc(e){return!!e&&(Fc(e)&&e.hasOwnProperty("realm")&&e.credentialType===Ks.ID_TOKEN)}function zc(e){return!!e&&(Fc(e)&&e.credentialType===Ks.REFRESH_TOKEN)}function Hc(e){return[e.homeAccountId,e.environment].join($s).toLowerCase()}function $c(e){const t=e.credentialType===Ks.REFRESH_TOKEN&&e.familyId||e.clientId;return[e.credentialType,t,e.realm||""].join($s).toLowerCase()}function jc(e){return(e.target||"").toLowerCase()}function Kc(e){return(e.requestedClaimsHash||"").toLowerCase()}function Vc(e){return e.tokenType&&e.tokenType.toLowerCase()!==ta.BEARER.toLowerCase()?e.tokenType.toLowerCase():""}function Wc(){return Pc()+Ys}function Qc(e,t,n){e.authorization_endpoint=t.authorization_endpoint,e.token_endpoint=t.token_endpoint,e.end_session_endpoint=t.end_session_endpoint,e.issuer=t.issuer,e.endpointsFromNetwork=n,e.jwks_uri=t.jwks_uri}function Yc(e,t,n){e.aliases=t.aliases,e.preferred_cache=t.preferred_cache,e.preferred_network=t.preferred_network,e.aliasesFromNetwork=n}function Gc(e){return e.expiresAt<=Pc()}const Jc="redirect_uri_empty",Xc="claims_request_parsing_error",Zc="authority_uri_insecure",el="url_parse_error",tl="empty_url_error",nl="empty_input_scopes_error",rl="invalid_prompt_value",il="invalid_claims",ol="token_request_empty",sl="logout_request_empty",al="invalid_code_challenge_method",cl="pkce_params_missing",ll="invalid_cloud_discovery_metadata",ul="invalid_authority_metadata",dl="untrusted_authority",hl="missing_ssh_jwk",pl="missing_ssh_kid",fl="missing_nonce_authentication_header",gl="invalid_authentication_header",ml="cannot_set_OIDCOptions",yl="cannot_allow_native_broker",vl="authority_mismatch",bl={[Jc]:"A redirect URI is required for all calls, and none has been set.",[Xc]:"Could not parse the given claims request object.",[Zc]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[el]:"URL could not be parsed into appropriate segments.",[tl]:"URL was empty or null.",[nl]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[rl]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[il]:"Given claims parameter must be a stringified JSON object.",[ol]:"Token request was empty and not found in cache.",[sl]:"The logout request was null or undefined.",[al]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[cl]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[ll]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[ul]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[dl]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[hl]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[pl]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[fl]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[gl]:"Invalid authentication header provided",[ml]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[yl]:"Cannot set allowNativeBroker parameter to true when not in AAD protocol mode.",[vl]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."};class wl extends Pa{constructor(e){super(e,bl[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,wl.prototype)}}function _l(e){return new wl(e)}class Cl{static isEmptyObj(e){if(e)try{const t=JSON.parse(e);return 0===Object.keys(t).length}catch(t){}return!0}static startsWith(e,t){return 0===e.indexOf(t)}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){const t={},n=e.split("&"),r=e=>decodeURIComponent(e.replace(/\+/g," "));return n.forEach((e=>{if(e.trim()){const[n,i]=e.split(/=(.+)/g,2);n&&i&&(t[r(n)]=r(i))}})),t}static trimArrayEntries(e){return e.map((e=>e.trim()))}static removeEmptyStringsFromArray(e){return e.filter((e=>!!e))}static jsonParseHelper(e){try{return JSON.parse(e)}catch(t){return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}class Il{constructor(e){const t=e?Cl.trimArrayEntries([...e]):[],n=t?Cl.removeEmptyStringsFromArray(t):[];this.validateInputScopes(n),this.scopes=new Set,n.forEach((e=>this.scopes.add(e)))}static fromString(e){const t=(e||us.EMPTY_STRING).split(" ");return new Il(t)}static createSearchScopes(e){const t=new Il(e);return t.containsOnlyOIDCScopes()?t.removeScope(us.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t}validateInputScopes(e){if(!e||e.length<1)throw _l(nl)}containsScope(e){const t=this.printScopesLowerCase().split(" "),n=new Il(t);return!!e&&n.scopes.has(e.toLowerCase())}containsScopeSet(e){return!(!e||e.scopes.size<=0)&&(this.scopes.size>=e.scopes.size&&e.asArray().every((e=>this.containsScope(e))))}containsOnlyOIDCScopes(){let e=0;return ms.forEach((t=>{this.containsScope(t)&&(e+=1)})),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach((e=>this.appendScope(e)))}catch(t){throw kc(Za)}}removeScope(e){if(!e)throw kc(Xa);this.scopes.delete(e.trim())}removeOIDCScopes(){ms.forEach((e=>{this.scopes.delete(e)}))}unionScopeSets(e){if(!e)throw kc(ec);const t=new Set;return e.scopes.forEach((e=>t.add(e.toLowerCase()))),this.scopes.forEach((e=>t.add(e.toLowerCase()))),t}intersectingScopeSets(e){if(!e)throw kc(ec);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const t=this.unionScopeSets(e),n=e.getScopeCount(),r=this.getScopeCount();return t.size<r+n}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach((t=>e.push(t))),e}printScopes(){if(this.scopes){return this.asArray().join(" ")}return us.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}function Tl(e,t){if(!e)throw kc(Ba);try{const n=t(e);return JSON.parse(n)}catch(n){throw kc(Na)}}function Sl(e){if(!e)throw kc(Na);const t=e.split(js,2);return{uid:t[0],utid:t.length<2?us.EMPTY_STRING:t[1]}}function kl(e,t){return!!e&&!!t&&e===t.split(".")[1]}function Al(e,t,n,r){if(r){const{oid:t,sub:n,tid:i,name:o,tfp:s,acr:a}=r,c=i||s||a||"";return{tenantId:c,localAccountId:t||n||"",name:o,isHomeTenant:kl(c,e)}}return{tenantId:n,localAccountId:t,isHomeTenant:kl(n,e)}}function El(e,t,n,r){let i=e;if(t){const{isHomeTenant:n,...r}=t;i={...e,...r}}if(n){const{isHomeTenant:t,...o}=Al(e.homeAccountId,e.localAccountId,e.tenantId,n);return i={...i,...o,idTokenClaims:n,idToken:r},i}return i}const Ml=0,Rl=1,Ol=2,Pl=3;function xl(e){if(e){return e.tid||e.tfp||e.acr||null}return null}class Nl{generateAccountId(){return[this.homeAccountId,this.environment].join($s).toLowerCase()}generateAccountKey(){return Nl.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map((e=>[e.tenantId,e])))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){const t=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",t||e.tenantId||""].join($s).toLowerCase()}static createAccount(e,t,n){const r=new Nl;let i;t.authorityType===Rl?r.authorityType=zs:t.protocolMode===ka?r.authorityType=qs:r.authorityType=Hs,e.clientInfo&&n&&(i=Tl(e.clientInfo,n)),r.clientInfo=e.clientInfo,r.homeAccountId=e.homeAccountId,r.nativeAccountId=e.nativeAccountId;const o=e.environment||t&&t.getPreferredCache();if(!o)throw kc(sc);r.environment=o,r.realm=i?.utid||xl(e.idTokenClaims)||"",r.localAccountId=i?.uid||e.idTokenClaims?.oid||e.idTokenClaims?.sub||"";const s=e.idTokenClaims?.preferred_username||e.idTokenClaims?.upn,a=e.idTokenClaims?.emails?e.idTokenClaims.emails[0]:null;if(r.username=s||a||"",r.name=e.idTokenClaims?.name||"",r.cloudGraphHostName=e.cloudGraphHostName,r.msGraphHost=e.msGraphHost,e.tenantProfiles)r.tenantProfiles=e.tenantProfiles;else{const t=Al(e.homeAccountId,r.localAccountId,r.realm,e.idTokenClaims);r.tenantProfiles=[t]}return r}static createFromAccountInfo(e,t,n){const r=new Nl;return r.authorityType=e.authorityType||Hs,r.homeAccountId=e.homeAccountId,r.localAccountId=e.localAccountId,r.nativeAccountId=e.nativeAccountId,r.realm=e.tenantId,r.environment=e.environment,r.username=e.username,r.name=e.name,r.cloudGraphHostName=t,r.msGraphHost=n,r.tenantProfiles=Array.from(e.tenantProfiles?.values()||[]),r}static generateHomeAccountId(e,t,n,r,i){if(t!==Rl&&t!==Ol){if(e)try{const t=Tl(e,r.base64Decode);if(t.uid&&t.utid)return`${t.uid}.${t.utid}`}catch(o){}n.warning("No client info in response")}return i?.sub||""}static isAccountEntity(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"))}static accountInfoIsEqual(e,t,n){if(!e||!t)return!1;let r=!0;if(n){const n=e.idTokenClaims||{},i=t.idTokenClaims||{};r=n.iat===i.iat&&n.nonce===i.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&r}}function Bl(e){return e.startsWith("#/")?e.substring(2):e.startsWith("#")||e.startsWith("?")?e.substring(1):e}function Dl(e){if(!e||e.indexOf("=")<0)return null;try{const t=Bl(e),n=Object.fromEntries(new URLSearchParams(t));if(n.code||n.error||n.error_description||n.state)return n}catch(t){throw kc(za)}return null}class Ll{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw _l(tl);e.includes("#")||(this._urlString=Ll.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return Cl.endsWith(t,"?")?t=t.slice(0,-1):Cl.endsWith(t,"?/")&&(t=t.slice(0,-2)),Cl.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch(t){throw _l(el)}if(!e.HostNameAndPort||!e.PathSegments)throw _l(el);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw _l(Zc)}static appendQueryString(e,t){return t?e.indexOf("?")<0?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return Ll.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const t=this.getUrlComponents(),n=t.PathSegments;return!e||0===n.length||n[0]!==Ms&&n[0]!==Rs||(n[0]=e),Ll.constructAuthorityUriFromObject(t)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw _l(el);const n={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]};let r=n.AbsolutePath.split("/");return r=r.filter((e=>e&&e.length>0)),n.PathSegments=r,n.QueryString&&n.QueryString.endsWith("/")&&(n.QueryString=n.QueryString.substring(0,n.QueryString.length-1)),n}static getDomainFromUrl(e){const t=RegExp("^([^:/?#]+://)?([^/?#]*)"),n=e.match(t);if(!n)throw _l(el);return n[2]}static getAbsoluteUrl(e,t){if(e[0]===us.FORWARD_SLASH){const n=new Ll(t).getUrlComponents();return n.Protocol+"//"+n.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new Ll(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!Dl(e)}}const Fl={"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},Ul={tenant_discovery_endpoint:"https://{canonicalAuthority}/v2.0/.well-known/openid-configuration",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},ql=new Set;function zl(e,t,n,r){if(r?.trace(`getAliasesFromMetadata called with source: ${n}`),e&&t){const i=Hl(t,e);if(i)return r?.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${n}, returning aliases`),i.aliases;r?.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${n}`)}return null}function Hl(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(r.aliases.includes(t))return r}return null}Ul.metadata.forEach((e=>{e.aliases.forEach((e=>{ql.add(e)}))}));const $l="cache_quota_exceeded",jl="cache_error_unknown",Kl={[$l]:"Exceeded cache storage capacity.",[jl]:"Unexpected error occurred when using cache storage."};class Vl extends Error{constructor(e,t){const n=t||(Kl[e]?Kl[e]:Kl[jl]);super(`${e}: ${n}`),Object.setPrototypeOf(this,Vl.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=n}}class Wl{constructor(e,t,n,r){this.clientId=e,this.cryptoImpl=t,this.commonLogger=n.clone(Ec,Mc),this.staticAuthorityOptions=r}getAllAccounts(e){return this.buildTenantProfiles(this.getAccountsFilteredBy(e||{}),e)}getAccountInfoFilteredBy(e){const t=this.getAllAccounts(e);if(t.length>1){return t.sort((e=>e.idTokenClaims?-1:1))[0]}return 1===t.length?t[0]:null}getBaseAccountInfo(e){const t=this.getAccountsFilteredBy(e);return t.length>0?t[0].getAccountInfo():null}buildTenantProfiles(e,t){return e.flatMap((e=>this.getTenantProfilesFromAccountEntity(e,t?.tenantId,t)))}getTenantedAccountInfoByFilter(e,t,n,r){let i,o=null;if(r&&!this.tenantProfileMatchesFilter(n,r))return null;const s=this.getIdToken(e,t,n.tenantId);return s&&(i=Rc(s.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(i,r))?null:(o=El(e,n,i,s?.secret),o)}getTenantProfilesFromAccountEntity(e,t,n){const r=e.getAccountInfo();let i=r.tenantProfiles||new Map;const o=this.getTokenKeys();if(t){const e=i.get(t);if(!e)return[];i=new Map([[t,e]])}const s=[];return i.forEach((e=>{const t=this.getTenantedAccountInfoByFilter(r,o,e,n);t&&s.push(t)})),s}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId))&&((!t.name||e.name===t.name)&&(void 0===t.isHomeTenant||e.isHomeTenant===t.isHomeTenant))}idTokenClaimsMatchTenantProfileFilter(e,t){if(t){if(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId))return!1;if(t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint))return!1;if(t.username&&!this.matchUsername(e.preferred_username,t.username))return!1;if(t.name&&!this.matchName(e,t.name))return!1;if(t.sid&&!this.matchSid(e,t.sid))return!1}return!0}async saveCacheRecord(e,t,n){if(!e)throw kc(oc);try{e.account&&this.setAccount(e.account),e.idToken&&!1!==t?.idToken&&this.setIdTokenCredential(e.idToken),e.accessToken&&!1!==t?.accessToken&&await this.saveAccessToken(e.accessToken),e.refreshToken&&!1!==t?.refreshToken&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata)}catch(r){throw this.commonLogger?.error("CacheManager.saveCacheRecord: failed"),r instanceof Error?(this.commonLogger?.errorPii(`CacheManager.saveCacheRecord: ${r.message}`,n),"QuotaExceededError"===r.name||"NS_ERROR_DOM_QUOTA_REACHED"===r.name||r.message.includes("exceeded the quota")?(this.commonLogger?.error("CacheManager.saveCacheRecord: exceeded storage quota",n),new Vl($l)):new Vl(r.name,r.message)):(this.commonLogger?.errorPii(`CacheManager.saveCacheRecord: ${r}`,n),new Vl(jl))}}async saveAccessToken(e){const t={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},n=this.getTokenKeys(),r=Il.fromString(e.target),i=[];n.accessToken.forEach((e=>{if(!this.accessTokenKeyMatchesFilter(e,t,!1))return;const n=this.getAccessTokenCredential(e);if(n&&this.credentialMatchesFilter(n,t)){Il.fromString(n.target).intersectingScopeSets(r)&&i.push(this.removeAccessToken(e))}})),await Promise.all(i),this.setAccessTokenCredential(e)}getAccountsFilteredBy(e){const t=this.getAccountKeys(),n=[];return t.forEach((t=>{if(!this.isAccountKey(t,e.homeAccountId))return;const r=this.getAccount(t,this.commonLogger);if(!r)return;if(e.homeAccountId&&!this.matchHomeAccountId(r,e.homeAccountId))return;if(e.username&&!this.matchUsername(r.username,e.username))return;if(e.environment&&!this.matchEnvironment(r,e.environment))return;if(e.realm&&!this.matchRealm(r,e.realm))return;if(e.nativeAccountId&&!this.matchNativeAccountId(r,e.nativeAccountId))return;if(e.authorityType&&!this.matchAuthorityType(r,e.authorityType))return;const i={localAccountId:e?.localAccountId,name:e?.name},o=r.tenantProfiles?.filter((e=>this.tenantProfileMatchesFilter(e,i)));o&&0===o.length||n.push(r)})),n}isAccountKey(e,t,n){return!(e.split($s).length<3)&&(!(t&&!e.toLowerCase().includes(t.toLowerCase()))&&!(n&&!e.toLowerCase().includes(n.toLowerCase())))}isCredentialKey(e){if(e.split($s).length<6)return!1;const t=e.toLowerCase();if(-1===t.indexOf(Ks.ID_TOKEN.toLowerCase())&&-1===t.indexOf(Ks.ACCESS_TOKEN.toLowerCase())&&-1===t.indexOf(Ks.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())&&-1===t.indexOf(Ks.REFRESH_TOKEN.toLowerCase()))return!1;if(t.indexOf(Ks.REFRESH_TOKEN.toLowerCase())>-1){const e=`${Ks.REFRESH_TOKEN}${$s}${this.clientId}${$s}`,n=`${Ks.REFRESH_TOKEN}${$s}${Ws}${$s}`;if(-1===t.indexOf(e.toLowerCase())&&-1===t.indexOf(n.toLowerCase()))return!1}else if(-1===t.indexOf(this.clientId.toLowerCase()))return!1;return!0}credentialMatchesFilter(e,t){if(t.clientId&&!this.matchClientId(e,t.clientId))return!1;if(t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash))return!1;if("string"===typeof t.homeAccountId&&!this.matchHomeAccountId(e,t.homeAccountId))return!1;if(t.environment&&!this.matchEnvironment(e,t.environment))return!1;if(t.realm&&!this.matchRealm(e,t.realm))return!1;if(t.credentialType&&!this.matchCredentialType(e,t.credentialType))return!1;if(t.familyId&&!this.matchFamilyId(e,t.familyId))return!1;if(t.target&&!this.matchTarget(e,t.target))return!1;if((t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash)return!1;if(e.credentialType===Ks.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(t.tokenType&&!this.matchTokenType(e,t.tokenType))return!1;if(t.tokenType===ta.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId))return!1}return!0}getAppMetadataFilteredBy(e){const t=this.getKeys(),n={};return t.forEach((t=>{if(!this.isAppMetadata(t))return;const r=this.getAppMetadata(t);r&&(e.environment&&!this.matchEnvironment(r,e.environment)||e.clientId&&!this.matchClientId(r,e.clientId)||(n[t]=r))})),n}getAuthorityMetadataByAlias(e){const t=this.getAuthorityMetadataKeys();let n=null;return t.forEach((t=>{if(!this.isAuthorityMetadata(t)||-1===t.indexOf(this.clientId))return;const r=this.getAuthorityMetadata(t);r&&-1!==r.aliases.indexOf(e)&&(n=r)})),n}async removeAllAccounts(){const e=this.getAccountKeys(),t=[];e.forEach((e=>{t.push(this.removeAccount(e))})),await Promise.all(t)}async removeAccount(e){const t=this.getAccount(e,this.commonLogger);t&&(await this.removeAccountContext(t),this.removeItem(e))}async removeAccountContext(e){const t=this.getTokenKeys(),n=e.generateAccountId(),r=[];t.idToken.forEach((e=>{0===e.indexOf(n)&&this.removeIdToken(e)})),t.accessToken.forEach((e=>{0===e.indexOf(n)&&r.push(this.removeAccessToken(e))})),t.refreshToken.forEach((e=>{0===e.indexOf(n)&&this.removeRefreshToken(e)})),await Promise.all(r)}updateOutdatedCachedAccount(e,t,n){if(t&&t.isSingleTenant()){this.commonLogger?.verbose("updateOutdatedCachedAccount: Found a single-tenant (outdated) account entity in the cache, migrating to multi-tenant account entity");const r=this.getAccountKeys().filter((e=>e.startsWith(t.homeAccountId))),i=[];r.forEach((e=>{const t=this.getCachedAccountEntity(e);t&&i.push(t)}));const o=i.find((e=>kl(e.realm,e.homeAccountId)))||i[0];o.tenantProfiles=i.map((e=>({tenantId:e.realm,localAccountId:e.localAccountId,name:e.name,isHomeTenant:kl(e.realm,e.homeAccountId)})));const s=Wl.toObject(new Nl,{...o}),a=s.generateAccountKey();return r.forEach((t=>{t!==a&&this.removeOutdatedAccount(e)})),this.setAccount(s),n?.verbose("Updated an outdated account entity in the cache"),s}return t}async removeAccessToken(e){const t=this.getAccessTokenCredential(e);if(t){if(t.credentialType.toLowerCase()===Ks.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()&&t.tokenType===ta.POP){const e=t.keyId;if(e)try{await this.cryptoImpl.removeTokenBindingKey(e)}catch(n){throw kc(mc)}}return this.removeItem(e)}}removeAppMetadata(){return this.getKeys().forEach((e=>{this.isAppMetadata(e)&&this.removeItem(e)})),!0}readAccountFromCache(e){const t=Nl.generateAccountCacheKey(e);return this.getAccount(t,this.commonLogger)}getIdToken(e,t,n,r,i){this.commonLogger.trace("CacheManager - getIdToken called");const o={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:Ks.ID_TOKEN,clientId:this.clientId,realm:n},s=this.getIdTokensByFilter(o,t),a=s.size;if(a<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(a>1){let t=s;if(!n){const n=new Map;s.forEach(((t,r)=>{t.realm===e.tenantId&&n.set(r,t)}));const r=n.size;if(r<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),s.values().next().value;if(1===r)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),n.values().next().value;t=n}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),t.forEach(((e,t)=>{this.removeIdToken(t)})),r&&i&&r.addFields({multiMatchedID:s.size},i),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),s.values().next().value}getIdTokensByFilter(e,t){const n=t&&t.idToken||this.getTokenKeys().idToken,r=new Map;return n.forEach((t=>{if(!this.idTokenKeyMatchesFilter(t,{clientId:this.clientId,...e}))return;const n=this.getIdTokenCredential(t);n&&this.credentialMatchesFilter(n,e)&&r.set(t,n)})),r}idTokenKeyMatchesFilter(e,t){const n=e.toLowerCase();return(!t.clientId||-1!==n.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==n.indexOf(t.homeAccountId.toLowerCase()))}removeIdToken(e){this.removeItem(e)}removeRefreshToken(e){this.removeItem(e)}getAccessToken(e,t,n,r,i,o){this.commonLogger.trace("CacheManager - getAccessToken called");const s=Il.createSearchScopes(t.scopes),a=t.authenticationScheme||ta.BEARER,c=a&&a.toLowerCase()!==ta.BEARER.toLowerCase()?Ks.ACCESS_TOKEN_WITH_AUTH_SCHEME:Ks.ACCESS_TOKEN,l={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:c,clientId:this.clientId,realm:r||e.tenantId,target:s,tokenType:a,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},u=n&&n.accessToken||this.getTokenKeys().accessToken,d=[];u.forEach((e=>{if(this.accessTokenKeyMatchesFilter(e,l,!0)){const t=this.getAccessTokenCredential(e);t&&this.credentialMatchesFilter(t,l)&&d.push(t)}}));const h=d.length;return h<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):h>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),d.forEach((e=>{this.removeAccessToken(Nc(e))})),i&&o&&i.addFields({multiMatchedAT:d.length},o),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),d[0])}accessTokenKeyMatchesFilter(e,t,n){const r=e.toLowerCase();if(t.clientId&&-1===r.indexOf(t.clientId.toLowerCase()))return!1;if(t.homeAccountId&&-1===r.indexOf(t.homeAccountId.toLowerCase()))return!1;if(t.realm&&-1===r.indexOf(t.realm.toLowerCase()))return!1;if(t.requestedClaimsHash&&-1===r.indexOf(t.requestedClaimsHash.toLowerCase()))return!1;if(t.target){const e=t.target.asArray();for(let t=0;t<e.length;t++){if(n&&!r.includes(e[t].toLowerCase()))return!1;if(!n&&r.includes(e[t].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e){const t=this.getTokenKeys(),n=[];return t.accessToken.forEach((t=>{if(!this.accessTokenKeyMatchesFilter(t,e,!0))return;const r=this.getAccessTokenCredential(t);r&&this.credentialMatchesFilter(r,e)&&n.push(r)})),n}getRefreshToken(e,t,n,r,i){this.commonLogger.trace("CacheManager - getRefreshToken called");const o=t?Ws:void 0,s={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:Ks.REFRESH_TOKEN,clientId:this.clientId,familyId:o},a=n&&n.refreshToken||this.getTokenKeys().refreshToken,c=[];a.forEach((e=>{if(this.refreshTokenKeyMatchesFilter(e,s)){const t=this.getRefreshTokenCredential(e);t&&this.credentialMatchesFilter(t,s)&&c.push(t)}}));const l=c.length;return l<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(l>1&&r&&i&&r.addFields({multiMatchedRT:l},i),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),c[0])}refreshTokenKeyMatchesFilter(e,t){const n=e.toLowerCase();return(!t.familyId||-1!==n.indexOf(t.familyId.toLowerCase()))&&(!(!t.familyId&&t.clientId&&-1===n.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==n.indexOf(t.homeAccountId.toLowerCase())))}readAppMetadataFromCache(e){const t={environment:e,clientId:this.clientId},n=this.getAppMetadataFilteredBy(t),r=Object.keys(n).map((e=>n[e])),i=r.length;if(i<1)return null;if(i>1)throw kc(Ga);return r[0]}isAppMetadataFOCI(e){const t=this.readAppMetadataFromCache(e);return!(!t||t.familyId!==Ws)}matchHomeAccountId(e,t){return!("string"!==typeof e.homeAccountId||t!==e.homeAccountId)}matchLocalAccountIdFromTokenClaims(e,t){return t===(e.oid||e.sub)}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){return!(t.toLowerCase()!==e.name?.toLowerCase())}matchUsername(e,t){return!(!e||"string"!==typeof e||t?.toLowerCase()!==e.toLowerCase())}matchUserAssertionHash(e,t){return!(!e.userAssertionHash||t!==e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){const n=function(e,t){let n;const r=e.canonicalAuthority;if(r){const i=new Ll(r).getUrlComponents().HostNameAndPort;n=zl(i,e.cloudDiscoveryMetadata?.metadata,Gs,t)||zl(i,Ul.metadata,Zs,t)||e.knownAuthorities}return n||[]}(this.staticAuthorityOptions,this.commonLogger);if(n.includes(t)&&n.includes(e.environment))return!0}const n=this.getAuthorityMetadataByAlias(t);return!!(n&&n.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!(!e.clientId||t!==e.clientId)}matchFamilyId(e,t){return!(!e.familyId||t!==e.familyId)}matchRealm(e,t){return!(e.realm?.toLowerCase()!==t.toLowerCase())}matchNativeAccountId(e,t){return!(!e.nativeAccountId||t!==e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||(e.preferred_username===t||e.upn===t)}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!(!e.authorityType||t.toLowerCase()!==e.authorityType.toLowerCase())}matchTarget(e,t){if(e.credentialType!==Ks.ACCESS_TOKEN&&e.credentialType!==Ks.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)return!1;return Il.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!(!e.tokenType||e.tokenType!==t)}matchKeyId(e,t){return!(!e.keyId||e.keyId!==t)}isAppMetadata(e){return-1!==e.indexOf(Vs)}isAuthorityMetadata(e){return-1!==e.indexOf(Qs)}generateAuthorityMetadataCacheKey(e){return`${Qs}-${this.clientId}-${e}`}static toObject(e,t){for(const n in t)e[n]=t[n];return e}}class Ql extends Wl{setAccount(){throw kc(Cc)}getAccount(){throw kc(Cc)}getCachedAccountEntity(){throw kc(Cc)}setIdTokenCredential(){throw kc(Cc)}getIdTokenCredential(){throw kc(Cc)}setAccessTokenCredential(){throw kc(Cc)}getAccessTokenCredential(){throw kc(Cc)}setRefreshTokenCredential(){throw kc(Cc)}getRefreshTokenCredential(){throw kc(Cc)}setAppMetadata(){throw kc(Cc)}getAppMetadata(){throw kc(Cc)}setServerTelemetry(){throw kc(Cc)}getServerTelemetry(){throw kc(Cc)}setAuthorityMetadata(){throw kc(Cc)}getAuthorityMetadata(){throw kc(Cc)}getAuthorityMetadataKeys(){throw kc(Cc)}setThrottlingCache(){throw kc(Cc)}getThrottlingCache(){throw kc(Cc)}removeItem(){throw kc(Cc)}getKeys(){throw kc(Cc)}getAccountKeys(){throw kc(Cc)}getTokenKeys(){throw kc(Cc)}async clear(){throw kc(Cc)}updateCredentialCacheKey(){throw kc(Cc)}removeOutdatedAccount(){throw kc(Cc)}}const Yl={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},Gl={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Ta.Info,correlationId:us.EMPTY_STRING},Jl={claimsBasedCachingEnabled:!1},Xl={async sendGetRequestAsync(){throw kc(Cc)},async sendPostRequestAsync(){throw kc(Cc)}},Zl={sku:us.SKU,version:Mc,cpu:us.EMPTY_STRING,os:us.EMPTY_STRING},eu={clientSecret:us.EMPTY_STRING,clientAssertion:void 0},tu={azureCloudInstance:Ea,tenant:`${us.DEFAULT_COMMON_TENANT}`},nu={application:{appName:"",appVersion:""}};function ru(e){return e.authOptions.authority.options.protocolMode===Aa}const iu={sendGetRequestAsync:()=>Promise.reject(kc(Cc)),sendPostRequestAsync:()=>Promise.reject(kc(Cc))},ou="acquireTokenByCode",su="acquireTokenByRefreshToken",au="acquireTokenSilent",cu="acquireTokenSilentAsync",lu="acquireTokenPopup",uu="acquireTokenPreRedirect",du="acquireTokenRedirect",hu="cryptoOptsGetPublicKeyThumbprint",pu="cryptoOptsSignJwt",fu="silentCacheClientAcquireToken",gu="silentIframeClientAcquireToken",mu="awaitConcurrentIframe",yu="silentRefreshClientAcquireToken",vu="ssoSilent",bu="standardInteractionClientGetDiscoveredAuthority",wu="fetchAccountIdWithNativeBroker",_u="nativeInteractionClientAcquireToken",Cu="refreshTokenClientExecutePostToTokenEndpoint",Iu="authorizationCodeClientExecutePostToTokenEndpoint",Tu="refreshTokenClientExecuteTokenRequest",Su="refreshTokenClientAcquireToken",ku="refreshTokenClientAcquireTokenWithCachedRefreshToken",Au="refreshTokenClientAcquireTokenByRefreshToken",Eu="refreshTokenClientCreateTokenRequestBody",Mu="acquireTokenFromCache",Ru="silentFlowClientAcquireCachedToken",Ou="silentFlowClientGenerateResultFromCacheRecord",Pu="acquireTokenBySilentIframe",xu="initializeBaseRequest",Nu="initializeSilentRequest",Bu="initializeClientApplication",Du="silentIframeClientTokenHelper",Lu="silentHandlerInitiateAuthRequest",Fu="silentHandlerMonitorIframeForHash",Uu="silentHandlerLoadFrame",qu="silentHandlerLoadFrameSync",zu="standardInteractionClientCreateAuthCodeClient",Hu="standardInteractionClientGetClientConfiguration",$u="standardInteractionClientInitializeAuthorizationRequest",ju="standardInteractionClientInitializeAuthorizationCodeRequest",Ku="getAuthCodeUrl",Vu="handleCodeResponseFromServer",Wu="handleCodeResponse",Qu="updateTokenEndpointAuthority",Yu="authClientAcquireToken",Gu="authClientExecuteTokenRequest",Ju="authClientCreateTokenRequestBody",Xu="authClientCreateQueryString",Zu="popTokenGenerateCnf",ed="popTokenGenerateKid",td="handleServerTokenResponse",nd="deserializeResponse",rd="authorityFactoryCreateDiscoveredInstance",id="authorityResolveEndpointsAsync",od="authorityGetCloudDiscoveryMetadataFromNetwork",sd="authorityUpdateCloudDiscoveryMetadata",ad="authorityGetEndpointMetadataFromNetwork",cd="authorityUpdateEndpointMetadata",ld="authorityUpdateMetadataWithRegionalInformation",ud="regionDiscoveryDetectRegion",dd="regionDiscoveryGetRegionFromIMDS",hd="regionDiscoveryGetCurrentVersion",pd="acquireTokenByCodeAsync",fd="handleRedirectPromise",gd="handleNativeRedirectPromise",md="nativeMessageHandlerHandshake",yd="removeHiddenIframe",vd="clearTokensAndKeysWithClaims",bd="cacheManagerGetRefreshToken",wd="generatePkceCodes",_d="generateCodeVerifier",Cd="generateCodeChallengeFromVerifier",Id="sha256Digest",Td="getRandomValues",Sd=(new Map([[ou,"ATByCode"],[su,"ATByRT"],[au,"ATS"],[cu,"ATSAsync"],[lu,"ATPopup"],[du,"ATRedirect"],[hu,"CryptoGetPKThumb"],[pu,"CryptoSignJwt"],[fu,"SltCacheClientAT"],[gu,"SltIframeClientAT"],[yu,"SltRClientAT"],[vu,"SsoSlt"],[bu,"StdIntClientGetDiscAuth"],[wu,"FetchAccIdWithNtvBroker"],[_u,"NtvIntClientAT"],["baseClientCreateTokenRequestHeaders","BaseClientCreateTReqHead"],[Cu,"RTClientExecPost"],[Iu,"AuthCodeClientExecPost"],["brokerHandshake","BrokerHandshake"],["acquireTokenByRefreshTokenInBroker","ATByRTInBroker"],["acquireTokenByBroker","ATByBroker"],[Tu,"RTClientExecTReq"],[Su,"RTClientAT"],[ku,"RTClientATWithCachedRT"],[Au,"RTClientATByRT"],[Eu,"RTClientCreateTReqBody"],[Mu,"ATFromCache"],[Ru,"SltFlowClientATCached"],[Ou,"SltFlowClientGenResFromCache"],[Pu,"ATBySltIframe"],[xu,"InitBaseReq"],[Nu,"InitSltReq"],[Bu,"InitClientApplication"],[Du,"SIClientTHelper"],[Lu,"SHandlerInitAuthReq"],[Fu,"SltHandlerMonitorIframeForHash"],[Uu,"SHandlerLoadFrame"],[qu,"SHandlerLoadFrameSync"],[zu,"StdIntClientCreateAuthCodeClient"],[Hu,"StdIntClientGetClientConf"],[$u,"StdIntClientInitAuthReq"],[ju,"StdIntClientInitAuthCodeReq"],[Ku,"GetAuthCodeUrl"],[Vu,"HandleCodeResFromServer"],[Wu,"HandleCodeResp"],[Qu,"UpdTEndpointAuth"],[Yu,"AuthClientAT"],[Gu,"AuthClientExecTReq"],[Ju,"AuthClientCreateTReqBody"],[Xu,"AuthClientCreateQueryStr"],[Zu,"PopTGenCnf"],[ed,"PopTGenKid"],[td,"HandleServerTRes"],[nd,"DeserializeRes"],[rd,"AuthFactCreateDiscInst"],[id,"AuthResolveEndpointsAsync"],["authorityResolveEndpointsFromLocalSources","AuthResolveEndpointsFromLocal"],[od,"AuthGetCDMetaFromNet"],[sd,"AuthUpdCDMeta"],[ad,"AuthUpdCDMetaFromNet"],[cd,"AuthUpdEndpointMeta"],[ld,"AuthUpdMetaWithRegInfo"],[ud,"RegDiscDetectReg"],[dd,"RegDiscGetRegFromIMDS"],[hd,"RegDiscGetCurrentVer"],[pd,"ATByCodeAsync"],["getEndpointMetadataFromNetwork","GetEndpointMetaFromNet"],["getCloudDiscoveryMetadataFromNetworkMeasurement","GetCDMetaFromNet"],[fd,"HandleRedirectPromise"],[gd,"HandleNtvRedirectPromise"],["updateCloudDiscoveryMetadataMeasurement","UpdateCDMeta"],["usernamePasswordClientAcquireToken","UserPassClientAT"],[md,"NtvMsgHandlerHandshake"],["nativeGenerateAuthResult","NtvGenAuthRes"],[yd,"RemoveHiddenIframe"],[vd,"ClearTAndKeysWithClaims"],[bd,"CacheManagerGetRT"],[wd,"GenPkceCodes"],[_d,"GenCodeVerifier"],[Cd,"GenCodeChallengeFromVerifier"],[Id,"Sha256Digest"],[Td,"GetRandomValues"]]),1);new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status","multiMatchedAT","multiMatchedID","multiMatchedRT"]);class kd{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class Ad{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:Sd,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new kd}}startPerformanceMeasurement(){return new kd}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}const Ed="invalid_grant",Md=483,Rd=600,Od="msal",Pd=30,xd="msal.js.browser",Nd="53ee284d-920a-4b59-9d30-a60315b26836",Bd="ppnbnpeolgkicgegkbkbjmhlideopiji",Dd="MATS",Ld="Handshake",Fd="HandshakeResponse",Ud="GetToken",qd="Response",zd="localStorage",Hd="sessionStorage",$d="memoryStorage",jd="GET",Kd="POST",Vd="authority",Wd="request.state",Qd="nonce.id_token",Yd="request.origin",Gd="urlHash",Jd="request.params",Xd="interaction.status",Zd="ccs.credential",eh="request.correlationId",th="request.native",nh="msal.account.keys",rh="msal.token.keys",ih="wrapper.sku",oh="wrapper.version",sh=861,ah=862,ch=863,lh=865,uh=866,dh=61,hh=961,ph=962;var fh;!function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent",e.None="none"}(fh||(fh={}));const gh={scopes:gs},mh="msal.db",yh=`${mh}.keys`,vh=0,bh=1,wh=2,_h=3,Ch=4,Ih=5,Th=[vh,Ih,Ch];class Sh{navigateInternal(e,t){return Sh.defaultNavigateWindow(e,t)}navigateExternal(e,t){return Sh.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise((e=>{setTimeout((()=>{e(!0)}),t.timeout)}))}}const kh="pkce_not_created",Ah="crypto_nonexistent",Eh="empty_navigate_uri",Mh="hash_empty_error",Rh="no_state_in_hash",Oh="hash_does_not_contain_known_properties",Ph="unable_to_parse_state",xh="state_interaction_type_mismatch",Nh="interaction_in_progress",Bh="popup_window_error",Dh="empty_window_error",Lh="user_cancelled",Fh="monitor_popup_timeout",Uh="monitor_window_timeout",qh="redirect_in_iframe",zh="block_iframe_reload",Hh="block_nested_popups",$h="iframe_closed_prematurely",jh="silent_logout_unsupported",Kh="no_account_error",Vh="silent_prompt_value_error",Wh="no_token_request_cache_error",Qh="unable_to_parse_token_request_cache_error",Yh="no_cached_authority_error",Gh="auth_request_not_set_error",Jh="invalid_cache_type",Xh="non_browser_environment",Zh="database_not_open",ep="no_network_connectivity",tp="post_request_failed",np="get_request_failed",rp="failed_to_parse_response",ip="unable_to_load_token",op="crypto_key_not_found",sp="auth_code_required",ap="auth_code_or_nativeAccountId_required",cp="spa_code_and_nativeAccountId_present",lp="database_unavailable",up="unable_to_acquire_token_from_native_platform",dp="native_handshake_timeout",hp="native_extension_not_installed",pp="native_connection_not_established",fp="uninitialized_public_client_application",gp="native_prompt_not_supported",mp="invalid_base64_string",yp="invalid_pop_token_request",vp="For more visit: aka.ms/msaljs/browser-errors",bp={[kh]:"The PKCE code challenge and verifier could not be generated.",[Ah]:"The crypto object or function is not available.",[Eh]:"Navigation URI is empty. Please check stack trace for more info.",[Mh]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${vp}`,[Rh]:"Hash does not contain state. Please verify that the request originated from msal.",[Oh]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${vp}`,[Ph]:"Unable to parse state. Please verify that the request originated from msal.",[xh]:"Hash contains state but the interaction type does not match the caller.",[Nh]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${vp}`,[Bh]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[Dh]:"window.open returned null or undefined window object.",[Lh]:"User cancelled the flow.",[Fh]:`Token acquisition in popup failed due to timeout.  ${vp}`,[Uh]:`Token acquisition in iframe failed due to timeout.  ${vp}`,[qh]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[zh]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${vp}`,[Hh]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[$h]:"The iframe being monitored was closed prematurely.",[jh]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[Kh]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[Vh]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[Wh]:"No token request found in cache.",[Qh]:"The cached token request could not be parsed.",[Yh]:"No cached authority found.",[Gh]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[Jh]:"Invalid cache type",[Xh]:"Login and token requests are not supported in non-browser environments.",[Zh]:"Database is not open!",[ep]:"No network connectivity. Check your internet connection.",[tp]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[np]:"Network request failed. Please check the network trace to determine root cause.",[rp]:"Failed to parse network response. Check network trace.",[ip]:"Error loading token to cache.",[op]:"Cryptographic Key or Keypair not found in browser storage.",[sp]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[ap]:"An authorization code or nativeAccountId must be provided to this flow.",[cp]:"Request cannot contain both spa code and native account id.",[lp]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[up]:`Unable to acquire token from native platform.  ${vp}`,[dp]:"Timed out while attempting to establish connection to browser extension",[hp]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[pp]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${vp}`,[fp]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${vp}`,[gp]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[mp]:"Invalid base64 encoded string.",[yp]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true."};class wp extends Pa{constructor(e){super(e,bp[e]),Object.setPrototypeOf(this,wp.prototype),this.name="BrowserAuthError"}}function _p(e){return new wp(e)}class Cp{async sendGetRequestAsync(e,t){let n;try{n=await fetch(e,{method:jd,headers:this.getFetchHeaders(t)})}catch(r){throw window.navigator.onLine?_p(np):_p(ep)}try{return{headers:this.getHeaderDict(n.headers),body:await n.json(),status:n.status}}catch(r){throw _p(rp)}}async sendPostRequestAsync(e,t){const n=t&&t.body||us.EMPTY_STRING;let r;try{r=await fetch(e,{method:Kd,headers:this.getFetchHeaders(t),body:n})}catch(i){throw window.navigator.onLine?_p(tp):_p(ep)}try{return{headers:this.getHeaderDict(r.headers),body:await r.json(),status:r.status}}catch(i){throw _p(rp)}}getFetchHeaders(e){const t=new Headers;if(!e||!e.headers)return t;const n=e.headers;return Object.keys(n).forEach((e=>{t.append(e,n[e])})),t}getHeaderDict(e){const t={};return e.forEach(((e,n)=>{t[n]=e})),t}}const Ip=1e4;const Tp="3.26.1";class Sp{static loggerCallback(e,t){switch(e){case Ta.Error:return void console.error(t);case Ta.Info:return void console.info(t);case Ta.Verbose:return void console.debug(t);case Ta.Warning:return void console.warn(t);default:return void console.log(t)}}constructor(e){let t;this.browserEnvironment="undefined"!==typeof window,this.config=function(e,t){let{auth:n,cache:r,system:i,telemetry:o}=e;const s={clientId:us.EMPTY_STRING,authority:`${us.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:us.EMPTY_STRING,authorityMetadata:us.EMPTY_STRING,redirectUri:us.EMPTY_STRING,postLogoutRedirectUri:us.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:ka,OIDCOptions:{serverResponseType:Ds.FRAGMENT,defaultScopes:[us.OPENID_SCOPE,us.PROFILE_SCOPE,us.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:Ea,tenant:us.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1},a={cacheLocation:Hd,temporaryCacheLocation:Hd,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!r||r.cacheLocation!==zd),claimsBasedCachingEnabled:!1},c={loggerCallback:()=>{},logLevel:Ta.Info,piiLoggingEnabled:!1},l={...{...Yl,loggerOptions:c,networkClient:t?new Cp:iu,navigationClient:new Sh,loadFrameTimeout:0,windowHashTimeout:i?.loadFrameTimeout||6e4,iframeHashTimeout:i?.loadFrameTimeout||Ip,navigateFrameWait:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:i?.nativeBrokerHandshakeTimeout||2e3,pollIntervalMilliseconds:Pd},...i,loggerOptions:i?.loggerOptions||c},u={application:{appName:us.EMPTY_STRING,appVersion:us.EMPTY_STRING},client:new Ad};n?.protocolMode!==Aa&&n?.OIDCOptions&&new Sa(l.loggerOptions).warning(JSON.stringify(_l(ml)));if(n?.protocolMode&&n.protocolMode!==ka&&l?.allowNativeBroker)throw _l(yl);return{auth:{...s,...n,OIDCOptions:{...s.OIDCOptions,...n?.OIDCOptions}},cache:{...a,...r},system:l,telemetry:{...u,...o}}}(e,this.browserEnvironment);try{t=window[Hd]}catch(a){}const n=t?.getItem("msal.browser.log.level"),r=t?.getItem("msal.browser.log.pii")?.toLowerCase(),i="true"===r||"false"!==r&&void 0,o={...this.config.system.loggerOptions},s=n&&Object.keys(Ta).includes(n)?Ta[n]:void 0;s&&(o.loggerCallback=Sp.loggerCallback,o.logLevel=s),void 0!==i&&(o.piiLoggingEnabled=i),this.logger=new Sa(o,"@azure/msal-browser",Tp),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}class kp extends Sp{getModuleName(){return kp.MODULE_NAME}getId(){return kp.ID}async initialize(){return this.available="undefined"!==typeof window,this.available}}kp.MODULE_NAME="",kp.ID="StandardOperatingContext";const Ap="missing_kid_error",Ep="missing_alg_error",Mp={[Ap]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[Ep]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class Rp extends Pa{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,Rp.prototype)}}function Op(e){return new Rp(e,Mp[e])}class Pp{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw Op(Ap);if(!e.alg)throw Op(Ep);const t=new Pp({typ:e.typ||Ia,kid:e.kid,alg:e.alg});return JSON.stringify(t)}}function xp(e){return encodeURIComponent(Bp(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function Np(e){return Dp(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Bp(e){return Dp((new TextEncoder).encode(e))}function Dp(e){const t=Array.from(e,(e=>String.fromCodePoint(e))).join("");return btoa(t)}function Lp(e){return(new TextDecoder).decode(function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw _p(mp)}const n=atob(t);return Uint8Array.from(n,(e=>e.codePointAt(0)||0))}(e))}const Fp="SHA-256",Up=new Uint8Array([1,0,1]),qp="0123456789abcdef",zp=new Uint32Array(1),Hp={name:"RSASSA-PKCS1-v1_5",hash:Fp,modulusLength:2048,publicExponent:Up};async function $p(e,t,n){t?.addQueueMeasurement(Id,n);const r=(new TextEncoder).encode(e);return window.crypto.subtle.digest(Fp,r)}function jp(e){return window.crypto.getRandomValues(e)}function Kp(){return window.crypto.getRandomValues(zp),zp[0]}function Vp(){const e=Date.now(),t=1024*Kp()+(1023&Kp()),n=new Uint8Array(16),r=Math.trunc(t/2**30),i=t&2**30-1,o=Kp();n[0]=e/2**40,n[1]=e/2**32,n[2]=e/2**24,n[3]=e/65536,n[4]=e/256,n[5]=e,n[6]=112|r>>>8,n[7]=r,n[8]=128|i>>>24,n[9]=i>>>16,n[10]=i>>>8,n[11]=i,n[12]=o>>>24,n[13]=o>>>16,n[14]=o>>>8,n[15]=o;let s="";for(let a=0;a<n.length;a++)s+=qp.charAt(n[a]>>>4),s+=qp.charAt(15&n[a]),3!==a&&5!==a&&7!==a&&9!==a||(s+="-");return s}async function Wp(e){return window.crypto.subtle.exportKey("jwk",e)}async function Qp(e){const t=await $p(e);return Np(new Uint8Array(t))}class Yp{constructor(){this.dbName=mh,this.version=1,this.tableName=yh,this.dbOpen=!1}async open(){return new Promise(((e,t)=>{const n=window.indexedDB.open(this.dbName,this.version);n.addEventListener("upgradeneeded",(e=>{e.target.result.createObjectStore(this.tableName)})),n.addEventListener("success",(t=>{const n=t;this.db=n.target.result,this.dbOpen=!0,e()})),n.addEventListener("error",(()=>t(_p(lp))))}))}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Promise(((t,n)=>{if(!this.db)return n(_p(Zh));const r=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);r.addEventListener("success",(e=>{const n=e;this.closeConnection(),t(n.target.result)})),r.addEventListener("error",(e=>{this.closeConnection(),n(e)}))}))}async setItem(e,t){return await this.validateDbIsOpen(),new Promise(((n,r)=>{if(!this.db)return r(_p(Zh));const i=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);i.addEventListener("success",(()=>{this.closeConnection(),n()})),i.addEventListener("error",(e=>{this.closeConnection(),r(e)}))}))}async removeItem(e){return await this.validateDbIsOpen(),new Promise(((t,n)=>{if(!this.db)return n(_p(Zh));const r=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);r.addEventListener("success",(()=>{this.closeConnection(),t()})),r.addEventListener("error",(e=>{this.closeConnection(),n(e)}))}))}async getKeys(){return await this.validateDbIsOpen(),new Promise(((e,t)=>{if(!this.db)return t(_p(Zh));const n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();n.addEventListener("success",(t=>{const n=t;this.closeConnection(),e(n.target.result)})),n.addEventListener("error",(e=>{this.closeConnection(),t(e)}))}))}async containsKey(e){return await this.validateDbIsOpen(),new Promise(((t,n)=>{if(!this.db)return n(_p(Zh));const r=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);r.addEventListener("success",(e=>{const n=e;this.closeConnection(),t(1===n.target.result)})),r.addEventListener("error",(e=>{this.closeConnection(),n(e)}))}))}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise(((e,t)=>{const n=window.indexedDB.deleteDatabase(mh),r=setTimeout((()=>t(!1)),200);n.addEventListener("success",(()=>(clearTimeout(r),e(!0)))),n.addEventListener("blocked",(()=>(clearTimeout(r),e(!0)))),n.addEventListener("error",(()=>(clearTimeout(r),t(!1))))}))}}class Gp{constructor(){this.cache=new Map}getItem(e){return this.cache.get(e)||null}setItem(e,t){this.cache.set(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach(((t,n)=>{e.push(n)})),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}}class Jp{constructor(e){this.inMemoryCache=new Gp,this.indexedDBCache=new Yp,this.logger=e}handleDatabaseAccessError(e){if(!(e instanceof wp&&e.errorCode===lp))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")}async getItem(e){const t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(n){this.handleDatabaseAccessError(n)}return t}async setItem(e,t){this.inMemoryCache.setItem(e,t);try{await this.indexedDBCache.setItem(e,t)}catch(n){this.handleDatabaseAccessError(n)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(t){this.handleDatabaseAccessError(t)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(0===e.length)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(t){this.handleDatabaseAccessError(t)}return e}async containsKey(e){const t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(n){this.handleDatabaseAccessError(n)}return t}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}class Xp{constructor(e,t){this.logger=e,function(e){if(!("crypto"in window))throw e.error("BrowserCrypto: crypto interface is unavailable"),_p(Ah);e.verbose("BrowserCrypto: modern crypto interface available")}(e),this.cache=new Jp(this.logger),this.performanceClient=t}createNewGuid(){return Vp()}base64Encode(e){return Bp(e)}base64Decode(e){return Lp(e)}base64UrlEncode(e){return xp(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){const t=this.performanceClient?.startMeasurement(hu,e.correlationId),n=await async function(e,t){return window.crypto.subtle.generateKey(Hp,e,t)}(Xp.EXTRACTABLE,Xp.POP_KEY_USAGES),r=await Wp(n.publicKey),i=Zp({e:r.e,kty:r.kty,n:r.n}),o=await this.hashString(i),s=await Wp(n.privateKey),a=await async function(e,t,n){return window.crypto.subtle.importKey("jwk",e,Hp,t,n)}(s,!1,["sign"]);return await this.cache.setItem(o,{privateKey:a,publicKey:n.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),t&&t.end({success:!0}),o}async removeTokenBindingKey(e){await this.cache.removeItem(e);return!await this.cache.containsKey(e)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error(`Clearing keystore failed with error: ${e.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,t,n,r){const i=this.performanceClient?.startMeasurement(pu,r),o=await this.cache.getItem(t);if(!o)throw _p(op);const s=await Wp(o.publicKey),a=Zp(s),c=xp(JSON.stringify({kid:t})),l=xp(Pp.getShrHeaderString({...n?.header,alg:s.alg,kid:c}));e.cnf={jwk:JSON.parse(a)};const u=`${l}.${xp(JSON.stringify(e))}`,d=(new TextEncoder).encode(u),h=await async function(e,t){return window.crypto.subtle.sign(Hp,e,t)}(o.privateKey,d),p=`${u}.${Np(new Uint8Array(h))}`;return i&&i.end({success:!0}),p}async hashString(e){return Qp(e)}}function Zp(e){return JSON.stringify(e,Object.keys(e).sort())}Xp.POP_KEY_USAGES=["sign","verify"],Xp.EXTRACTABLE=!0;const ef=(e,t,n,r,i)=>function(){n.trace(`Executing function ${t}`);const o=r?.startMeasurement(t,i);if(i){const e=t+"CallCount";r?.incrementFields({[e]:1},i)}try{const r=e(...arguments);return o?.end({success:!0}),n.trace(`Returning result from ${t}`),r}catch(s){n.trace(`Error occurred in ${t}`);try{n.trace(JSON.stringify(s))}catch(s){n.trace("Unable to print error message.")}throw o?.end({success:!1},s),s}},tf=(e,t,n,r,i)=>function(){n.trace(`Executing function ${t}`);const o=r?.startMeasurement(t,i);if(i){const e=t+"CallCount";r?.incrementFields({[e]:1},i)}return r?.setPreQueueTime(t,i),e(...arguments).then((e=>(n.trace(`Returning result from ${t}`),o?.end({success:!0}),e))).catch((e=>{n.trace(`Error occurred in ${t}`);try{n.trace(JSON.stringify(e))}catch(e){n.trace("Unable to print error message.")}throw o?.end({success:!1},e),e}))};class nf{constructor(e,t,n,r){this.networkInterface=e,this.logger=t,this.performanceClient=n,this.correlationId=r}async detectRegion(e,t){this.performanceClient?.addQueueMeasurement(ud,this.correlationId);let n=e;if(n)t.region_source=pa;else{const e=nf.IMDS_OPTIONS;try{const r=await tf(this.getRegionFromIMDS.bind(this),dd,this.logger,this.performanceClient,this.correlationId)(us.IMDS_VERSION,e);if(r.status===ua&&(n=r.body,t.region_source=fa),r.status===da){const r=await tf(this.getCurrentVersion.bind(this),hd,this.logger,this.performanceClient,this.correlationId)(e);if(!r)return t.region_source=ha,null;const i=await tf(this.getRegionFromIMDS.bind(this),dd,this.logger,this.performanceClient,this.correlationId)(r,e);i.status===ua&&(n=i.body,t.region_source=fa)}}catch(r){return t.region_source=ha,null}}return n||(t.region_source=ha),n||null}async getRegionFromIMDS(e,t){return this.performanceClient?.addQueueMeasurement(dd,this.correlationId),this.networkInterface.sendGetRequestAsync(`${us.IMDS_ENDPOINT}?api-version=${e}&format=text`,t,us.IMDS_TIMEOUT)}async getCurrentVersion(e){this.performanceClient?.addQueueMeasurement(hd,this.correlationId);try{const t=await this.networkInterface.sendGetRequestAsync(`${us.IMDS_ENDPOINT}?format=json`,e);return t.status===da&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?t.body["newest-versions"][0]:null}catch(t){return null}}}nf.IMDS_OPTIONS={headers:{Metadata:"true"}};class rf{constructor(e,t,n,r,i,o,s,a){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=n,this.authorityOptions=r,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=i,this.performanceClient=s,this.correlationId=o,this.managedIdentity=a||!1,this.regionDiscovery=new nf(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(us.CIAM_AUTH_URL))return Pl;const t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case us.ADFS:return Rl;case us.DSTS:return Ol}return Ml}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new Ll(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw kc(Fa)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw kc(Fa)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw kc(Fa)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw kc(yc);return this.replacePath(this.metadata.end_session_endpoint)}throw kc(Fa)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw kc(Fa)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw kc(Fa)}canReplaceTenant(e){return 1===e.PathSegments.length&&!rf.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===Ml&&this.protocolMode===ka}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e;const n=new Ll(this.metadata.canonical_authority).getUrlComponents(),r=n.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach(((e,i)=>{let o=r[i];if(0===i&&this.canReplaceTenant(n)){const e=new Ll(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];o!==e&&(this.logger.verbose(`Replacing tenant domain name ${o} with id ${e}`),o=e)}e!==o&&(t=t.replace(`/${o}/`,`/${e}/`))})),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===Rl||this.protocolMode!==ka&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){this.performanceClient?.addQueueMeasurement(id,this.correlationId);const e=this.getCurrentMetadataEntity(),t=await tf(this.updateCloudDiscoveryMetadata.bind(this),sd,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);const n=await tf(this.updateEndpointMetadata.bind(this),cd,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,t,{source:n}),this.performanceClient?.addFields({cloudDiscoverySource:t,authorityEndpointSource:n},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:Wc(),jwks_uri:""}),e}updateCachedMetadata(e,t,n){t!==Js&&n?.source!==Js&&(e.expiresAt=Wc(),e.canonical_authority=this.canonicalAuthority);const r=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(r,e),this.metadata=e}async updateEndpointMetadata(e){this.performanceClient?.addQueueMeasurement(cd,this.correlationId);const t=this.updateEndpointMetadataFromLocalSources(e);if(t){if(t.source===Zs&&this.authorityOptions.azureRegionConfiguration?.azureRegion&&t.metadata){Qc(e,await tf(this.updateMetadataWithRegionalInformation.bind(this),ld,this.logger,this.performanceClient,this.correlationId)(t.metadata),!1),e.canonical_authority=this.canonicalAuthority}return t.source}let n=await tf(this.getEndpointMetadataFromNetwork.bind(this),ad,this.logger,this.performanceClient,this.correlationId)();if(n)return this.authorityOptions.azureRegionConfiguration?.azureRegion&&(n=await tf(this.updateMetadataWithRegionalInformation.bind(this),ld,this.logger,this.performanceClient,this.correlationId)(n)),Qc(e,n,!0),Xs;throw kc(qa,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),Qc(e,t,!1),{source:Gs};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const t=this.getEndpointMetadataFromHardcodedValues();if(t)return Qc(e,t,!1),{source:Zs,metadata:t};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const n=Gc(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!n?(this.logger.verbose("Found endpoint metadata in the cache."),{source:Js}):(n&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new Ll(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw _l(ul)}return null}async getEndpointMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(ad,this.correlationId);const e={},t=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${t}`);try{const n=await this.networkInterface.sendGetRequestAsync(t,e),r=function(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("jwks_uri")}(n.body);return r?n.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(n){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${n}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in Fl?Fl[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){this.performanceClient?.addQueueMeasurement(ld,this.correlationId);const t=this.authorityOptions.azureRegionConfiguration?.azureRegion;if(t){if(t!==us.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=ga,this.regionDiscoveryMetadata.region_used=t,rf.replaceWithRegionalInformation(e,t);const n=await tf(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),ud,this.logger,this.performanceClient,this.correlationId)(this.authorityOptions.azureRegionConfiguration?.environmentRegion,this.regionDiscoveryMetadata);if(n)return this.regionDiscoveryMetadata.region_outcome=ma,this.regionDiscoveryMetadata.region_used=n,rf.replaceWithRegionalInformation(e,n);this.regionDiscoveryMetadata.region_outcome=ya}return e}async updateCloudDiscoveryMetadata(e){this.performanceClient?.addQueueMeasurement(sd,this.correlationId);const t=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(t)return t;const n=await tf(this.getCloudDiscoveryMetadataFromNetwork.bind(this),od,this.logger,this.performanceClient,this.correlationId)();if(n)return Yc(e,n,!0),Xs;throw _l(dl)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||us.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||us.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||us.NOT_APPLICABLE}`);const t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),Yc(e,t,!1),Gs;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const t=(n=this.hostnameAndPort,Hl(Ul.metadata,n));if(t)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),Yc(e,t,!1),Zs;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}var n;const r=Gc(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!r?(this.logger.verbose("Found cloud discovery metadata in the cache."),Js):(r&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===Pl)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),rf.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=Hl(JSON.parse(this.authorityOptions.cloudDiscoveryMetadata).metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),e)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),e;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(e){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),_l(ll)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),rf.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(od,this.correlationId);const e=`${us.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,t={};let n=null;try{const r=await this.networkInterface.sendGetRequestAsync(e,t);let i,o;if(function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(r.body))i=r.body,o=i.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${i.tenant_discovery_endpoint}`);else{if(!function(e){return e.hasOwnProperty("error")&&e.hasOwnProperty("error_description")}(r.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${r.status}`),i=r.body,i.error===us.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${i.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${i.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),o=[]}this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),n=Hl(o,this.hostnameAndPort)}catch(r){if(r instanceof Pa)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.\nError: ${r.errorCode}\nError Description: ${r.errorMessage}`);else{const e=r;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: ${e.name}\nError Description: ${e.message}`)}return null}return n||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),n=rf.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),n}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter((e=>e&&Ll.getDomainFromUrl(e).toLowerCase()===this.hostnameAndPort)).length>0}static generateAuthority(e,t){let n;if(t&&t.azureCloudInstance!==Ea){const e=t.tenant?t.tenant:us.DEFAULT_COMMON_TENANT;n=`${t.azureCloudInstance}/${e}/`}return n||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return us.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw kc(Fa)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return ql.has(e)}static isPublicCloudAuthority(e){return us.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,n){const r=new Ll(e);r.validateAsUri();const i=r.getUrlComponents();let o=`${t}.${i.HostNameAndPort}`;this.isPublicCloudAuthority(i.HostNameAndPort)&&(o=`${t}.${us.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const s=Ll.constructAuthorityUriFromObject({...r.getUrlComponents(),HostNameAndPort:o}).urlString;return n?`${s}?${n}`:s}static replaceWithRegionalInformation(e,t){const n={...e};return n.authorization_endpoint=rf.buildRegionalAuthorityString(n.authorization_endpoint,t),n.token_endpoint=rf.buildRegionalAuthorityString(n.token_endpoint,t),n.end_session_endpoint&&(n.end_session_endpoint=rf.buildRegionalAuthorityString(n.end_session_endpoint,t)),n}static transformCIAMAuthority(e){let t=e;const n=new Ll(e).getUrlComponents();if(0===n.PathSegments.length&&n.HostNameAndPort.endsWith(us.CIAM_AUTH_URL)){t=`${t}${n.HostNameAndPort.split(".")[0]}${us.AAD_TENANT_DOMAIN_SUFFIX}`}return t}}function of(e){return e.endsWith(us.FORWARD_SLASH)?e:`${e}${us.FORWARD_SLASH}`}rf.reservedTenantDomains=new Set(["{tenant}","{tenantid}",Ms,Os,Rs]);const sf="no_tokens_found",af="native_account_unavailable",cf="refresh_token_expired",lf="bad_token",uf=["interaction_required","consent_required","login_required",lf],df=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],hf={[sf]:"No refresh token found in the cache. Please sign-in.",[af]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[cf]:"Refresh token has expired.",[lf]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."};class pf extends Pa{constructor(e,t,n,r,i,o,s,a){super(e,t,n),Object.setPrototypeOf(this,pf.prototype),this.timestamp=r||us.EMPTY_STRING,this.traceId=i||us.EMPTY_STRING,this.correlationId=o||us.EMPTY_STRING,this.claims=s||us.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=a}}function ff(e,t,n){const r=!!e&&uf.indexOf(e)>-1,i=!!n&&df.indexOf(n)>-1,o=!!t&&uf.some((e=>t.indexOf(e)>-1));return r||o||i}function gf(e){return new pf(e,hf[e])}class mf{static setRequestState(e,t,n){const r=mf.generateLibraryState(e,n);return t?`${r}${us.RESOURCE_DELIM}${t}`:r}static generateLibraryState(e,t){if(!e)throw kc(cc);const n={id:e.createNewGuid()};t&&(n.meta=t);const r=JSON.stringify(n);return e.base64Encode(r)}static parseRequestState(e,t){if(!e)throw kc(cc);if(!t)throw kc(Ha);try{const n=t.split(us.RESOURCE_DELIM),r=n[0],i=n.length>1?n.slice(1).join(us.RESOURCE_DELIM):us.EMPTY_STRING,o=e.base64Decode(r),s=JSON.parse(o);return{userRequestState:i||us.EMPTY_STRING,libraryState:s}}catch(n){throw kc(Ha)}}}const yf="home_account_id",vf="UPN",bf="storage_not_supported",wf="stubbed_public_client_application_called",_f="in_mem_redirect_unavailable",Cf={[bf]:"Given storage configuration option was not supported.",[wf]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[_f]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};class If extends Pa{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,If.prototype)}}function Tf(e){return new If(e,Cf[e])}class Sf{constructor(e){this.validateWindowStorage(e),this.windowStorage=window[e]}validateWindowStorage(e){if(e!==zd&&e!==Hd||!window[e])throw Tf(bf)}getItem(e){return this.windowStorage.getItem(e)}setItem(e,t){this.windowStorage.setItem(e,t)}removeItem(e){this.windowStorage.removeItem(e)}getKeys(){return Object.keys(this.windowStorage)}containsKey(e){return this.windowStorage.hasOwnProperty(e)}}function kf(e,t){if(!t)return null;try{return mf.parseRequestState(e,t).libraryState.meta}catch(n){throw kc(Ha)}}class Af extends Wl{constructor(e,t,n,r,i,o){super(e,n,r,i),this.COOKIE_LIFE_MULTIPLIER=864e5,this.cacheConfig=t,this.logger=r,this.internalStorage=new Gp,this.browserStorage=this.setupBrowserStorage(this.cacheConfig.cacheLocation),this.temporaryCacheStorage=this.setupTemporaryCacheStorage(this.cacheConfig.temporaryCacheLocation,this.cacheConfig.cacheLocation),t.cacheMigrationEnabled&&(this.migrateCacheEntries(),this.createKeyMaps()),this.performanceClient=o}setupBrowserStorage(e){switch(e){case zd:case Hd:try{return new Sf(e)}catch(t){this.logger.verbose(t);break}}return this.cacheConfig.cacheLocation=$d,new Gp}setupTemporaryCacheStorage(e,t){switch(t){case zd:case Hd:try{return new Sf(e||Hd)}catch(n){return this.logger.verbose(n),this.internalStorage}default:return this.internalStorage}}migrateCacheEntries(){const e=`${us.CACHE_PREFIX}.${Cs}`,t=`${us.CACHE_PREFIX}.${Is}`,n=`${us.CACHE_PREFIX}.${Ss}`,r=`${us.CACHE_PREFIX}.${ks}`,i=[this.browserStorage.getItem(e),this.browserStorage.getItem(t),this.browserStorage.getItem(n),this.browserStorage.getItem(r)];[Cs,Is,Ss,ks].forEach(((e,t)=>{const n=i[t];n&&this.setTemporaryCache(e,n,!0)}))}createKeyMaps(){this.logger.trace("BrowserCacheManager - createKeyMaps called.");const e=this.getItem(nh),t=this.getItem(`${rh}.${this.clientId}`);if(e&&t)return void this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration.");this.browserStorage.getKeys().forEach((e=>{if(this.isCredentialKey(e)){const t=this.getItem(e);if(t){const n=this.validateAndParseJson(t);if(n&&n.hasOwnProperty("credentialType"))switch(n.credentialType){case Ks.ID_TOKEN:if(qc(n)){this.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - idToken with key: ${e} found, saving key to token key map`);const t=n,r=this.updateCredentialCacheKey(e,t);return void this.addTokenKey(r,Ks.ID_TOKEN)}this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed idToken validation on key: ${e}`);break;case Ks.ACCESS_TOKEN:case Ks.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(Uc(n)){this.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - accessToken with key: ${e} found, saving key to token key map`);const t=n,r=this.updateCredentialCacheKey(e,t);return void this.addTokenKey(r,Ks.ACCESS_TOKEN)}this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed accessToken validation on key: ${e}`);break;case Ks.REFRESH_TOKEN:if(zc(n)){this.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - refreshToken with key: ${e} found, saving key to token key map`);const t=n,r=this.updateCredentialCacheKey(e,t);return void this.addTokenKey(r,Ks.REFRESH_TOKEN)}this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: ${e}`)}}}if(this.isAccountKey(e)){const t=this.getItem(e);if(t){const n=this.validateAndParseJson(t);n&&Nl.isAccountEntity(n)&&(this.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - account with key: ${e} found, saving key to account key map`),this.addAccountKeyToMap(e))}}}))}validateAndParseJson(e){try{const t=JSON.parse(e);return t&&"object"===typeof t?t:null}catch(t){return null}}getItem(e){return this.browserStorage.getItem(e)}setItem(e,t){this.browserStorage.setItem(e,t)}getAccount(e,t){this.logger.trace("BrowserCacheManager.getAccount called");const n=this.getCachedAccountEntity(e);return this.updateOutdatedCachedAccount(e,n,t)}getCachedAccountEntity(e){const t=this.getItem(e);if(!t)return this.removeAccountKeyFromMap(e),null;const n=this.validateAndParseJson(t);return n&&Nl.isAccountEntity(n)?Wl.toObject(new Nl,n):(this.removeAccountKeyFromMap(e),null)}setAccount(e){this.logger.trace("BrowserCacheManager.setAccount called");const t=e.generateAccountKey();this.setItem(t,JSON.stringify(e)),this.addAccountKeyToMap(t)}getAccountKeys(){this.logger.trace("BrowserCacheManager.getAccountKeys called");const e=this.getItem(nh);return e?JSON.parse(e):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])}addAccountKeyToMap(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);const t=this.getAccountKeys();-1===t.indexOf(e)?(t.push(e),this.setItem(nh,JSON.stringify(t)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")}removeAccountKeyFromMap(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);const t=this.getAccountKeys(),n=t.indexOf(e);n>-1?(t.splice(n,1),this.setItem(nh,JSON.stringify(t)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}async removeAccount(e){super.removeAccount(e),this.removeAccountKeyFromMap(e)}removeOutdatedAccount(e){this.removeItem(e),this.removeAccountKeyFromMap(e)}removeIdToken(e){super.removeIdToken(e),this.removeTokenKey(e,Ks.ID_TOKEN)}async removeAccessToken(e){super.removeAccessToken(e),this.removeTokenKey(e,Ks.ACCESS_TOKEN)}removeRefreshToken(e){super.removeRefreshToken(e),this.removeTokenKey(e,Ks.REFRESH_TOKEN)}getTokenKeys(){this.logger.trace("BrowserCacheManager.getTokenKeys called");const e=this.getItem(`${rh}.${this.clientId}`);if(e){const t=this.validateAndParseJson(e);if(t&&t.hasOwnProperty("idToken")&&t.hasOwnProperty("accessToken")&&t.hasOwnProperty("refreshToken"))return t;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}}addTokenKey(e,t){this.logger.trace("BrowserCacheManager addTokenKey called");const n=this.getTokenKeys();switch(t){case Ks.ID_TOKEN:-1===n.idToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),n.idToken.push(e));break;case Ks.ACCESS_TOKEN:-1===n.accessToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),n.accessToken.push(e));break;case Ks.REFRESH_TOKEN:-1===n.refreshToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),n.refreshToken.push(e));break;default:throw this.logger.error(`BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ${t}`),kc(lc)}this.setItem(`${rh}.${this.clientId}`,JSON.stringify(n))}removeTokenKey(e,t){this.logger.trace("BrowserCacheManager removeTokenKey called");const n=this.getTokenKeys();switch(t){case Ks.ID_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ${e} from map`);const r=n.idToken.indexOf(e);r>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),n.idToken.splice(r,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case Ks.ACCESS_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ${e} from map`);const i=n.accessToken.indexOf(e);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),n.accessToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case Ks.REFRESH_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ${e} from map`);const o=n.refreshToken.indexOf(e);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),n.refreshToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error(`BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ${t}`),kc(lc)}this.setItem(`${rh}.${this.clientId}`,JSON.stringify(n))}getIdTokenCredential(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,Ks.ID_TOKEN),null;const n=this.validateAndParseJson(t);return n&&qc(n)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),n):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,Ks.ID_TOKEN),null)}setIdTokenCredential(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const t=Nc(e);this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,Ks.ID_TOKEN)}getAccessTokenCredential(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,Ks.ACCESS_TOKEN),null;const n=this.validateAndParseJson(t);return n&&Uc(n)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),n):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,Ks.ACCESS_TOKEN),null)}setAccessTokenCredential(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const t=Nc(e);this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,Ks.ACCESS_TOKEN)}getRefreshTokenCredential(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,Ks.REFRESH_TOKEN),null;const n=this.validateAndParseJson(t);return n&&zc(n)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),n):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,Ks.REFRESH_TOKEN),null)}setRefreshTokenCredential(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const t=Nc(e);this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,Ks.REFRESH_TOKEN)}getAppMetadata(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&(r=e,(i=n)&&0===r.indexOf(Vs)&&i.hasOwnProperty("clientId")&&i.hasOwnProperty("environment"))?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),n):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null);var r,i}setAppMetadata(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");const t=function(e){let{environment:t,clientId:n}=e;return[Vs,t,n].join($s).toLowerCase()}(e);this.setItem(t,JSON.stringify(e))}getServerTelemetry(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&function(e,t){const n=0===e.indexOf(ea.CACHE_KEY);let r=!0;return t&&(r=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),n&&r}(e,n)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),n):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)}setServerTelemetry(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t))}getAuthorityMetadata(e){const t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&function(e,t){return!!t&&0===e.indexOf(Qs)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri")}(e,n)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),n):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter((e=>this.isAuthorityMetadata(e)))}setWrapperMetadata(e,t){this.internalStorage.setItem(ih,e),this.internalStorage.setItem(oh,t)}getWrapperMetadata(){return[this.internalStorage.getItem(ih)||us.EMPTY_STRING,this.internalStorage.getItem(oh)||us.EMPTY_STRING]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(){const e=this.generateCacheKey(Es),t=this.getItem(e);if(!t){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");const e=this.generateCacheKey(As),t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;const n=this.getAccountInfoFilteredBy({localAccountId:t});return n?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(n),n):null}const n=this.validateAndParseJson(t);return n?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:n.homeAccountId,localAccountId:n.localAccountId,tenantId:n.tenantId})):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e){const t=this.generateCacheKey(Es),n=this.generateCacheKey(As);if(e){this.logger.verbose("setActiveAccount: Active account set");const r={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId};this.browserStorage.setItem(t,JSON.stringify(r)),this.browserStorage.setItem(n,e.localAccountId)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t),this.browserStorage.removeItem(n)}getThrottlingCache(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&function(e,t){let n=!1;e&&(n=0===e.indexOf(ia));let r=!0;return t&&(r=t.hasOwnProperty("throttleTime")),n&&r}(e,n)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),n):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)}setThrottlingCache(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t))}getTemporaryCache(e,t){const n=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const e=this.getItemCookie(n);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),e}const r=this.temporaryCacheStorage.getItem(n);if(!r){if(this.cacheConfig.cacheLocation===zd){const e=this.browserStorage.getItem(n);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),e}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),r}setTemporaryCache(e,t,n){const r=n?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(r,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(r,t))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(e))}getKeys(){return this.browserStorage.getKeys()}async clear(){await this.removeAllAccounts(),this.removeAppMetadata(),this.temporaryCacheStorage.getKeys().forEach((e=>{-1===e.indexOf(us.CACHE_PREFIX)&&-1===e.indexOf(this.clientId)||this.removeTemporaryItem(e)})),this.browserStorage.getKeys().forEach((e=>{-1===e.indexOf(us.CACHE_PREFIX)&&-1===e.indexOf(this.clientId)||this.browserStorage.removeItem(e)})),this.internalStorage.clear()}async clearTokensAndKeysWithClaims(e,t){e.addQueueMeasurement(vd,t);const n=this.getTokenKeys(),r=[];n.accessToken.forEach((e=>{const t=this.getAccessTokenCredential(e);t?.requestedClaimsHash&&e.includes(t.requestedClaimsHash.toLowerCase())&&r.push(this.removeAccessToken(e))})),await Promise.all(r),r.length>0&&this.logger.warning(`${r.length} access tokens with claims in the cache keys have been removed from the cache.`)}setItemCookie(e,t,n){let r=`${encodeURIComponent(e)}=${encodeURIComponent(t)};path=/;SameSite=Lax;`;if(n){r+=`expires=${this.getCookieExpirationTime(n)};`}this.cacheConfig.secureCookies&&(r+="Secure;"),document.cookie=r}getItemCookie(e){const t=`${encodeURIComponent(e)}=`,n=document.cookie.split(";");for(let r=0;r<n.length;r++){let e=n[r];for(;" "===e.charAt(0);)e=e.substring(1);if(0===e.indexOf(t))return decodeURIComponent(e.substring(t.length,e.length))}return us.EMPTY_STRING}clearMsalCookies(){const e=`${us.CACHE_PREFIX}.${this.clientId}`;document.cookie.split(";").forEach((t=>{for(;" "===t.charAt(0);)t=t.substring(1);if(0===t.indexOf(e)){const e=t.split("=")[0];this.clearItemCookie(e)}}))}clearItemCookie(e){this.setItemCookie(e,us.EMPTY_STRING,-1)}getCookieExpirationTime(e){const t=new Date;return new Date(t.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):Cl.startsWith(e,us.CACHE_PREFIX)||Cl.startsWith(e,Ts)?e:`${us.CACHE_PREFIX}.${this.clientId}.${e}`}generateAuthorityKey(e){const{libraryState:{id:t}}=mf.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${Vd}.${t}`)}generateNonceKey(e){const{libraryState:{id:t}}=mf.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${Qd}.${t}`)}generateStateKey(e){const{libraryState:{id:t}}=mf.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${Wd}.${t}`)}getCachedAuthority(e){const t=this.generateStateKey(e),n=this.getTemporaryCache(t);if(!n)return null;const r=this.generateAuthorityKey(n);return this.getTemporaryCache(r)}updateCacheEntries(e,t,n,r,i){this.logger.trace("BrowserCacheManager.updateCacheEntries called");const o=this.generateStateKey(e);this.setTemporaryCache(o,e,!1);const s=this.generateNonceKey(e);this.setTemporaryCache(s,t,!1);const a=this.generateAuthorityKey(e);if(this.setTemporaryCache(a,n,!1),i){const e={credential:i.homeAccountId,type:yf};this.setTemporaryCache(Zd,JSON.stringify(e),!0)}else if(r){const e={credential:r,type:vf};this.setTemporaryCache(Zd,JSON.stringify(e),!0)}}resetRequestCache(e){this.logger.trace("BrowserCacheManager.resetRequestCache called"),e&&(this.temporaryCacheStorage.getKeys().forEach((t=>{-1!==t.indexOf(e)&&this.removeTemporaryItem(t)})),this.removeTemporaryItem(this.generateStateKey(e)),this.removeTemporaryItem(this.generateNonceKey(e)),this.removeTemporaryItem(this.generateAuthorityKey(e))),this.removeTemporaryItem(this.generateCacheKey(Jd)),this.removeTemporaryItem(this.generateCacheKey(Yd)),this.removeTemporaryItem(this.generateCacheKey(Gd)),this.removeTemporaryItem(this.generateCacheKey(eh)),this.removeTemporaryItem(this.generateCacheKey(Zd)),this.removeTemporaryItem(this.generateCacheKey(th)),this.setInteractionInProgress(!1)}cleanRequestByState(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){const t=this.generateStateKey(e),n=this.temporaryCacheStorage.getItem(t);this.logger.infoPii(`BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: ${n}`),this.resetRequestCache(n||us.EMPTY_STRING)}this.clearMsalCookies()}cleanRequestByInteractionType(e){this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.temporaryCacheStorage.getKeys().forEach((t=>{if(-1===t.indexOf(Wd))return;const n=this.temporaryCacheStorage.getItem(t);if(!n)return;const r=kf(this.cryptoImpl,n);r&&r.interactionType===e&&(this.logger.infoPii(`BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: ${n}`),this.resetRequestCache(n))})),this.clearMsalCookies(),this.setInteractionInProgress(!1)}cacheCodeRequest(e){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");const t=Bp(JSON.stringify(e));this.setTemporaryCache(Jd,t,!0)}getCachedRequest(e){this.logger.trace("BrowserCacheManager.getCachedRequest called");const t=this.getTemporaryCache(Jd,!0);if(!t)throw _p(Wh);let n;try{n=JSON.parse(Lp(t))}catch(r){throw this.logger.errorPii(`Attempted to parse: ${t}`),this.logger.error(`Parsing cached token request threw with error: ${r}`),_p(Qh)}if(this.removeTemporaryItem(this.generateCacheKey(Jd)),!n.authority){const t=this.generateAuthorityKey(e),r=this.getTemporaryCache(t);if(!r)throw _p(Yh);n.authority=r}return n}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(th,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;const t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){const t=this.getInteractionInProgress();return e?t===this.clientId:!!t}getInteractionInProgress(){const e=`${us.CACHE_PREFIX}.${Xd}`;return this.getTemporaryCache(e,!1)}setInteractionInProgress(e){const t=`${us.CACHE_PREFIX}.${Xd}`;if(e){if(this.getInteractionInProgress())throw _p(Nh);this.setTemporaryCache(t,this.clientId,!1)}else e||this.getInteractionInProgress()!==this.clientId||this.removeTemporaryItem(t)}getLegacyLoginHint(){const e=this.getTemporaryCache(Ts);e&&(this.browserStorage.removeItem(Ts),this.logger.verbose("Cached ADAL id token retrieved."));const t=this.getTemporaryCache(Cs,!0);t&&(this.browserStorage.removeItem(this.generateCacheKey(Cs)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));const n=t||e;if(n){const e=Rc(n,Lp);if(e.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),e.preferred_username;if(e.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),e.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null}updateCredentialCacheKey(e,t){const n=Nc(t);if(e!==n){const r=this.getItem(e);if(r)return this.browserStorage.removeItem(e),this.setItem(n,r),this.logger.verbose(`Updated an outdated ${t.credentialType} cache key`),n;this.logger.error(`Attempted to update an outdated ${t.credentialType} cache key but no item matching the outdated key was found in storage`)}return e}async hydrateCache(e,t){const n=Bc(e.account?.homeAccountId,e.account?.environment,e.idToken,this.clientId,e.tenantId);let r;t.claims&&(r=await this.cryptoImpl.hashString(t.claims));const i={idToken:n,accessToken:Dc(e.account?.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?e.expiresOn.getTime()/1e3:0,e.extExpiresOn?e.extExpiresOn.getTime()/1e3:0,Lp,void 0,e.tokenType,void 0,t.sshKid,t.claims,r)};return this.saveCacheRecord(i)}async saveCacheRecord(e,t,n){try{await super.saveCacheRecord(e,t,n)}catch(r){if(r instanceof Vl&&this.performanceClient&&n)try{const e=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:e.refreshToken.length,cacheIdCount:e.idToken.length,cacheAtCount:e.accessToken.length},n)}catch(r){}throw r}}}function Ef(){return window.parent!==window}function Mf(){return window.location.href.split("?")[0].split("#")[0]}function Rf(){if("undefined"!==typeof window&&window.opener&&window.opener!==window&&"string"===typeof window.name&&0===window.name.indexOf(`${Od}.`))throw _p(Hh)}function Of(){if("undefined"===typeof window)throw _p(Xh)}function Pf(e){if(!e)throw _p(fp)}function xf(e){Of(),function(){if(Ll.hashContainsKnownProperties(window.location.hash)&&Ef())throw _p(zh)}(),Rf(),Pf(e)}function Nf(e,t){if(xf(e),function(e){if(Ef()&&!e)throw _p(qh)}(t.system.allowRedirectInIframe),t.cache.cacheLocation===$d&&!t.cache.storeAuthStateInCookie)throw Tf(_f)}function Bf(e){const t=document.createElement("link");t.rel="preconnect",t.href=new URL(e).origin,t.crossOrigin="anonymous",document.head.appendChild(t),window.setTimeout((()=>{try{document.head.removeChild(t)}catch{}}),1e4)}const Df="msal:initializeStart",Lf="msal:initializeEnd",Ff="msal:accountAdded",Uf="msal:accountRemoved",qf="msal:activeAccountChanged",zf="msal:loginStart",Hf="msal:loginSuccess",$f="msal:loginFailure",jf="msal:acquireTokenStart",Kf="msal:acquireTokenSuccess",Vf="msal:acquireTokenFailure",Wf="msal:acquireTokenFromNetworkStart",Qf="msal:ssoSilentStart",Yf="msal:ssoSilentSuccess",Gf="msal:ssoSilentFailure",Jf="msal:acquireTokenByCodeStart",Xf="msal:acquireTokenByCodeSuccess",Zf="msal:acquireTokenByCodeFailure",eg="msal:handleRedirectStart",tg="msal:handleRedirectEnd",ng="msal:popupOpened",rg="msal:logoutStart",ig="msal:logoutSuccess",og="msal:logoutFailure",sg="msal:logoutEnd",ag="msal:restoreFromBFCache";class cg{constructor(e){this.eventCallbacks=new Map,this.logger=e||new Sa({})}addEventCallback(e,t,n){if("undefined"!==typeof window){const r=n||Vp();return this.eventCallbacks.has(r)?(this.logger.error(`Event callback with id: ${r} is already registered. Please provide a unique id or remove the existing callback and try again.`),null):(this.eventCallbacks.set(r,[e,t||[]]),this.logger.verbose(`Event callback registered with id: ${r}`),r)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}emitEvent(e,t,n,r){if("undefined"!==typeof window){const i={eventType:e,interactionType:t||null,payload:n||null,error:r||null,timestamp:Date.now()};this.eventCallbacks.forEach(((t,n)=>{let[r,o]=t;(0===o.length||o.includes(e))&&(this.logger.verbose(`Emitting event to callback ${n}: ${e}`),r.apply(null,[i]))}))}}}class lg extends Pa{constructor(e,t,n,r,i){super(e,t,n),this.name="ServerError",this.errorNo=r,this.status=i,Object.setPrototypeOf(this,lg.prototype)}}class ug{static generateThrottlingStorageKey(e){return`${ia}.${JSON.stringify(e)}`}static preProcess(e,t){const n=ug.generateThrottlingStorageKey(t),r=e.getThrottlingCache(n);if(r){if(r.throttleTime<Date.now())return void e.removeItem(n);throw new lg(r.errorCodes?.join(" ")||us.EMPTY_STRING,r.errorMessage,r.subError)}}static postProcess(e,t,n){if(ug.checkResponseStatus(n)||ug.checkResponseForRetryAfter(n)){const r={throttleTime:ug.calculateThrottleTime(parseInt(n.headers[vs])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};e.setThrottlingCache(ug.generateThrottlingStorageKey(t),r)}}static checkResponseStatus(e){return 429===e.status||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return!!e.headers&&(e.headers.hasOwnProperty(vs)&&(e.status<200||e.status>=300))}static calculateThrottleTime(e){const t=e<=0?0:e,n=Date.now()/1e3;return Math.floor(1e3*Math.min(n+(t||na),n+ra))}static removeThrottle(e,t,n,r){const i={clientId:t,authority:n.authority,scopes:n.scopes,homeAccountIdentifier:r,claims:n.claims,authenticationScheme:n.authenticationScheme,resourceRequestMethod:n.resourceRequestMethod,resourceRequestUri:n.resourceRequestUri,shrClaims:n.shrClaims,sshKid:n.sshKid},o=this.generateThrottlingStorageKey(i);e.removeItem(o)}}class dg{constructor(e,t){this.networkClient=e,this.cacheManager=t}async sendPostRequest(e,t,n){let r;ug.preProcess(this.cacheManager,e);try{r=await this.networkClient.sendPostRequestAsync(t,n)}catch(i){throw i instanceof Pa?i:kc(Ua)}return ug.postProcess(this.cacheManager,e,r),r}}const hg="client_id",pg="response_type",fg="token_type",gg="req_cnf",mg="return_spa_code",yg="x-client-xtra-sku";class vg{static validateRedirectUri(e){if(!e)throw _l(Jc)}static validatePrompt(e){const t=[];for(const n in Ns)t.push(Ns[n]);if(t.indexOf(e)<0)throw _l(rl)}static validateClaims(e){try{JSON.parse(e)}catch(t){throw _l(il)}}static validateCodeChallengeParams(e,t){if(!e||!t)throw _l(cl);this.validateCodeChallengeMethod(t)}static validateCodeChallengeMethod(e){if([Bs.PLAIN,Bs.S256].indexOf(e)<0)throw _l(al)}}class bg{constructor(){this.parameters=new Map}addResponseTypeCode(){this.parameters.set(pg,encodeURIComponent(us.CODE_RESPONSE_TYPE))}addResponseTypeForTokenAndIdToken(){this.parameters.set(pg,encodeURIComponent(`${us.TOKEN_RESPONSE_TYPE} ${us.ID_TOKEN_RESPONSE_TYPE}`))}addResponseMode(e){this.parameters.set("response_mode",encodeURIComponent(e||Ls.QUERY))}addNativeBroker(){this.parameters.set("nativebroker",encodeURIComponent("1"))}addScopes(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:gs;!t||n.includes("openid")||e.includes("openid")||n.push("openid");const r=t?[...e||[],...n]:e||[],i=new Il(r);this.parameters.set("scope",encodeURIComponent(i.printScopes()))}addClientId(e){this.parameters.set(hg,encodeURIComponent(e))}addRedirectUri(e){vg.validateRedirectUri(e),this.parameters.set("redirect_uri",encodeURIComponent(e))}addPostLogoutRedirectUri(e){vg.validateRedirectUri(e),this.parameters.set("post_logout_redirect_uri",encodeURIComponent(e))}addIdTokenHint(e){this.parameters.set("id_token_hint",encodeURIComponent(e))}addDomainHint(e){this.parameters.set("domain_hint",encodeURIComponent(e))}addLoginHint(e){this.parameters.set("login_hint",encodeURIComponent(e))}addCcsUpn(e){this.parameters.set(bs,encodeURIComponent(`UPN:${e}`))}addCcsOid(e){this.parameters.set(bs,encodeURIComponent(`Oid:${e.uid}@${e.utid}`))}addSid(e){this.parameters.set("sid",encodeURIComponent(e))}addClaims(e,t){const n=this.addClientCapabilitiesToClaims(e,t);vg.validateClaims(n),this.parameters.set("claims",encodeURIComponent(n))}addCorrelationId(e){this.parameters.set("client-request-id",encodeURIComponent(e))}addLibraryInfo(e){this.parameters.set("x-client-SKU",e.sku),this.parameters.set("x-client-VER",e.version),e.os&&this.parameters.set("x-client-OS",e.os),e.cpu&&this.parameters.set("x-client-CPU",e.cpu)}addApplicationTelemetry(e){e?.appName&&this.parameters.set("x-app-name",e.appName),e?.appVersion&&this.parameters.set("x-app-ver",e.appVersion)}addPrompt(e){vg.validatePrompt(e),this.parameters.set("prompt",encodeURIComponent(e))}addState(e){e&&this.parameters.set("state",encodeURIComponent(e))}addNonce(e){this.parameters.set("nonce",encodeURIComponent(e))}addCodeChallengeParams(e,t){if(vg.validateCodeChallengeParams(e,t),!e||!t)throw _l(cl);this.parameters.set("code_challenge",encodeURIComponent(e)),this.parameters.set("code_challenge_method",encodeURIComponent(t))}addAuthorizationCode(e){this.parameters.set("code",encodeURIComponent(e))}addDeviceCode(e){this.parameters.set("device_code",encodeURIComponent(e))}addRefreshToken(e){this.parameters.set("refresh_token",encodeURIComponent(e))}addCodeVerifier(e){this.parameters.set("code_verifier",encodeURIComponent(e))}addClientSecret(e){this.parameters.set("client_secret",encodeURIComponent(e))}addClientAssertion(e){e&&this.parameters.set("client_assertion",encodeURIComponent(e))}addClientAssertionType(e){e&&this.parameters.set("client_assertion_type",encodeURIComponent(e))}addOboAssertion(e){this.parameters.set("assertion",encodeURIComponent(e))}addRequestTokenUse(e){this.parameters.set("requested_token_use",encodeURIComponent(e))}addGrantType(e){this.parameters.set("grant_type",encodeURIComponent(e))}addClientInfo(){this.parameters.set("client_info","1")}addExtraQueryParameters(e){Object.entries(e).forEach((e=>{let[t,n]=e;!this.parameters.has(t)&&n&&this.parameters.set(t,n)}))}addClientCapabilitiesToClaims(e,t){let n;if(e)try{n=JSON.parse(e)}catch(r){throw _l(il)}else n={};return t&&t.length>0&&(n.hasOwnProperty(Ps)||(n[Ps]={}),n[Ps][xs]={values:t}),JSON.stringify(n)}addUsername(e){this.parameters.set(ca,encodeURIComponent(e))}addPassword(e){this.parameters.set(la,encodeURIComponent(e))}addPopToken(e){e&&(this.parameters.set(fg,ta.POP),this.parameters.set(gg,encodeURIComponent(e)))}addSshJwk(e){e&&(this.parameters.set(fg,ta.SSH),this.parameters.set(gg,encodeURIComponent(e)))}addServerTelemetry(e){this.parameters.set("x-client-current-telemetry",e.generateCurrentRequestHeaderValue()),this.parameters.set("x-client-last-telemetry",e.generateLastRequestHeaderValue())}addThrottling(){this.parameters.set("x-ms-lib-capability",oa)}addLogoutHint(e){this.parameters.set("logout_hint",encodeURIComponent(e))}createQueryString(){const e=new Array;return this.parameters.forEach(((t,n)=>{e.push(`${n}=${t}`)})),e.join("&")}}async function wg(e,t,n,r,i,o,s){s?.addQueueMeasurement(rd,o);const a=rf.transformCIAMAuthority(of(e)),c=new rf(a,t,n,r,i,o,s);try{return await tf(c.resolveEndpointsAsync.bind(c),id,i,s,o)(),c}catch(l){throw kc(Fa)}}class _g{constructor(e,t){this.config=function(e){let{authOptions:t,systemOptions:n,loggerOptions:r,cacheOptions:i,storageInterface:o,networkInterface:s,cryptoInterface:a,clientCredentials:c,libraryInfo:l,telemetry:u,serverTelemetryManager:d,persistencePlugin:h,serializableCache:p}=e;const f={...Gl,...r};return{authOptions:(g=t,{clientCapabilities:[],azureCloudOptions:tu,skipAuthorityMetadataCache:!1,instanceAware:!1,...g}),systemOptions:{...Yl,...n},loggerOptions:f,cacheOptions:{...Jl,...i},storageInterface:o||new Ql(t.clientId,Ac,new Sa(f)),networkInterface:s||Xl,cryptoInterface:a||Ac,clientCredentials:c||eu,libraryInfo:{...Zl,...l},telemetry:{...nu,...u},serverTelemetryManager:d||null,persistencePlugin:h||null,serializableCache:p||null};var g}(e),this.logger=new Sa(this.config.loggerOptions,Ec,Mc),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new dg(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){const t={};if(t[ys]=us.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case yf:try{const n=Sl(e.credential);t[bs]=`Oid:${n.uid}@${n.utid}`}catch(n){this.logger.verbose("Could not parse home account ID for CCS Header: "+n)}break;case vf:t[bs]=`UPN: ${e.credential}`}return t}async executePostToTokenEndpoint(e,t,n,r,i,o){o&&this.performanceClient?.addQueueMeasurement(o,i);const s=await this.networkManager.sendPostRequest(r,e,{body:t,headers:n});return this.performanceClient?.addFields({refreshTokenSize:s.body.refresh_token?.length||0,httpVerToken:s.headers?.[_s]||""},i),this.config.serverTelemetryManager&&s.status<500&&429!==s.status&&this.config.serverTelemetryManager.clearTelemetryCache(),s}async updateAuthority(e,t){this.performanceClient?.addQueueMeasurement(Qu,t);const n=`https://${e}/${this.authority.tenant}/`,r=await wg(n,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=r}createTokenQueryParameters(e){const t=new bg;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()}}const Cg="sw";class Ig{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){this.performanceClient?.addQueueMeasurement(Zu,e.correlationId);const n=await tf(this.generateKid.bind(this),Zu,t,this.performanceClient,e.correlationId)(e),r=this.cryptoUtils.base64UrlEncode(JSON.stringify(n));return{kid:n.kid,reqCnfString:r}}async generateKid(e){this.performanceClient?.addQueueMeasurement(ed,e.correlationId);return{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:Cg}}async signPopToken(e,t,n){return this.signPayload(e,t,n)}async signPayload(e,t,n,r){const{resourceRequestMethod:i,resourceRequestUri:o,shrClaims:s,shrNonce:a,shrOptions:c}=n,l=o?new Ll(o):void 0,u=l?.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:Pc(),m:i?.toUpperCase(),u:u?.HostNameAndPort,nonce:a||this.cryptoUtils.createNewGuid(),p:u?.AbsolutePath,q:u?.QueryString?[[],u.QueryString]:void 0,client_claims:s||void 0,...r},t,c,n.correlationId)}}class Tg{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}class Sg{constructor(e,t,n,r,i,o,s){this.clientId=e,this.cacheStorage=t,this.cryptoObj=n,this.logger=r,this.serializableCache=i,this.persistencePlugin=o,this.performanceClient=s}validateServerAuthorizationCodeResponse(e,t){if(!e.state||!t)throw e.state?kc(ja,"Cached State"):kc(ja,"Server State");let n,r;try{n=decodeURIComponent(e.state)}catch(i){throw kc(Ha,e.state)}try{r=decodeURIComponent(t)}catch(i){throw kc(Ha,e.state)}if(n!==r)throw kc($a);if(e.error||e.error_description||e.suberror){const t=function(e){const t="code=",n=e.error_uri?.lastIndexOf(t);return n&&n>=0?e.error_uri?.substring(n+5):void 0}(e);if(ff(e.error,e.error_description,e.suberror))throw new pf(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",t);throw new lg(e.error||"",e.error_description,e.suberror,t)}}validateTokenResponse(e,t){if(e.error||e.error_description||e.suberror){const n=`Error(s): ${e.error_codes||us.NOT_AVAILABLE} - Timestamp: ${e.timestamp||us.NOT_AVAILABLE} - Description: ${e.error_description||us.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||us.NOT_AVAILABLE} - Trace ID: ${e.trace_id||us.NOT_AVAILABLE}`,r=e.error_codes?.length?e.error_codes[0]:void 0,i=new lg(e.error,n,e.suberror,r,e.status);if(t&&e.status&&e.status>=ps&&e.status<=fs)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.\n${i}`);if(t&&e.status&&e.status>=ds&&e.status<=hs)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.\n${i}`);if(ff(e.error,e.error_description,e.suberror))throw new pf(e.error,e.error_description,e.suberror,e.timestamp||us.EMPTY_STRING,e.trace_id||us.EMPTY_STRING,e.correlation_id||us.EMPTY_STRING,e.claims||us.EMPTY_STRING,r);throw i}}async handleServerTokenResponse(e,t,n,r,i,o,s,a,c){let l,u;if(this.performanceClient?.addQueueMeasurement(td,e.correlation_id),e.id_token){if(l=Rc(e.id_token||us.EMPTY_STRING,this.cryptoObj.base64Decode),i&&i.nonce&&l.nonce!==i.nonce)throw kc(Ka);if(r.maxAge||0===r.maxAge){const e=l.auth_time;if(!e)throw kc(Va);Oc(e,r.maxAge)}}this.homeAccountIdentifier=Nl.generateHomeAccountId(e.client_info||us.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,l),i&&i.state&&(u=mf.parseRequestState(this.cryptoObj,i.state)),e.key_id=e.key_id||r.sshKid||void 0;const d=this.generateCacheRecord(e,t,n,r,l,o,i);let h;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),h=new Tg(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(h)),s&&!a&&d.account){const e=d.account.generateAccountKey();if(!this.cacheStorage.getAccount(e,this.logger))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await Sg.generateAuthenticationResult(this.cryptoObj,t,d,!1,r,l,u,void 0,c)}await this.cacheStorage.saveCacheRecord(d,r.storeInCache,r.correlationId)}finally{this.persistencePlugin&&this.serializableCache&&h&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(h))}return Sg.generateAuthenticationResult(this.cryptoObj,t,d,!1,r,l,u,e,c)}generateCacheRecord(e,t,n,r,i,o,s){const a=t.getPreferredCache();if(!a)throw kc(sc);const c=xl(i);let l,u;e.id_token&&i&&(l=Bc(this.homeAccountIdentifier,a,e.id_token,this.clientId,c||""),u=kg(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,i,e.client_info,a,c,s,void 0,this.logger));let d=null;if(e.access_token){const i=e.scope?Il.fromString(e.scope):new Il(r.scopes||[]),s=("string"===typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,l=("string"===typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,u=("string"===typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,h=n+s,p=h+l,f=u&&u>0?n+u:void 0;d=Dc(this.homeAccountIdentifier,a,e.access_token,this.clientId,c||t.tenant||"",i.printScopes(),h,p,this.cryptoObj.base64Decode,f,e.token_type,o,e.key_id,r.claims,r.requestedClaimsHash)}let h=null;if(e.refresh_token){let t;if(e.refresh_token_expires_in){t=n+("string"===typeof e.refresh_token_expires_in?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in)}h=Lc(this.homeAccountIdentifier,a,e.refresh_token,this.clientId,e.foci,o,t)}let p=null;return e.foci&&(p={clientId:this.clientId,environment:a,familyId:e.foci}),{account:u,idToken:l,accessToken:d,refreshToken:h,appMetadata:p}}static async generateAuthenticationResult(e,t,n,r,i,o,s,a,c){let l,u,d=us.EMPTY_STRING,h=[],p=null,f=us.EMPTY_STRING;if(n.accessToken){if(n.accessToken.tokenType!==ta.POP||i.popKid)d=n.accessToken.secret;else{const t=new Ig(e),{secret:r,keyId:o}=n.accessToken;if(!o)throw kc(vc);d=await t.signPopToken(r,o,i)}h=Il.fromString(n.accessToken.target).asArray(),p=new Date(1e3*Number(n.accessToken.expiresOn)),l=new Date(1e3*Number(n.accessToken.extendedExpiresOn)),n.accessToken.refreshOn&&(u=new Date(1e3*Number(n.accessToken.refreshOn)))}n.appMetadata&&(f=n.appMetadata.familyId===Ws?Ws:"");const g=o?.oid||o?.sub||"",m=o?.tid||"";a?.spa_accountid&&n.account&&(n.account.nativeAccountId=a?.spa_accountid);const y=n.account?El(n.account.getAccountInfo(),void 0,o,n.idToken?.secret):null;return{authority:t.canonicalAuthority,uniqueId:g,tenantId:m,scopes:h,account:y,idToken:n?.idToken?.secret||"",idTokenClaims:o||{},accessToken:d,fromCache:r,expiresOn:p,extExpiresOn:l,refreshOn:u,correlationId:i.correlationId,requestId:c||us.EMPTY_STRING,familyId:f,tokenType:n.accessToken?.tokenType||us.EMPTY_STRING,state:s?s.userRequestState:us.EMPTY_STRING,cloudGraphHostName:n.account?.cloudGraphHostName||us.EMPTY_STRING,msGraphHost:n.account?.msGraphHost||us.EMPTY_STRING,code:a?.spa_code,fromNativeBroker:!1}}}function kg(e,t,n,r,i,o,s,a,c,l,u){u?.verbose("setCachedAccount called");const d=e.getAccountKeys().find((e=>e.startsWith(n)));let h=null;d&&(h=e.getAccount(d,u));const p=h||Nl.createAccount({homeAccountId:n,idTokenClaims:i,clientInfo:o,environment:s,cloudGraphHostName:c?.cloud_graph_host_name,msGraphHost:c?.msgraph_host,nativeAccountId:l},t,r),f=p.tenantProfiles||[],g=a||p.realm;if(g&&!f.find((e=>e.tenantId===g))){const e=Al(n,p.localAccountId,g,i);f.push(e)}return p.tenantProfiles=f,p}async function Ag(e,t,n){if("string"===typeof e)return e;return e({clientId:t,tokenEndpoint:n})}class Eg extends _g{constructor(e,t){super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}async getAuthCodeUrl(e){this.performanceClient?.addQueueMeasurement(Ku,e.correlationId);const t=await tf(this.createAuthCodeUrlQueryString.bind(this),Xu,this.logger,this.performanceClient,e.correlationId)(e);return Ll.appendQueryString(this.authority.authorizationEndpoint,t)}async acquireToken(e,t){if(this.performanceClient?.addQueueMeasurement(Yu,e.correlationId),!e.code)throw kc(Ja);const n=Pc(),r=await tf(this.executeTokenRequest.bind(this),Gu,this.logger,this.performanceClient,e.correlationId)(this.authority,e),i=r.headers?.[ws],o=new Sg(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return o.validateTokenResponse(r.body),tf(o.handleServerTokenResponse.bind(o),td,this.logger,this.performanceClient,e.correlationId)(r.body,this.authority,n,e,t,void 0,void 0,void 0,i)}handleFragmentResponse(e,t){if(new Sg(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null).validateServerAuthorizationCodeResponse(e,t),!e.code)throw kc(gc);return e}getLogoutUri(e){if(!e)throw _l(sl);const t=this.createLogoutUrlQueryString(e);return Ll.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(Gu,t.correlationId);const n=this.createTokenQueryParameters(t),r=Ll.appendQueryString(e.tokenEndpoint,n),i=await tf(this.createTokenRequestBody.bind(this),Ju,this.logger,this.performanceClient,t.correlationId)(t);let o;if(t.clientInfo)try{const e=Tl(t.clientInfo,this.cryptoUtils.base64Decode);o={credential:`${e.uid}${js}${e.utid}`,type:yf}}catch(c){this.logger.verbose("Could not parse client info for CCS Header: "+c)}const s=this.createTokenRequestHeaders(o||t.ccsCredential),a={clientId:t.tokenBodyParameters?.clientId||this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid};return tf(this.executePostToTokenEndpoint.bind(this),Iu,this.logger,this.performanceClient,t.correlationId)(r,i,s,a,t.correlationId,Iu)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(Ju,e.correlationId);const t=new bg;if(t.addClientId(e.tokenBodyParameters?.[hg]||this.config.authOptions.clientId),this.includeRedirectUri?t.addRedirectUri(e.redirectUri):vg.validateRedirectUri(e.redirectUri),t.addScopes(e.scopes,!0,this.oidcDefaultScopes),t.addAuthorizationCode(e.code),t.addLibraryInfo(this.config.libraryInfo),t.addApplicationTelemetry(this.config.telemetry.application),t.addThrottling(),this.serverTelemetryManager&&!ru(this.config)&&t.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&t.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const n=this.config.clientCredentials.clientAssertion;t.addClientAssertion(await Ag(n.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),t.addClientAssertionType(n.assertionType)}if(t.addGrantType(Fs),t.addClientInfo(),e.authenticationScheme===ta.POP){const n=new Ig(this.cryptoUtils,this.performanceClient);let r;if(e.popKid)r=this.cryptoUtils.encodeKid(e.popKid);else{r=(await tf(n.generateCnf.bind(n),Zu,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString}t.addPopToken(r)}else if(e.authenticationScheme===ta.SSH){if(!e.sshJwk)throw _l(hl);t.addSshJwk(e.sshJwk)}const n=e.correlationId||this.config.cryptoInterface.createNewGuid();let r;if(t.addCorrelationId(n),(!Cl.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.clientInfo)try{const t=Tl(e.clientInfo,this.cryptoUtils.base64Decode);r={credential:`${t.uid}${js}${t.utid}`,type:yf}}catch(i){this.logger.verbose("Could not parse client info for CCS Header: "+i)}else r=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&r)switch(r.type){case yf:try{const e=Sl(r.credential);t.addCcsOid(e)}catch(i){this.logger.verbose("Could not parse home account ID for CCS Header: "+i)}break;case vf:t.addCcsUpn(r.credential)}return e.tokenBodyParameters&&t.addExtraQueryParameters(e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[mg]||t.addExtraQueryParameters({[mg]:"1"}),t.createQueryString()}async createAuthCodeUrlQueryString(e){this.performanceClient?.addQueueMeasurement(Xu,e.correlationId);const t=new bg;t.addClientId(e.extraQueryParameters?.[hg]||this.config.authOptions.clientId);const n=[...e.scopes||[],...e.extraScopesToConsent||[]];t.addScopes(n,!0,this.oidcDefaultScopes),t.addRedirectUri(e.redirectUri);const r=e.correlationId||this.config.cryptoInterface.createNewGuid();if(t.addCorrelationId(r),t.addResponseMode(e.responseMode),t.addResponseTypeCode(),t.addLibraryInfo(this.config.libraryInfo),ru(this.config)||t.addApplicationTelemetry(this.config.telemetry.application),t.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&t.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&t.addPrompt(e.prompt),e.domainHint&&t.addDomainHint(e.domainHint),e.prompt!==Ns.SELECT_ACCOUNT)if(e.sid&&e.prompt===Ns.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),t.addSid(e.sid);else if(e.account){const n=this.extractAccountSid(e.account);let r=this.extractLoginHint(e.account);if(r&&e.domainHint&&(this.logger.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),r=null),r){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),t.addLoginHint(r);try{const n=Sl(e.account.homeAccountId);t.addCcsOid(n)}catch(i){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(n&&e.prompt===Ns.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),t.addSid(n);try{const n=Sl(e.account.homeAccountId);t.addCcsOid(n)}catch(i){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),t.addLoginHint(e.loginHint),t.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),t.addLoginHint(e.account.username);try{const n=Sl(e.account.homeAccountId);t.addCcsOid(n)}catch(i){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),t.addLoginHint(e.loginHint),t.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");if(e.nonce&&t.addNonce(e.nonce),e.state&&t.addState(e.state),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.addExtraQueryParams(e,t),e.nativeBroker&&(t.addNativeBroker(),e.authenticationScheme===ta.POP)){const n=new Ig(this.cryptoUtils);let r;if(e.popKid)r=this.cryptoUtils.encodeKid(e.popKid);else{r=(await tf(n.generateCnf.bind(n),Zu,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString}t.addPopToken(r)}return t.createQueryString()}createLogoutUrlQueryString(e){const t=new bg;return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),this.addExtraQueryParams(e,t),t.createQueryString()}addExtraQueryParams(e,t){!(e.extraQueryParameters&&e.extraQueryParameters.hasOwnProperty("instance_aware"))&&this.config.authOptions.instanceAware&&(e.extraQueryParameters=e.extraQueryParameters||{},e.extraQueryParameters.instance_aware="true"),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters)}extractAccountSid(e){return e.idTokenClaims?.sid||null}extractLoginHint(e){return e.idTokenClaims?.login_hint||null}}function Mg(e){const{skus:t,libraryName:n,libraryVersion:r,extensionName:i,extensionVersion:o}=e,s=new Map([[0,[n,r]],[2,[i,o]]]);let a=[];if(t?.length){if(a=t.split(","),a.length<4)return t}else a=Array.from({length:4},(()=>"|"));return s.forEach(((e,t)=>{2===e.length&&e[0]?.length&&e[1]?.length&&function(e){const{skuArr:t,index:n,skuName:r,skuVersion:i}=e;if(n>=t.length)return;t[n]=[r,i].join("|")}({skuArr:a,index:t,skuName:e[0],skuVersion:e[1]})})),a.join(",")}class Rg{constructor(e,t){this.cacheOutcome=va,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||us.EMPTY_STRING,this.wrapperVer=e.wrapperVer||us.EMPTY_STRING,this.telemetryCacheKey=ea.CACHE_KEY+$s+e.clientId}generateCurrentRequestHeaderValue(){const e=`${this.apiId}${ea.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],n=this.getNativeBrokerErrorCode();n?.length&&t.push(`broker_error=${n}`);const r=t.join(ea.VALUE_SEPARATOR),i=[e,this.getRegionDiscoveryFields()].join(ea.VALUE_SEPARATOR);return[ea.SCHEMA_VERSION,i,r].join(ea.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),t=Rg.maxErrorsToSend(e),n=e.failedRequests.slice(0,2*t).join(ea.VALUE_SEPARATOR),r=e.errors.slice(0,t).join(ea.VALUE_SEPARATOR),i=e.errors.length,o=[i,t<i?ea.OVERFLOW_TRUE:ea.OVERFLOW_FALSE].join(ea.VALUE_SEPARATOR);return[ea.SCHEMA_VERSION,e.cacheHits,n,r,o].join(ea.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const t=this.getLastRequests();t.errors.length>=ea.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof Pa?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(ea.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits}getLastRequests(){return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||{failedRequests:[],errors:[],cacheHits:0}}clearTelemetryCache(){const e=this.getLastRequests(),t=Rg.maxErrorsToSend(e);if(t===e.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{const n={failedRequests:e.failedRequests.slice(2*t),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n)}}static maxErrorsToSend(e){let t,n=0,r=0;const i=e.errors.length;for(t=0;t<i;t++){const i=e.failedRequests[2*t]||us.EMPTY_STRING,o=e.failedRequests[2*t+1]||us.EMPTY_STRING,s=e.errors[t]||us.EMPTY_STRING;if(r+=i.toString().length+o.toString().length+s.length+3,!(r<ea.MAX_LAST_HEADER_BYTES))break;n+=1}return n}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||us.EMPTY_STRING),e.push(this.regionSource||us.EMPTY_STRING),e.push(this.regionOutcome||us.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e)}static makeExtraSkuString(e){return Mg(e)}}class Og{constructor(e,t,n,r,i,o,s,a,c){this.config=e,this.browserStorage=t,this.browserCrypto=n,this.networkClient=this.config.system.networkClient,this.eventHandler=i,this.navigationClient=o,this.nativeMessageHandler=a,this.correlationId=c||Vp(),this.logger=r.clone(xd,Tp,this.correlationId),this.performanceClient=s}async clearCacheOnLogout(e){if(e){Nl.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null));try{await this.browserStorage.removeAccount(Nl.generateAccountCacheKey(e)),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch(t){this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),await this.browserStorage.clear(),await this.browserCrypto.clearKeystore()}catch(n){this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const t=e||this.config.auth.redirectUri||Mf();return Ll.getAbsoluteUrl(t,Mf())}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");const n={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Rg(n,this.browserStorage)}async getDiscoveredAuthority(e){const{account:t}=e,n=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(bu,this.correlationId);const r={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},i=e.requestAuthority||this.config.auth.authority,o=n?.length?"true"===n:this.config.auth.instanceAware,s=t&&o?this.config.auth.authority.replace(Ll.getDomainFromUrl(i),t.environment):i,a=rf.generateAuthority(s,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),c=await tf(wg,rd,this.logger,this.performanceClient,this.correlationId)(a,this.config.system.networkClient,this.browserStorage,r,this.logger,this.correlationId,this.performanceClient);if(t&&!c.isAlias(t.environment))throw _l(vl);return c}}async function Pg(e,t,n){e.addQueueMeasurement(wd,n);const r=ef(xg,_d,t,e,n)(e,t,n);return{verifier:r,challenge:await tf(Ng,Cd,t,e,n)(r,e,t,n)}}function xg(e,t,n){try{const r=new Uint8Array(32);ef(jp,Td,t,e,n)(r);return Np(r)}catch(r){throw _p(kh)}}async function Ng(e,t,n,r){t.addQueueMeasurement(Cd,r);try{const i=await tf($p,Id,n,t,r)(e,t,r);return Np(new Uint8Array(i))}catch(i){throw _p(kh)}}async function Bg(e,t,n,r){n.addQueueMeasurement(xu,e.correlationId);const i=e.authority||t.auth.authority,o=[...e&&e.scopes||[]],s={...e,correlationId:e.correlationId,authority:i,scopes:o};if(s.authenticationScheme){if(s.authenticationScheme===ta.SSH){if(!e.sshJwk)throw _l(hl);if(!e.sshKid)throw _l(pl)}r.verbose(`Authentication Scheme set to "${s.authenticationScheme}" as configured in Auth request`)}else s.authenticationScheme=ta.BEARER,r.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return t.cache.claimsBasedCachingEnabled&&e.claims&&!Cl.isEmptyObj(e.claims)&&(s.requestedClaimsHash=await Qp(e.claims)),s}async function Dg(e,t,n,r,i){r.addQueueMeasurement(Nu,e.correlationId);const o=await tf(Bg,xu,i,r,e.correlationId)(e,n,r,i);return{...e,...o,account:t,forceRefresh:e.forceRefresh||!1}}class Lg extends Og{async initializeAuthorizationCodeRequest(e){this.performanceClient.addQueueMeasurement(ju,this.correlationId);const t=await tf(Pg,wd,this.logger,this.performanceClient,this.correlationId)(this.performanceClient,this.logger,this.correlationId),n={...e,redirectUri:e.redirectUri,code:us.EMPTY_STRING,codeVerifier:t.verifier};return e.codeChallenge=t.challenge,e.codeChallengeMethod=us.S256_CODE_CHALLENGE_METHOD,n}initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e?.correlationId);const t={correlationId:this.correlationId||Vp(),...e};if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const n=this.getLogoutHintFromIdTokenClaims(e.account);n&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=n)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=Ll.getAbsoluteUrl(e.postLogoutRedirectUri,Mf())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=Ll.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,Mf())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=Ll.getAbsoluteUrl(Mf(),Mf())),t}getLogoutHintFromIdTokenClaims(e){const t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){this.performanceClient.addQueueMeasurement(zu,this.correlationId);const t=await tf(this.getClientConfiguration.bind(this),Hu,this.logger,this.performanceClient,this.correlationId)(e);return new Eg(t,this.performanceClient)}async getClientConfiguration(e){const{serverTelemetryManager:t,requestAuthority:n,requestAzureCloudOptions:r,requestExtraQueryParameters:i,account:o}=e;this.performanceClient.addQueueMeasurement(Hu,this.correlationId);const s=await tf(this.getDiscoveredAuthority.bind(this),bu,this.logger,this.performanceClient,this.correlationId)({requestAuthority:n,requestAzureCloudOptions:r,requestExtraQueryParameters:i,account:o}),a=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:s,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:a.loggerCallback,piiLoggingEnabled:a.piiLoggingEnabled,logLevel:a.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:xd,version:Tp,cpu:us.EMPTY_STRING,os:us.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,t){this.performanceClient.addQueueMeasurement($u,this.correlationId);const n=this.getRedirectUri(e.redirectUri),r={interactionType:t},i=mf.setRequestState(this.browserCrypto,e&&e.state||us.EMPTY_STRING,r),o={...await tf(Bg,xu,this.logger,this.performanceClient,this.correlationId)({...e,correlationId:this.correlationId},this.config,this.performanceClient,this.logger),redirectUri:n,state:i,nonce:e.nonce||Vp(),responseMode:this.config.auth.OIDCOptions.serverResponseType},s=e.account||this.browserStorage.getActiveAccount();if(s&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${s.homeAccountId}`,this.correlationId),o.account=s),!o.loginHint&&!s){const e=this.browserStorage.getLegacyLoginHint();e&&(o.loginHint=e)}return o}}const Fg="user_switch",Ug={[Fg]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class qg extends Pa{constructor(e,t,n){super(e,t),Object.setPrototypeOf(this,qg.prototype),this.name="NativeAuthError",this.ext=n}}function zg(e){return!(!e.ext||!e.ext.status||"PERSISTENT_ERROR"!==e.ext.status&&"DISABLED"!==e.ext.status)||(!(!e.ext||!e.ext.error||-2147186943!==e.ext.error)||"ContentError"===e.errorCode)}function Hg(e,t,n){if(n&&n.status)switch(n.status){case"ACCOUNT_UNAVAILABLE":return gf(af);case"USER_INTERACTION_REQUIRED":return new pf(e,t);case"USER_CANCEL":return _p(Lh);case"NO_NETWORK":return _p(ep)}return new qg(e,Ug[e]||t,n)}class $g extends _g{constructor(e,t){super(e,t)}async acquireToken(e){this.performanceClient?.addQueueMeasurement(Su,e.correlationId);const t=Pc(),n=await tf(this.executeTokenRequest.bind(this),Tu,this.logger,this.performanceClient,e.correlationId)(e,this.authority),r=n.headers?.[ws],i=new Sg(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return i.validateTokenResponse(n.body),tf(i.handleServerTokenResponse.bind(i),td,this.logger,this.performanceClient,e.correlationId)(n.body,this.authority,t,e,void 0,void 0,!0,e.forceCache,r)}async acquireTokenByRefreshToken(e){if(!e)throw _l(ol);if(this.performanceClient?.addQueueMeasurement(Au,e.correlationId),!e.account)throw kc(ic);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await tf(this.acquireTokenWithCachedRefreshToken.bind(this),ku,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(t){const n=t instanceof pf&&t.errorCode===sf,r=t instanceof lg&&t.errorCode===sa&&t.subError===aa;if(n||r)return tf(this.acquireTokenWithCachedRefreshToken.bind(this),ku,this.logger,this.performanceClient,e.correlationId)(e,!1);throw t}return tf(this.acquireTokenWithCachedRefreshToken.bind(this),ku,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){this.performanceClient?.addQueueMeasurement(ku,e.correlationId);const n=ef(this.cacheManager.getRefreshToken.bind(this.cacheManager),bd,this.logger,this.performanceClient,e.correlationId)(e.account,t,void 0,this.performanceClient,e.correlationId);if(!n)throw gf(sf);if(n.expiresOn&&xc(n.expiresOn,e.refreshTokenExpirationOffsetSeconds||300))throw gf(cf);const r={...e,refreshToken:n.secret,authenticationScheme:e.authenticationScheme||ta.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:yf}};try{return await tf(this.acquireToken.bind(this),Su,this.logger,this.performanceClient,e.correlationId)(r)}catch(i){if(i instanceof pf&&i.subError===lf){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const e=Nc(n);this.cacheManager.removeRefreshToken(e)}throw i}}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(Tu,e.correlationId);const n=this.createTokenQueryParameters(e),r=Ll.appendQueryString(t.tokenEndpoint,n),i=await tf(this.createTokenRequestBody.bind(this),Eu,this.logger,this.performanceClient,e.correlationId)(e),o=this.createTokenRequestHeaders(e.ccsCredential),s={clientId:e.tokenBodyParameters?.clientId||this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return tf(this.executePostToTokenEndpoint.bind(this),Cu,this.logger,this.performanceClient,e.correlationId)(r,i,o,s,e.correlationId,Cu)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(Eu,e.correlationId);const t=e.correlationId,n=new bg;if(n.addClientId(e.tokenBodyParameters?.[hg]||this.config.authOptions.clientId),e.redirectUri&&n.addRedirectUri(e.redirectUri),n.addScopes(e.scopes,!0,this.config.authOptions.authority.options.OIDCOptions?.defaultScopes),n.addGrantType(Us),n.addClientInfo(),n.addLibraryInfo(this.config.libraryInfo),n.addApplicationTelemetry(this.config.telemetry.application),n.addThrottling(),this.serverTelemetryManager&&!ru(this.config)&&n.addServerTelemetry(this.serverTelemetryManager),n.addCorrelationId(t),n.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&n.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const t=this.config.clientCredentials.clientAssertion;n.addClientAssertion(await Ag(t.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),n.addClientAssertionType(t.assertionType)}if(e.authenticationScheme===ta.POP){const t=new Ig(this.cryptoUtils,this.performanceClient);let r;if(e.popKid)r=this.cryptoUtils.encodeKid(e.popKid);else{r=(await tf(t.generateCnf.bind(t),Zu,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString}n.addPopToken(r)}else if(e.authenticationScheme===ta.SSH){if(!e.sshJwk)throw _l(hl);n.addSshJwk(e.sshJwk)}if((!Cl.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case yf:try{const t=Sl(e.ccsCredential.credential);n.addCcsOid(t)}catch(r){this.logger.verbose("Could not parse home account ID for CCS Header: "+r)}break;case vf:n.addCcsUpn(e.ccsCredential.credential)}return e.tokenBodyParameters&&n.addExtraQueryParameters(e.tokenBodyParameters),n.createQueryString()}}class jg extends _g{constructor(e,t){super(e,t)}async acquireToken(e){try{const[t,n]=await this.acquireCachedToken({...e,scopes:e.scopes?.length?e.scopes:[...gs]});if(n===Ca){this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed.");new $g(this.config,this.performanceClient).acquireTokenByRefreshToken(e).catch((()=>{}))}return t}catch(t){if(t instanceof Sc&&t.errorCode===hc){return new $g(this.config,this.performanceClient).acquireTokenByRefreshToken(e)}throw t}}async acquireCachedToken(e){this.performanceClient?.addQueueMeasurement(Ru,e.correlationId);let t=va;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!Cl.isEmptyObj(e.claims))throw this.setCacheOutcome(ba,e.correlationId),kc(hc);if(!e.account)throw kc(ic);const n=e.account.tenantId||function(e){const t=new Ll(e).getUrlComponents(),n=t.PathSegments.slice(-1)[0]?.toLowerCase();switch(n){case Ms:case Rs:case Os:return;default:return n}}(e.authority),r=this.cacheManager.getTokenKeys(),i=this.cacheManager.getAccessToken(e.account,e,r,n,this.performanceClient,e.correlationId);if(!i)throw this.setCacheOutcome(wa,e.correlationId),kc(hc);if(o=i.cachedAt,Number(o)>Pc()||xc(i.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(_a,e.correlationId),kc(hc);var o;i.refreshOn&&xc(i.refreshOn,0)&&(t=Ca);const s=e.authority||this.authority.getPreferredCache(),a={account:this.cacheManager.readAccountFromCache(e.account),accessToken:i,idToken:this.cacheManager.getIdToken(e.account,r,n,this.performanceClient,e.correlationId),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(s)};return this.setCacheOutcome(t,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await tf(this.generateResultFromCacheRecord.bind(this),Ou,this.logger,this.performanceClient,e.correlationId)(a,e),t]}setCacheOutcome(e,t){this.serverTelemetryManager?.setCacheOutcome(e),this.performanceClient?.addFields({cacheOutcome:e},t),e!==va&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,t){let n;if(this.performanceClient?.addQueueMeasurement(Ou,t.correlationId),e.idToken&&(n=Rc(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||0===t.maxAge){const e=n?.auth_time;if(!e)throw kc(Va);Oc(e,t.maxAge)}return Sg.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,n)}}class Kg extends Lg{async acquireToken(e){this.performanceClient.addQueueMeasurement(fu,e.correlationId);const t=this.initializeServerTelemetryManager(dh),n=await tf(this.getClientConfiguration.bind(this),Hu,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),r=new jg(n,this.performanceClient);this.logger.verbose("Silent auth client created");try{const t=(await tf(r.acquireCachedToken.bind(r),Ru,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),t}catch(i){throw i instanceof wp&&i.errorCode===op&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),i}}logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t?.account)}}const Vg="brk_client_id",Wg="brk_redirect_uri";class Qg extends Og{constructor(e,t,n,r,i,o,s,a,c,l,u,d){super(e,t,n,r,i,o,a,c,d),this.apiId=s,this.accountId=l,this.nativeMessageHandler=c,this.nativeStorageManager=u,this.silentCacheClient=new Kg(e,this.nativeStorageManager,n,r,i,o,a,c,d),this.serverTelemetryManager=this.initializeServerTelemetryManager(this.apiId);const h=this.nativeMessageHandler.getExtensionId()===Bd?"chrome":this.nativeMessageHandler.getExtensionId()?.length?"unknown":void 0;this.skus=Rg.makeExtraSkuString({libraryName:xd,libraryVersion:Tp,extensionName:h,extensionVersion:this.nativeMessageHandler.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters={...e.extraParameters,[yg]:this.skus}}async acquireToken(e){this.performanceClient.addQueueMeasurement(_u,e.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const t=this.performanceClient.startMeasurement(_u,e.correlationId),n=Pc();try{const i=await this.initializeNativeRequest(e);try{const e=await this.acquireTokensFromCache(this.accountId,i);return t.end({success:!0,isNativeBroker:!1,fromCache:!0}),e}catch(r){this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const{...o}=i,s={method:Ud,request:o},a=await this.nativeMessageHandler.sendMessage(s),c=this.validateNativeResponse(a);return await this.handleNativeResponse(c,i,n).then((e=>(t.end({success:!0,isNativeBroker:!0,requestId:e.requestId}),this.serverTelemetryManager.clearNativeBrokerErrorCode(),e))).catch((e=>{throw t.end({success:!1,errorCode:e.errorCode,subErrorCode:e.subError,isNativeBroker:!0}),e}))}catch(r){throw r instanceof qg&&this.serverTelemetryManager.setNativeBrokerErrorCode(r.errorCode),r}}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:Il.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}async acquireTokensFromCache(e,t){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),kc(ac);const n=this.browserStorage.getBaseAccountInfo({nativeAccountId:e});if(!n)throw kc(ac);try{const e=this.createSilentCacheRequest(t,n),r=await this.silentCacheClient.acquireToken(e),i={...n,idTokenClaims:r?.idTokenClaims,idToken:r?.idToken};return{...r,account:i}}catch(r){throw r}}async acquireTokenRedirect(e,t){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const{...n}=e;delete n.onRedirectNavigate;const r=await this.initializeNativeRequest(n),i={method:Ud,request:r};try{const e=await this.nativeMessageHandler.sendMessage(i);this.validateNativeResponse(e)}catch(a){if(a instanceof qg&&(this.serverTelemetryManager.setNativeBrokerErrorCode(a.errorCode),zg(a)))throw a}this.browserStorage.setTemporaryCache(th,JSON.stringify(r),!0);const o={apiId:sh,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},s=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);t.end({success:!0}),await this.navigationClient.navigateExternal(s,o)}async handleRedirectPromise(e,t){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const n=this.browserStorage.getCachedNativeRequest();if(!n)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&e?.addFields({errorCode:"no_cached_request"},t),null;const{prompt:r,...i}=n;r&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(th));const o={method:Ud,request:i},s=Pc();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const e=await this.nativeMessageHandler.sendMessage(o);this.validateNativeResponse(e);const t=this.handleNativeResponse(e,i,s);this.browserStorage.setInteractionInProgress(!1);const n=await t;return this.serverTelemetryManager.clearNativeBrokerErrorCode(),n}catch(a){throw this.browserStorage.setInteractionInProgress(!1),a}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(e,t,n){this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const r=Rc(e.id_token,Lp),i=this.createHomeAccountIdentifier(e,r),o=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId})?.homeAccountId;if(i!==o&&e.account.id!==t.accountId)throw Hg(Fg);const s=await this.getDiscoveredAuthority({requestAuthority:t.authority}),a=kg(this.browserStorage,s,i,Lp,r,e.client_info,void 0,r.tid,void 0,e.account.id,this.logger),c=await this.generateAuthenticationResult(e,t,r,a,s.canonicalAuthority,n);return this.cacheAccount(a),this.cacheNativeTokens(e,t,i,r,e.access_token,c.tenantId,n),c}createHomeAccountIdentifier(e,t){return Nl.generateHomeAccountId(e.client_info||us.EMPTY_STRING,Ml,this.logger,this.browserCrypto,t)}generateScopes(e,t){return e.scope?Il.fromString(e.scope):Il.fromString(t.scope)}async generatePopAccessToken(e,t){if(t.tokenType===ta.POP&&t.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const n=new Ig(this.browserCrypto),r={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw kc(vc);return n.signPopToken(e.access_token,t.keyId,r)}return e.access_token}async generateAuthenticationResult(e,t,n,r,i,o){const s=this.addTelemetryFromNativeResponse(e),a=e.scope?Il.fromString(e.scope):Il.fromString(t.scope),c=e.account.properties||{},l=c.UID||n.oid||n.sub||us.EMPTY_STRING,u=c.TenantId||n.tid||us.EMPTY_STRING,d=El(r.getAccountInfo(),void 0,n,e.id_token);d.nativeAccountId!==e.account.id&&(d.nativeAccountId=e.account.id);const h=await this.generatePopAccessToken(e,t),p=t.tokenType===ta.POP?ta.POP:ta.BEARER;return{authority:i,uniqueId:l,tenantId:u,scopes:a.asArray(),account:d,idToken:e.id_token,idTokenClaims:n,accessToken:h,fromCache:!!s&&this.isResponseFromCache(s),expiresOn:new Date(1e3*Number(o+e.expires_in)),tokenType:p,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}cacheAccount(e){this.browserStorage.setAccount(e),this.browserStorage.removeAccountContext(e).catch((e=>{this.logger.error(`Error occurred while removing account context from browser storage. ${e}`)}))}cacheNativeTokens(e,t,n,r,i,o,s){const a=Bc(n,t.authority,e.id_token||"",t.clientId,r.tid||""),c=s+(t.tokenType===ta.POP?us.SHR_NONCE_VALIDITY:("string"===typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0),l=this.generateScopes(e,t),u={idToken:a,accessToken:Dc(n,t.authority,i,t.clientId,r.tid||o,l.printScopes(),c,0,Lp,void 0,t.tokenType,void 0,t.keyId)};this.nativeStorageManager.saveCacheRecord(u,t.storeInCache)}addTelemetryFromNativeResponse(e){const t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}validateNativeResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw xa(Ma,"Response missing expected properties.")}getMATSFromResponse(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch(t){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return"undefined"===typeof e.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const t=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:t,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});const n=new Ll(t);n.validateAsUri();const{scopes:r,...i}=e,o=new Il(r||[]);o.appendScopes(gs);const s={...i,accountId:this.accountId,clientId:this.config.auth.clientId,authority:n.urlString,scope:o.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:(()=>{switch(this.apiId){case ch:case dh:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),Ns.NONE}if(e.prompt)switch(e.prompt){case Ns.NONE:case Ns.CONSENT:case Ns.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e.prompt} is not compatible with native flow`),_p(gp)}else this.logger.trace("initializeNativeRequest: prompt was not provided")})(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1,keyId:e.popKid};if(s.signPopToken&&e.popKid)throw _p(yp);if(this.handleExtraBrokerParams(s),s.extraParameters=s.extraParameters||{},s.extraParameters.telemetry=Dd,e.authenticationScheme===ta.POP){const t={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},n=new Ig(this.browserCrypto);let r;if(s.keyId)r=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:s.keyId})),s.signPopToken=!1;else{const i=await tf(n.generateCnf.bind(n),Zu,this.logger,this.performanceClient,e.correlationId)(t,this.logger);r=i.reqCnfString,s.keyId=i.kid,s.signPopToken=!0}s.reqCnf=r}return this.addRequestSKUs(s),s}handleExtraBrokerParams(e){if(e.extraParameters&&e.extraParameters.hasOwnProperty(Vg)&&e.extraParameters.hasOwnProperty(Wg)&&e.extraParameters.hasOwnProperty(hg)){const t=e.extraParameters[hg],n=e.redirectUri,r=e.extraParameters[Wg];e.extraParameters={child_client_id:t,child_redirect_uri:n},e.redirectUri=r}}}class Yg{constructor(e,t,n,r){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=r,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=n,this.handshakeEvent=n.startMeasurement(md)}async sendMessage(e){this.logger.trace("NativeMessageHandler - sendMessage called.");const t={channel:Nd,extensionId:this.extensionId,responseId:Vp(),body:e};return this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii(`NativeMessageHandler - Sending request to browser extension: ${JSON.stringify(t)}`),this.messageChannel.port1.postMessage(t),new Promise(((e,n)=>{this.resolvers.set(t.responseId,{resolve:e,reject:n})}))}static async createProvider(e,t,n){e.trace("NativeMessageHandler - createProvider called.");try{const r=new Yg(e,t,n,Bd);return await r.sendHandshakeRequest(),r}catch(r){const i=new Yg(e,t,n);return await i.sendHandshakeRequest(),i}}async sendHandshakeRequest(){this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:Nd,extensionId:this.extensionId,responseId:Vp(),body:{method:Ld}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=e=>{this.onChannelMessage(e)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise(((t,n)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:n}),this.timeoutId=window.setTimeout((()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),n(_p(dp)),this.handshakeResolvers.delete(e.responseId)}),this.handshakeTimeoutMs)}))}onWindowMessage(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window)return;const t=e.data;if(t.channel&&t.channel===Nd&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===Ld){const e=this.handshakeResolvers.get(t.responseId);if(!e)return void this.logger.trace(`NativeMessageHandler.onWindowMessage - resolver can't be found for request ${t.responseId}`);this.logger.verbose(t.extensionId?`Extension with id: ${t.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),e.reject(_p(hp))}}onChannelMessage(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");const t=e.data,n=this.resolvers.get(t.responseId),r=this.handshakeResolvers.get(t.responseId);try{const e=t.body.method;if(e===qd){if(!n)return;const e=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii(`NativeMessageHandler - Received response from browser extension: ${JSON.stringify(e)}`),"Success"!==e.status)n.reject(Hg(e.code,e.description,e.ext));else{if(!e.result)throw xa(Ma,"Event does not contain result.");e.result.code&&e.result.description?n.reject(Hg(e.result.code,e.result.description,e.result.ext)):n.resolve(e.result)}this.resolvers.delete(t.responseId)}else if(e===Fd){if(!r)return void this.logger.trace(`NativeMessageHandler.onChannelMessage - resolver can't be found for request ${t.responseId}`);clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(`NativeMessageHandler - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),r.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(i){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${i}`),this.logger.errorPii(`Unable to parse ${e}`),n?n.reject(i):r&&r.reject(i)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isNativeAvailable(e,t,n,r){if(t.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return t.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!n)return t.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(r)switch(r){case ta.BEARER:case ta.POP:return t.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0}}class Gg{constructor(e,t,n,r,i){this.authModule=e,this.browserStorage=t,this.authCodeRequest=n,this.logger=r,this.performanceClient=i}async handleCodeResponse(e,t){let n;this.performanceClient.addQueueMeasurement(Wu,t.correlationId);try{n=this.authModule.handleFragmentResponse(e,t.state)}catch(r){throw r instanceof lg&&r.subError===Lh?_p(Lh):r}return tf(this.handleCodeResponseFromServer.bind(this),Vu,this.logger,this.performanceClient,t.correlationId)(n,t)}async handleCodeResponseFromServer(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.performanceClient.addQueueMeasurement(Vu,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await tf(this.authModule.updateAuthority.bind(this.authModule),Qu,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId),n&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const e=this.createCcsCredentials(t);e&&(this.authCodeRequest.ccsCredential=e)}return await tf(this.authModule.acquireToken.bind(this.authModule),Yu,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:yf}:e.loginHint?{credential:e.loginHint,type:vf}:null}}function Jg(e,t,n){const r=Dl(e);if(!r)throw Bl(e)?(n.error(`A ${t} is present in the iframe but it does not contain known properties. It's likely that the ${t} has been replaced by code running on the redirectUri page.`),n.errorPii(`The ${t} detected is: ${e}`),_p(Oh)):(n.error(`The request has returned to the redirectUri but a ${t} is not present. It's likely that the ${t} has been removed or the page has been redirected by code running on the redirectUri page.`),_p(Mh));return r}class Xg extends Lg{constructor(e,t,n,r,i,o,s,a,c,l){super(e,t,n,r,i,o,s,c,l),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=a}acquireToken(e){try{const t={popupName:this.generatePopupName(e.scopes||gs,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:e.popupWindowParent??window};return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,t)):(this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),t.popup=this.openSizedPopup("about:blank",t),this.acquireTokenPopupAsync(e,t))}catch(t){return Promise.reject(t)}}logout(e){try{this.logger.verbose("logoutPopup called");const t=this.initializeLogoutRequest(e),n={popupName:this.generateLogoutPopupName(t),popupWindowAttributes:e?.popupWindowAttributes||{},popupWindowParent:e?.popupWindowParent??window},r=e&&e.authority,i=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,n,r,i)):(this.logger.verbose("asyncPopup set to false, opening popup"),n.popup=this.openSizedPopup("about:blank",n),this.logoutPopupAsync(t,n,r,i))}catch(t){return Promise.reject(t)}}async acquireTokenPopupAsync(e,t){this.logger.verbose("acquireTokenPopupAsync called");const n=this.initializeServerTelemetryManager(ah),r=await tf(this.initializeAuthorizationRequest.bind(this),$u,this.logger,this.performanceClient,this.correlationId)(e,fh.Popup);Bf(r.authority);try{const i=await tf(this.initializeAuthorizationCodeRequest.bind(this),ju,this.logger,this.performanceClient,this.correlationId)(r),o=await tf(this.createAuthCodeClient.bind(this),zu,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:r.authority,requestAzureCloudOptions:r.azureCloudOptions,requestExtraQueryParameters:r.extraQueryParameters,account:r.account}),s=Yg.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme);let a;s&&(a=this.performanceClient.startMeasurement(wu,e.correlationId));const c=await o.getAuthCodeUrl({...r,nativeBroker:s}),l=new Gg(o,this.browserStorage,i,this.logger,this.performanceClient),u=this.initiateAuthRequest(c,t);this.eventHandler.emitEvent(ng,fh.Popup,{popupWindow:u},null);const d=await this.monitorPopupForHash(u,t.popupWindowParent),h=ef(Jg,nd,this.logger,this.performanceClient,this.correlationId)(d,this.config.auth.OIDCOptions.serverResponseType,this.logger);if(ug.removeThrottle(this.browserStorage,this.config.auth.clientId,i),h.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),a&&a.end({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw _p(pp);const e=new Qg(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,ah,this.performanceClient,this.nativeMessageHandler,h.accountId,this.nativeStorage,r.correlationId),{userRequestState:t}=mf.parseRequestState(this.browserCrypto,r.state);return await e.acquireToken({...r,state:t,prompt:void 0})}return await l.handleCodeResponse(h,r)}catch(i){throw t.popup?.close(),i instanceof Pa&&(i.setCorrelationId(this.correlationId),n.cacheFailedRequest(i)),i}}async logoutPopupAsync(e,t,n,r){this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(rg,fh.Popup,e);const i=this.initializeServerTelemetryManager(ph);try{await this.clearCacheOnLogout(e.account);const o=await tf(this.createAuthCodeClient.bind(this),zu,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:i,requestAuthority:n,account:e.account||void 0});try{o.authority.endSessionEndpoint}catch{if(e.account?.homeAccountId&&e.postLogoutRedirectUri&&o.authority.protocolMode===Aa){if(this.browserStorage.removeAccount(e.account?.homeAccountId),this.eventHandler.emitEvent(ig,fh.Popup,e),r){const e={apiId:ph,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=Ll.getAbsoluteUrl(r,Mf());await this.navigationClient.navigateInternal(t,e)}return void t.popup?.close()}}const s=o.getLogoutUri(e);this.eventHandler.emitEvent(ig,fh.Popup,e);const a=this.openPopup(s,t);if(this.eventHandler.emitEvent(ng,fh.Popup,{popupWindow:a},null),await this.monitorPopupForHash(a,t.popupWindowParent).catch((()=>{})),r){const e={apiId:ph,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=Ll.getAbsoluteUrl(r,Mf());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${t}`),await this.navigationClient.navigateInternal(t,e)}else this.logger.verbose("No main window navigation requested")}catch(o){throw t.popup?.close(),o instanceof Pa&&(o.setCorrelationId(this.correlationId),i.cacheFailedRequest(o)),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(og,fh.Popup,null,o),this.eventHandler.emitEvent(sg,fh.Popup),o}this.eventHandler.emitEvent(sg,fh.Popup)}initiateAuthRequest(e,t){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),_p(Eh)}monitorPopupForHash(e,t){return new Promise(((t,n)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const r=setInterval((()=>{if(e.closed)return this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(r),void n(_p(Lh));let i="";try{i=e.location.href}catch(a){}if(!i||"about:blank"===i)return;clearInterval(r);let o="";const s=this.config.auth.OIDCOptions.serverResponseType;e&&(o=s===Ds.QUERY?e.location.search:e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),t(o)}),this.config.system.pollIntervalMilliseconds)})).finally((()=>{this.cleanPopup(e,t)}))}openPopup(e,t){try{let n;if(t.popup?(n=t.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),n.location.assign(e)):"undefined"===typeof t.popup&&(this.logger.verbosePii(`Opening popup window to: ${e}`),n=this.openSizedPopup(e,t)),!n)throw _p(Dh);return n.focus&&n.focus(),this.currentWindow=n,t.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),n}catch(n){throw this.logger.error("error opening popup "+n.message),this.browserStorage.setInteractionInProgress(!1),_p(Bh)}}openSizedPopup(e,t){let{popupName:n,popupWindowAttributes:r,popupWindowParent:i}=t;const o=i.screenLeft?i.screenLeft:i.screenX,s=i.screenTop?i.screenTop:i.screenY,a=i.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,c=i.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let l=r.popupSize?.width,u=r.popupSize?.height,d=r.popupPosition?.top,h=r.popupPosition?.left;return(!l||l<0||l>a)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),l=Md),(!u||u<0||u>c)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),u=Rd),(!d||d<0||d>c)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),d=Math.max(0,c/2-Rd/2+s)),(!h||h<0||h>a)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),h=Math.max(0,a/2-Md/2+o)),i.open(e,n,`width=${l}, height=${u}, top=${d}, left=${h}, scrollbars=yes`)}unloadWindow(e){this.browserStorage.cleanRequestByInteractionType(fh.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,t){e.close(),t.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)}generatePopupName(e,t){return`${Od}.${this.config.auth.clientId}.${e.join("-")}.${t}.${this.correlationId}`}generateLogoutPopupName(e){const t=e.account&&e.account.homeAccountId;return`${Od}.${this.config.auth.clientId}.${t}.${this.correlationId}`}}class Zg{constructor(e,t,n,r,i){this.authModule=e,this.browserStorage=t,this.authCodeRequest=n,this.logger=r,this.performanceClient=i}async initiateAuthRequest(e,t){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){t.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(Yd,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(eh,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest),this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);const n={apiId:sh,timeout:t.redirectTimeout,noHistory:!1};if("function"===typeof t.onRedirectNavigate){this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback");return!1!==t.onRedirectNavigate(e)?(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),void await t.navigationClient.navigateExternal(e,n)):void this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation")}return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),void await t.navigationClient.navigateExternal(e,n)}throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),_p(Eh)}async handleCodeResponse(e,t){this.logger.verbose("RedirectHandler.handleCodeResponse called"),this.browserStorage.setInteractionInProgress(!1);const n=this.browserStorage.generateStateKey(t),r=this.browserStorage.getTemporaryCache(n);if(!r)throw kc(ja,"Cached State");let i;try{i=this.authModule.handleFragmentResponse(e,r)}catch(c){throw c instanceof lg&&c.subError===Lh?_p(Lh):c}const o=this.browserStorage.generateNonceKey(r),s=this.browserStorage.getTemporaryCache(o);if(this.authCodeRequest.code=i.code,i.cloud_instance_host_name&&await tf(this.authModule.updateAuthority.bind(this.authModule),Qu,this.logger,this.performanceClient,this.authCodeRequest.correlationId)(i.cloud_instance_host_name,this.authCodeRequest.correlationId),i.nonce=s||void 0,i.state=r,i.client_info)this.authCodeRequest.clientInfo=i.client_info;else{const e=this.checkCcsCredentials();e&&(this.authCodeRequest.ccsCredential=e)}const a=await this.authModule.acquireToken(this.authCodeRequest,i);return this.browserStorage.cleanRequestByState(t),a}checkCcsCredentials(){const e=this.browserStorage.getTemporaryCache(Zd,!0);if(e)try{return JSON.parse(e)}catch(t){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii(`Cache credential could not be parsed: ${e}`)}return null}}class em extends Lg{constructor(e,t,n,r,i,o,s,a,c,l){super(e,t,n,r,i,o,s,c,l),this.nativeStorage=a}async acquireToken(e){const t=await tf(this.initializeAuthorizationRequest.bind(this),$u,this.logger,this.performanceClient,this.correlationId)(e,fh.Redirect);this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||"",t.account||null);const n=this.initializeServerTelemetryManager(sh),r=e=>{e.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.cleanRequestByState(t.state),this.eventHandler.emitEvent(ag,fh.Redirect))};try{const i=await tf(this.initializeAuthorizationCodeRequest.bind(this),ju,this.logger,this.performanceClient,this.correlationId)(t),o=await tf(this.createAuthCodeClient.bind(this),zu,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),s=new Zg(o,this.browserStorage,i,this.logger,this.performanceClient),a=await o.getAuthCodeUrl({...t,nativeBroker:Yg.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)}),c=this.getRedirectStartPage(e.redirectStartPage);return this.logger.verbosePii(`Redirect start page: ${c}`),window.addEventListener("pageshow",r),await s.initiateAuthRequest(a,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:c,onRedirectNavigate:e.onRedirectNavigate||this.config.auth.onRedirectNavigate})}catch(i){throw i instanceof Pa&&(i.setCorrelationId(this.correlationId),n.cacheFailedRequest(i)),window.removeEventListener("pageshow",r),this.browserStorage.cleanRequestByState(t.state),i}}async handleRedirectPromise(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;const n=this.initializeServerTelemetryManager(lh);try{if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const[r,i]=this.getRedirectResponse(e||"");if(!r)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(fh.Redirect),"back_forward"!==function(){if("undefined"===typeof window||"undefined"===typeof window.performance||"function"!==typeof window.performance.getEntriesByType)return;const e=window.performance.getEntriesByType("navigation"),t=e.length?e[0]:void 0;return t?.type}()?t.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const o=this.browserStorage.getTemporaryCache(Yd,!0)||us.EMPTY_STRING,s=Ll.removeHashFromUrl(o);if(s===Ll.removeHashFromUrl(window.location.href)&&this.config.auth.navigateToLoginRequestUrl){this.logger.verbose("Current page is loginRequestUrl, handling response"),o.indexOf("#")>-1&&function(e){const t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""}(o);return await this.handleResponse(r,n)}if(!this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(r,n);if(!Ef()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(Gd,i,!0);const e={apiId:lh,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let t=!0;if(o&&"null"!==o)this.logger.verbose(`Navigating to loginRequestUrl: ${o}`),t=await this.navigationClient.navigateInternal(o,e);else{const n=function(){const e=new Ll(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}();this.browserStorage.setTemporaryCache(Yd,n,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),t=await this.navigationClient.navigateInternal(n,e)}if(!t)return await this.handleResponse(r,n)}return null}catch(r){throw r instanceof Pa&&(r.setCorrelationId(this.correlationId),n.cacheFailedRequest(r)),this.browserStorage.cleanRequestByInteractionType(fh.Redirect),r}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let t=e;t||(t=this.config.auth.OIDCOptions.serverResponseType===Ds.QUERY?window.location.search:window.location.hash);let n=Dl(t);if(n){try{!function(e,t,n){if(!e.state)throw _p(Rh);const r=kf(t,e.state);if(!r)throw _p(Ph);if(r.interactionType!==n)throw _p(xh)}(n,this.browserCrypto,fh.Redirect)}catch(o){return o instanceof Pa&&this.logger.error(`Interaction type validation failed due to ${o.errorCode}: ${o.errorMessage}`),[null,""]}return(r=window).location.hash="","function"===typeof r.history.replaceState&&r.history.replaceState(null,"",`${r.location.origin}${r.location.pathname}${r.location.search}`),this.logger.verbose("Hash contains known properties, returning response hash"),[n,t]}var r;const i=this.browserStorage.getTemporaryCache(Gd,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Gd)),i&&(n=Dl(i),n)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[n,i]):[null,""]}async handleResponse(e,t){const n=e.state;if(!n)throw _p(Rh);const r=this.browserStorage.getCachedRequest(n);if(this.logger.verbose("handleResponse called, retrieved cached request"),e.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw _p(pp);const t=new Qg(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,ah,this.performanceClient,this.nativeMessageHandler,e.accountId,this.nativeStorage,r.correlationId),{userRequestState:i}=mf.parseRequestState(this.browserCrypto,n);return t.acquireToken({...r,state:i,prompt:void 0}).finally((()=>{this.browserStorage.cleanRequestByState(n)}))}const i=this.browserStorage.getCachedAuthority(n);if(!i)throw _p(Yh);const o=await tf(this.createAuthCodeClient.bind(this),zu,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:i});ug.removeThrottle(this.browserStorage,this.config.auth.clientId,r);return new Zg(o,this.browserStorage,r,this.logger,this.performanceClient).handleCodeResponse(e,n)}async logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e),n=this.initializeServerTelemetryManager(hh);try{this.eventHandler.emitEvent(rg,fh.Redirect,e),await this.clearCacheOnLogout(t.account);const r={apiId:hh,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},i=await tf(this.createAuthCodeClient.bind(this),zu,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:e&&e.authority,requestExtraQueryParameters:e?.extraQueryParameters,account:e&&e.account||void 0});if(i.authority.protocolMode===Aa)try{i.authority.endSessionEndpoint}catch{if(t.account?.homeAccountId)return this.browserStorage.removeAccount(t.account?.homeAccountId),void this.eventHandler.emitEvent(ig,fh.Redirect,t)}const o=i.getLogoutUri(t);if(this.eventHandler.emitEvent(ig,fh.Redirect,t),!e||"function"!==typeof e.onRedirectNavigate)return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),void await this.navigationClient.navigateExternal(o,r);if(!1!==e.onRedirectNavigate(o))return this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),void await this.navigationClient.navigateExternal(o,r);this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation")}catch(r){throw r instanceof Pa&&(r.setCorrelationId(this.correlationId),n.cacheFailedRequest(r)),this.eventHandler.emitEvent(og,fh.Redirect,null,r),this.eventHandler.emitEvent(sg,fh.Redirect),r}this.eventHandler.emitEvent(sg,fh.Redirect)}getRedirectStartPage(e){const t=e||window.location.href;return Ll.getAbsoluteUrl(t,Mf())}}async function tm(e,t,n,r,i){if(t.addQueueMeasurement(Lu,r),!e)throw n.info("Navigate url is empty"),_p(Eh);return i?tf(rm,Uu,n,t,r)(e,i,t,r):ef(im,qu,n,t,r)(e)}async function nm(e,t,n,r,i,o,s){return r.addQueueMeasurement(Fu,o),new Promise(((r,o)=>{t<Ip&&i.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${t}ms) than the default (10000ms). This may result in timeouts.`);const a=window.setTimeout((()=>{window.clearInterval(c),o(_p(Uh))}),t),c=window.setInterval((()=>{let t="";const n=e.contentWindow;try{t=n?n.location.href:""}catch(o){}if(!t||"about:blank"===t)return;let i="";n&&(i=s===Ds.QUERY?n.location.search:n.location.hash),window.clearTimeout(a),window.clearInterval(c),r(i)}),n)})).finally((()=>{ef(sm,yd,i,r,o)(e)}))}function rm(e,t,n,r){return n.addQueueMeasurement(Uu,r),new Promise(((n,r)=>{const i=om();window.setTimeout((()=>{i?(i.src=e,n(i)):r("Unable to load iframe")}),t)}))}function im(e){const t=om();return t.src=e,t}function om(){const e=document.createElement("iframe");return e.className="msalSilentIframe",e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(e),e}function sm(e){document.body===e.parentNode&&document.body.removeChild(e)}class am extends Lg{constructor(e,t,n,r,i,o,s,a,c,l,u){super(e,t,n,r,i,o,a,l,u),this.apiId=s,this.nativeStorage=c}async acquireToken(e){this.performanceClient.addQueueMeasurement(gu,e.correlationId),e.loginHint||e.sid||e.account&&e.account.username||this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const t={...e};t.prompt?t.prompt!==Ns.NONE&&t.prompt!==Ns.NO_SESSION&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${t.prompt} with ${Ns.NONE}`),t.prompt=Ns.NONE):t.prompt=Ns.NONE;const n=await tf(this.initializeAuthorizationRequest.bind(this),$u,this.logger,this.performanceClient,e.correlationId)(t,fh.Silent);Bf(n.authority);const r=this.initializeServerTelemetryManager(this.apiId);let i;try{return i=await tf(this.createAuthCodeClient.bind(this),zu,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:r,requestAuthority:n.authority,requestAzureCloudOptions:n.azureCloudOptions,requestExtraQueryParameters:n.extraQueryParameters,account:n.account}),await tf(this.silentTokenHelper.bind(this),Du,this.logger,this.performanceClient,e.correlationId)(i,n)}catch(o){if(o instanceof Pa&&(o.setCorrelationId(this.correlationId),r.cacheFailedRequest(o)),!i||!(o instanceof Pa)||o.errorCode!==Ed)throw o;this.performanceClient.addFields({retryError:o.errorCode},this.correlationId);const n=await tf(this.initializeAuthorizationRequest.bind(this),$u,this.logger,this.performanceClient,e.correlationId)(t,fh.Silent);return await tf(this.silentTokenHelper.bind(this),Du,this.logger,this.performanceClient,this.correlationId)(i,n)}}logout(){return Promise.reject(_p(jh))}async silentTokenHelper(e,t){const n=t.correlationId;this.performanceClient.addQueueMeasurement(Du,n);const r=await tf(this.initializeAuthorizationCodeRequest.bind(this),ju,this.logger,this.performanceClient,n)(t),i=await tf(e.getAuthCodeUrl.bind(e),Ku,this.logger,this.performanceClient,n)({...t,nativeBroker:Yg.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}),o=new Gg(e,this.browserStorage,r,this.logger,this.performanceClient),s=await tf(tm,Lu,this.logger,this.performanceClient,n)(i,this.performanceClient,this.logger,n,this.config.system.navigateFrameWait),a=this.config.auth.OIDCOptions.serverResponseType,c=await tf(nm,Fu,this.logger,this.performanceClient,n)(s,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,n,a),l=ef(Jg,nd,this.logger,this.performanceClient,this.correlationId)(c,a,this.logger);if(l.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw _p(pp);const e=new Qg(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,l.accountId,this.browserStorage,n),{userRequestState:r}=mf.parseRequestState(this.browserCrypto,t.state);return tf(e.acquireToken.bind(e),_u,this.logger,this.performanceClient,n)({...t,state:r,prompt:t.prompt||Ns.NONE})}return tf(o.handleCodeResponse.bind(o),Wu,this.logger,this.performanceClient,n)(l,t)}}class cm extends Lg{async acquireToken(e){this.performanceClient.addQueueMeasurement(yu,e.correlationId);const t=await tf(Bg,xu,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),n={...e,...t};e.redirectUri&&(n.redirectUri=this.getRedirectUri(e.redirectUri));const r=this.initializeServerTelemetryManager(dh),i=await this.createRefreshTokenClient({serverTelemetryManager:r,authorityUrl:n.authority,azureCloudOptions:n.azureCloudOptions,account:n.account});return tf(i.acquireTokenByRefreshToken.bind(i),Au,this.logger,this.performanceClient,e.correlationId)(n).catch((e=>{throw e.setCorrelationId(this.correlationId),r.cacheFailedRequest(e),e}))}logout(){return Promise.reject(_p(jh))}async createRefreshTokenClient(e){const t=await tf(this.getClientConfiguration.bind(this),Hu,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new $g(t,this.performanceClient)}}class lm{constructor(e,t,n,r){this.isBrowserEnvironment="undefined"!==typeof window,this.config=e,this.storage=t,this.logger=n,this.cryptoObj=r}loadExternalTokens(e,t,n){if(!this.isBrowserEnvironment)throw _p(Xh);const r=t.id_token?Rc(t.id_token,Lp):void 0,i={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},o=e.authority?new rf(rf.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,i,this.logger,e.correlationId||Vp()):void 0,s=this.loadAccount(e,n.clientInfo||t.client_info||"",r,o),a=this.loadIdToken(t,s.homeAccountId,s.environment,s.realm),c=this.loadAccessToken(e,t,s.homeAccountId,s.environment,s.realm,n),l=this.loadRefreshToken(t,s.homeAccountId,s.environment);return this.generateAuthenticationResult(e,{account:s,idToken:a,accessToken:c,refreshToken:l},r,o)}loadAccount(e,t,n,r){if(this.logger.verbose("TokenCache - loading account"),e.account){const t=Nl.createFromAccountInfo(e.account);return this.storage.setAccount(t),t}if(!r||!t&&!n)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),_p(ip);const i=Nl.generateHomeAccountId(t,r.authorityType,this.logger,this.cryptoObj,n),o=n?.tid,s=kg(this.storage,r,i,Lp,n,t,r.hostnameAndPort,o,void 0,void 0,this.logger);return this.storage.setAccount(s),s}loadIdToken(e,t,n,r){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const i=Bc(t,n,e.id_token,this.config.auth.clientId,r);return this.storage.setIdTokenCredential(i),i}loadAccessToken(e,t,n,r,i,o){if(!t.access_token)return this.logger.verbose("TokenCache - no access token found in response"),null;if(!t.expires_in)return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;if(!t.scope&&(!e.scopes||!e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null;this.logger.verbose("TokenCache - loading access token");const s=t.scope?Il.fromString(t.scope):new Il(e.scopes),a=o.expiresOn||t.expires_in+(new Date).getTime()/1e3,c=o.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+(new Date).getTime()/1e3,l=Dc(n,r,t.access_token,this.config.auth.clientId,i,s.printScopes(),a,c,Lp);return this.storage.setAccessTokenCredential(l),l}loadRefreshToken(e,t,n){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const r=Lc(t,n,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return this.storage.setRefreshTokenCredential(r),r}generateAuthenticationResult(e,t,n,r){let i,o="",s=[],a=null;t?.accessToken&&(o=t.accessToken.secret,s=Il.fromString(t.accessToken.target).asArray(),a=new Date(1e3*Number(t.accessToken.expiresOn)),i=new Date(1e3*Number(t.accessToken.extendedExpiresOn)));const c=t.account;return{authority:r?r.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:s,account:c.getAccountInfo(),idToken:t.idToken?.secret||"",idTokenClaims:n||{},accessToken:o,fromCache:!0,expiresOn:a,correlationId:e.correlationId||"",requestId:"",extExpiresOn:i,familyId:t.refreshToken?.familyId||"",tokenType:t?.accessToken?.tokenType||"",state:e.state||"",cloudGraphHostName:c.cloudGraphHostName||"",msGraphHost:c.msGraphHost||"",fromNativeBroker:!1}}}class um extends Eg{constructor(e){super(e),this.includeRedirectUri=!1}}class dm extends Lg{constructor(e,t,n,r,i,o,s,a,c,l){super(e,t,n,r,i,o,a,c,l),this.apiId=s}async acquireToken(e){if(!e.code)throw _p(sp);const t=await tf(this.initializeAuthorizationRequest.bind(this),$u,this.logger,this.performanceClient,e.correlationId)(e,fh.Silent),n=this.initializeServerTelemetryManager(this.apiId);try{const r={...t,code:e.code},i=await tf(this.getClientConfiguration.bind(this),Hu,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:n,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),o=new um(i);this.logger.verbose("Auth code client created");const s=new Gg(o,this.browserStorage,r,this.logger,this.performanceClient);return await tf(s.handleCodeResponseFromServer.bind(s),Vu,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t,!1)}catch(r){throw r instanceof Pa&&(r.setCorrelationId(this.correlationId),n.cacheFailedRequest(r)),r}}logout(){return Promise.reject(_p(jh))}}function hm(e){const t=e?.idTokenClaims;return t?.tfp||t?.acr?"B2C":t?.tid?"9188040d-6c67-4c5b-b112-36a304b66dad"===t?.tid?"MSA":"AAD":void 0}function pm(e,t){try{xf(e)}catch(n){throw t.end({success:!1},n),n}}class fm{constructor(e){var t,n;this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new Xp(this.logger,this.performanceClient):Ac,this.eventHandler=new cg(this.logger),this.browserStorage=this.isBrowserEnvironment?new Af(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,function(e){const t=e.cloudDiscoveryMetadata;let n;if(t)try{n=JSON.parse(t)}catch(r){throw _l(ll)}return{canonicalAuthority:e.authority?of(e.authority):void 0,knownAuthorities:e.knownAuthorities,cloudDiscoveryMetadata:n}}(this.config.auth),this.performanceClient):(t=this.config.auth.clientId,n=this.logger,new Af(t,{cacheLocation:$d,temporaryCacheLocation:$d,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1},Ac,n));const r={cacheLocation:$d,temporaryCacheLocation:$d,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new Af(this.config.auth.clientId,r,this.browserCrypto,this.logger,void 0,this.performanceClient),this.tokenCache=new lm(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this),this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}static async createController(e,t){const n=new fm(e);return await n.initialize(t),n}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e){if(this.logger.trace("initialize called"),this.initialized)return void this.logger.info("initialize has already been called, exiting early.");if(!this.isBrowserEnvironment)return this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,void this.eventHandler.emitEvent(Lf);const t=e?.correlationId||this.getRequestCorrelationId(),n=this.config.system.allowNativeBroker,r=this.performanceClient.startMeasurement(Bu,t);if(this.eventHandler.emitEvent(Df),n)try{this.nativeExtensionProvider=await Yg.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)}catch(i){this.logger.verbose(i)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),await tf(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),vd,this.logger,this.performanceClient,t)(this.performanceClient,t)),this.initialized=!0,this.eventHandler.emitEvent(Lf),r.end({allowNativeBroker:n,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),Pf(this.initialized),this.isBrowserEnvironment){const t=e||"";let n=this.redirectResponse.get(t);return"undefined"===typeof n?(n=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(t,n),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),n}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(e){const t=this.getAllAccounts(),n=this.browserStorage.getCachedNativeRequest(),r=n&&Yg.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e,i=r?n?.correlationId:this.browserStorage.getTemporaryCache(eh,!0)||"",o=this.performanceClient.startMeasurement(du,i);let s;if(this.eventHandler.emitEvent(eg,fh.Redirect),r&&this.nativeExtensionProvider){this.logger.trace("handleRedirectPromise - acquiring token from native platform");const e=new Qg(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,lh,this.performanceClient,this.nativeExtensionProvider,n.accountId,this.nativeInternalStorage,n.correlationId);s=tf(e.handleRedirectPromise.bind(e),gd,this.logger,this.performanceClient,o.event.correlationId)(this.performanceClient,o.event.correlationId)}else{this.logger.trace("handleRedirectPromise - acquiring token from web flow");const t=this.createRedirectClient(i);s=tf(t.handleRedirectPromise.bind(t),fd,this.logger,this.performanceClient,o.event.correlationId)(e,o)}return s.then((e=>{if(e){t.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(Hf,fh.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(Kf,fh.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),o.end({success:!0,accountType:hm(e.account)})}else o.event.errorCode?o.end({success:!1}):o.discard();return this.eventHandler.emitEvent(tg,fh.Redirect),e})).catch((e=>{const n=e;throw t.length>0?this.eventHandler.emitEvent(Vf,fh.Redirect,null,n):this.eventHandler.emitEvent($f,fh.Redirect,null,n),this.eventHandler.emitEvent(tg,fh.Redirect),o.end({success:!1},n),e}))}async acquireTokenRedirect(e){const t=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",t);const n=this.performanceClient.startMeasurement(uu,t);n.add({accountType:hm(e.account),scenarioId:e.scenarioId});const r=e.onRedirectNavigate;if(r)e.onRedirectNavigate=e=>{const t="function"===typeof r?r(e):void 0;return!1!==t?n.end({success:!0}):n.discard(),t};else{const e=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=t=>{const r="function"===typeof e?e(t):void 0;return!1!==r?n.end({success:!0}):n.discard(),r}}const i=this.getAllAccounts().length>0;try{let r;if(Nf(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),i?this.eventHandler.emitEvent(jf,fh.Redirect,e):this.eventHandler.emitEvent(zf,fh.Redirect,e),this.nativeExtensionProvider&&this.canUseNative(e)){r=new Qg(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,sh,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,t).acquireTokenRedirect(e,n).catch((n=>{if(n instanceof qg&&zg(n)){this.nativeExtensionProvider=void 0;return this.createRedirectClient(t).acquireToken(e)}if(n instanceof pf){this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow");return this.createRedirectClient(t).acquireToken(e)}throw this.browserStorage.setInteractionInProgress(!1),n}))}else{r=this.createRedirectClient(t).acquireToken(e)}return await r}catch(o){throw n.end({success:!1},o),i?this.eventHandler.emitEvent(Vf,fh.Redirect,null,o):this.eventHandler.emitEvent($f,fh.Redirect,null,o),o}}acquireTokenPopup(e){const t=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(lu,t);n.add({scenarioId:e.scenarioId,accountType:hm(e.account)});try{this.logger.verbose("acquireTokenPopup called",t),pm(this.initialized,n),this.browserStorage.setInteractionInProgress(!0)}catch(o){return Promise.reject(o)}const r=this.getAllAccounts();let i;if(r.length>0?this.eventHandler.emitEvent(jf,fh.Popup,e):this.eventHandler.emitEvent(zf,fh.Popup,e),this.canUseNative(e))i=this.acquireTokenNative({...e,correlationId:t},ah).then((e=>(this.browserStorage.setInteractionInProgress(!1),n.end({success:!0,isNativeBroker:!0,requestId:e.requestId,accountType:hm(e.account)}),e))).catch((n=>{if(n instanceof qg&&zg(n)){this.nativeExtensionProvider=void 0;return this.createPopupClient(t).acquireToken(e)}if(n instanceof pf){this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow");return this.createPopupClient(t).acquireToken(e)}throw this.browserStorage.setInteractionInProgress(!1),n}));else{i=this.createPopupClient(t).acquireToken(e)}return i.then((e=>(r.length<this.getAllAccounts().length?this.eventHandler.emitEvent(Hf,fh.Popup,e):this.eventHandler.emitEvent(Kf,fh.Popup,e),n.end({success:!0,requestId:e.requestId,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:hm(e.account)}),e))).catch((e=>(r.length>0?this.eventHandler.emitEvent(Vf,fh.Popup,null,e):this.eventHandler.emitEvent($f,fh.Popup,null,e),n.end({success:!1},e),Promise.reject(e))))}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){const t=this.getRequestCorrelationId(e),n={...e,prompt:e.prompt,correlationId:t};let r;if(this.ssoSilentMeasurement=this.performanceClient.startMeasurement(vu,t),this.ssoSilentMeasurement?.add({scenarioId:e.scenarioId,accountType:hm(e.account)}),pm(this.initialized,this.ssoSilentMeasurement),this.ssoSilentMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",t),this.eventHandler.emitEvent(Qf,fh.Silent,n),this.canUseNative(n))r=this.acquireTokenNative(n,ch).catch((e=>{if(e instanceof qg&&zg(e)){this.nativeExtensionProvider=void 0;return this.createSilentIframeClient(n.correlationId).acquireToken(n)}throw e}));else{r=this.createSilentIframeClient(n.correlationId).acquireToken(n)}return r.then((e=>(this.eventHandler.emitEvent(Yf,fh.Silent,e),this.ssoSilentMeasurement?.end({success:!0,isNativeBroker:e.fromNativeBroker,requestId:e.requestId,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:hm(e.account)}),e))).catch((e=>{throw this.eventHandler.emitEvent(Gf,fh.Silent,null,e),this.ssoSilentMeasurement?.end({success:!1},e),e})).finally((()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)}))}async acquireTokenByCode(e){const t=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",t);const n=this.performanceClient.startMeasurement(ou,t);pm(this.initialized,n),this.eventHandler.emitEvent(Jf,fh.Silent,e),n.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw _p(cp);if(e.code){const r=e.code;let i=this.hybridAuthCodeResponses.get(r);return i?(this.logger.verbose("Existing acquireTokenByCode request found",t),n.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),i=this.acquireTokenByCodeAsync({...e,correlationId:t}).then((e=>(this.eventHandler.emitEvent(Xf,fh.Silent,e),this.hybridAuthCodeResponses.delete(r),n.end({success:!0,isNativeBroker:e.fromNativeBroker,requestId:e.requestId,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:hm(e.account)}),e))).catch((e=>{throw this.hybridAuthCodeResponses.delete(r),this.eventHandler.emitEvent(Zf,fh.Silent,null,e),n.end({success:!1},e),e})),this.hybridAuthCodeResponses.set(r,i)),await i}if(e.nativeAccountId){if(this.canUseNative(e,e.nativeAccountId)){const r=await this.acquireTokenNative({...e,correlationId:t},uh,e.nativeAccountId).catch((e=>{throw e instanceof qg&&zg(e)&&(this.nativeExtensionProvider=void 0),e}));return n.end({accountType:hm(r.account),success:!0}),r}throw _p(up)}throw _p(ap)}catch(r){throw this.eventHandler.emitEvent(Zf,fh.Silent,null,r),n.end({success:!1},r),r}}async acquireTokenByCodeAsync(e){this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(pd,e.correlationId),this.acquireTokenByCodeAsyncMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement);const t=this.createSilentAuthCodeClient(e.correlationId);return await t.acquireToken(e).then((e=>(this.acquireTokenByCodeAsyncMeasurement?.end({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e))).catch((e=>{throw this.acquireTokenByCodeAsyncMeasurement?.end({success:!1},e),e})).finally((()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)}))}async acquireTokenFromCache(e,t){switch(this.performanceClient.addQueueMeasurement(Mu,e.correlationId),t){case vh:case bh:case wh:const t=this.createSilentCacheClient(e.correlationId);return tf(t.acquireToken.bind(t),fu,this.logger,this.performanceClient,e.correlationId)(e);default:throw kc(hc)}}async acquireTokenByRefreshToken(e,t){switch(this.performanceClient.addQueueMeasurement(su,e.correlationId),t){case vh:case wh:case _h:case Ch:const t=this.createSilentRefreshClient(e.correlationId);return tf(t.acquireToken.bind(t),yu,this.logger,this.performanceClient,e.correlationId)(e);default:throw kc(hc)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(Pu,e.correlationId);const t=this.createSilentIframeClient(e.correlationId);return tf(t.acquireToken.bind(t),gu,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect({correlationId:t,...e})}async logoutRedirect(e){const t=this.getRequestCorrelationId(e);Nf(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0);return this.createRedirectClient(t).logout(e)}logoutPopup(e){try{const t=this.getRequestCorrelationId(e);xf(this.initialized),this.browserStorage.setInteractionInProgress(!0);return this.createPopupClient(t).logout(e)}catch(t){return Promise.reject(t)}}async clearCache(e){if(!this.isBrowserEnvironment)return void this.logger.info("in non-browser environment, returning early.");const t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)}getAllAccounts(e){return function(e,t,n,r){return e.verbose("getAllAccounts called"),n?t.getAllAccounts(r):[]}(this.logger,this.browserStorage,this.isBrowserEnvironment,e)}getAccount(e){return function(e,t,n){if(t.trace("getAccount called"),0===Object.keys(e).length)return t.warning("getAccount: No accountFilter provided"),null;const r=n.getAccountInfoFilteredBy(e);return r?(t.verbose("getAccount: Account matching provided filter found, returning"),r):(t.verbose("getAccount: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage)}getAccountByUsername(e){return function(e,t,n){if(t.trace("getAccountByUsername called"),!e)return t.warning("getAccountByUsername: No username provided"),null;const r=n.getAccountInfoFilteredBy({username:e});return r?(t.verbose("getAccountByUsername: Account matching username found, returning"),t.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${e}`),r):(t.verbose("getAccountByUsername: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage)}getAccountByHomeId(e){return function(e,t,n){if(t.trace("getAccountByHomeId called"),!e)return t.warning("getAccountByHomeId: No homeAccountId provided"),null;const r=n.getAccountInfoFilteredBy({homeAccountId:e});return r?(t.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),t.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${e}`),r):(t.verbose("getAccountByHomeId: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage)}getAccountByLocalId(e){return function(e,t,n){if(t.trace("getAccountByLocalId called"),!e)return t.warning("getAccountByLocalId: No localAccountId provided"),null;const r=n.getAccountInfoFilteredBy({localAccountId:e});return r?(t.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),t.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${e}`),r):(t.verbose("getAccountByLocalId: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage)}setActiveAccount(e){!function(e,t){t.setActiveAccount(e)}(e,this.browserStorage)}getActiveAccount(){return this.browserStorage.getActiveAccount()}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");const n=Nl.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return this.browserStorage.setAccount(n),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)}async acquireTokenNative(e,t,n){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw _p(pp);return new Qg(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,n||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)}canUseNative(e,t){if(this.logger.trace("canUseNative called"),!Yg.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case Ns.NONE:case Ns.CONSENT:case Ns.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace(`canUseNative: prompt = ${e.prompt} is not compatible with native flow, returning false`),!1}return!(!t&&!this.getNativeAccountId(e))||(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1)}getNativeAccountId(e){const t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new Xg(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createRedirectClient(e){return new em(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentIframeClient(e){return new am(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,ch,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentCacheClient(e){return new Kg(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentRefreshClient(e){return new cm(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentAuthCodeClient(e){return new dm(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,uh,this.performanceClient,this.nativeExtensionProvider,e)}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return Of(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){"undefined"!==typeof window&&(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))}disableAccountStorageEvents(){"undefined"!==typeof window&&(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))}handleAccountCacheChange(e){try{e.key?.includes(Es)&&this.eventHandler.emitEvent(qf);const t=e.newValue||e.oldValue;if(!t)return;const n=JSON.parse(t);if("object"!==typeof n||!Nl.isAccountEntity(n))return;const r=Wl.toObject(new Nl,n).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.eventHandler.emitEvent(Ff,void 0,r)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.eventHandler.emitEvent(Uf,void 0,r))}catch(e){return}}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return e?.correlationId?e.correlationId:this.isBrowserEnvironment?Vp():us.EMPTY_STRING}async loginRedirect(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect({correlationId:t,...e||gh})}loginPopup(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup({correlationId:t,...e||gh})}async acquireTokenSilent(e){const t=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(au,t);n.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),pm(this.initialized,n),this.logger.verbose("acquireTokenSilent called",t);const r=e.account||this.getActiveAccount();if(!r)throw _p(Kh);n.add({accountType:hm(r)});const i={clientId:this.config.auth.clientId,authority:e.authority||us.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:r.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,shrOptions:e.shrOptions},o=JSON.stringify(i),s=this.activeSilentTokenRequests.get(o);if("undefined"===typeof s){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",t);const i=tf(this.acquireTokenSilentAsync.bind(this),cu,this.logger,this.performanceClient,t)({...e,correlationId:t},r).then((t=>(this.activeSilentTokenRequests.delete(o),n.end({success:!0,fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,requestId:t.requestId,accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),t))).catch((e=>{throw this.activeSilentTokenRequests.delete(o),n.end({success:!1},e),e}));return this.activeSilentTokenRequests.set(o,i),{...await i,state:e.state}}return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",t),n.discard(),{...await s,state:e.state}}async acquireTokenSilentAsync(e,t){const n=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(cu,e.correlationId),this.eventHandler.emitEvent(jf,fh.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",n);const r=await tf(Dg,Nu,this.logger,this.performanceClient,e.correlationId)(e,t,this.config,this.performanceClient,this.logger),i=e.cacheLookupPolicy||vh;return this.acquireTokenSilentNoIframe(r,i).catch((async e=>{const t=function(e,t){const n=!(e instanceof pf&&e.subError!==lf),r=e.errorCode===Ed||e.errorCode===hc,i=n&&r||e.errorCode===sf||e.errorCode===cf,o=Th.includes(t);return i&&o}(e,i);if(t){if(this.activeIframeRequest){if(i!==Ih){const[t,n]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${n}`,r.correlationId);const o=this.performanceClient.startMeasurement(mu,r.correlationId);o.add({awaitIframeCorrelationId:n});const s=await t;if(o.end({success:s}),s)return this.logger.verbose(`Parallel iframe request with correlationId: ${n} succeeded. Retrying cache and/or RT redemption`,r.correlationId),this.acquireTokenSilentNoIframe(r,i);throw this.logger.info(`Iframe request with correlationId: ${n} failed. Interaction is required.`),e}return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",r.correlationId),tf(this.acquireTokenBySilentIframe.bind(this),Pu,this.logger,this.performanceClient,r.correlationId)(r)}{let e;return this.activeIframeRequest=[new Promise((t=>{e=t})),r.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",r.correlationId),tf(this.acquireTokenBySilentIframe.bind(this),Pu,this.logger,this.performanceClient,r.correlationId)(r).then((t=>(e(!0),t))).catch((t=>{throw e(!1),t})).finally((()=>{this.activeIframeRequest=void 0}))}}throw e})).then((t=>(this.eventHandler.emitEvent(Kf,fh.Silent,t),e.correlationId&&this.performanceClient.addFields({fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker,requestId:t.requestId},e.correlationId),t))).catch((e=>{throw this.eventHandler.emitEvent(Vf,fh.Silent,null,e),e})).finally((()=>{document.removeEventListener("visibilitychange",n)}))}async acquireTokenSilentNoIframe(e,t){return Yg.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.acquireTokenNative(e,dh).catch((async e=>{if(e instanceof qg&&zg(e))throw this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,kc(hc);throw e}))):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),tf(this.acquireTokenFromCache.bind(this),Mu,this.logger,this.performanceClient,e.correlationId)(e,t).catch((n=>{if(t===bh)throw n;return this.eventHandler.emitEvent(Wf,fh.Silent,e),tf(this.acquireTokenByRefreshToken.bind(this),su,this.logger,this.performanceClient,e.correlationId)(e,t)})))}}class gm{static async createPublicClientApplication(e){const t=await async function(e,t){const n=new kp(e);return await n.initialize(),fm.createController(n,t)}(e);return new gm(e,t)}constructor(e,t){this.controller=t||new fm(new kp(e))}async initialize(e){return this.controller.initialize(e)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,t){return this.controller.addEventCallback(e,t)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}}var mm=n(579);const ym=function(e){var t=function(t){function n(e){var n=t.call(this,e)||this;return n.componentDidMount=function(){ss.events.addEventListener(ss.RENDER_EVENT,n.onRenderEvent),ss.setComponentReady()},n.componentDidUpdate=function(){null!=n.state.componentError&&ss.setFrameHeight()},n.componentWillUnmount=function(){ss.events.removeEventListener(ss.RENDER_EVENT,n.onRenderEvent)},n.onRenderEvent=function(e){n.setState({renderData:e.detail})},n.state={renderData:void 0,componentError:void 0},n}return cs(n,t),n.prototype.render=function(){return null!=this.state.componentError?h.createElement("div",null,h.createElement("h1",null,"Component Error"),h.createElement("span",null,this.state.componentError.message)):null==this.state.renderData?null:h.createElement(e,{width:window.innerWidth,disabled:this.state.renderData.disabled,args:this.state.renderData.args,theme:this.state.renderData.theme})},n.getDerivedStateFromError=function(e){return{componentError:e}},n}(h.PureComponent);return g()(t,e)}(class extends ls{constructor(){super(...arguments),this.componentDidMount=()=>{console.log("Mounting msal instance"),ss.setComponentReady();const e={auth:{clientId:this.props.args.clientId,authority:this.props.args.authority,redirectUri:this.props.args.redirectUri},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!0}};console.log("initializing msal instance");const t=new gm(e),n=e=>{if(null!==e){let t=e.account;ss.setComponentValue({account:t})}else{let e=t.getAllAccounts();if(e.length>0){let t=e[0];return void ss.setComponentValue({account:t})}t.ssoSilent({}).then((()=>{let e=t.getAllAccounts()[0];ss.setComponentValue({account:e})})).catch((e=>{console.error("Silent Error: "+e),ss.setComponentValue({account:null})}))}};t.initialize().then((()=>{t.handleRedirectPromise().then(n).catch((e=>{console.error(e)}))}))},this.render=()=>(0,mm.jsx)("div",{})}});p.render((0,mm.jsx)(h.StrictMode,{children:(0,mm.jsx)(ym,{})}),document.getElementById("root"))})();
//# sourceMappingURL=main.ae806115.js.map